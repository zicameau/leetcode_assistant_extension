var firebaseClient=(()=>{var yc=Object.defineProperty;var Vy=Object.getOwnPropertyDescriptor;var xy=Object.getOwnPropertyNames;var Ly=Object.prototype.hasOwnProperty;var My=(n,e)=>{for(var t in e)yc(n,t,{get:e[t],enumerable:!0})},Fy=(n,e,t,r)=>{if(e&&typeof e=="object"||typeof e=="function")for(let i of xy(e))!Ly.call(n,i)&&i!==t&&yc(n,i,{get:()=>e[i],enumerable:!(r=Vy(e,i))||r.enumerable});return n};var Uy=n=>Fy(yc({},"__esModule",{value:!0}),n);var vA={};My(vA,{addMessageToChat:()=>wA,auth:()=>zn,createChat:()=>IA,db:()=>Ur,enableOfflinePersistenceSafe:()=>fA,ensureUserProfile:()=>yA,firebaseApp:()=>md,initAuthPersistence:()=>dA,listChats:()=>EA,listMessages:()=>TA,onAuthChanged:()=>pA,registerWithEmailPassword:()=>gA,signInWithEmailPassword:()=>mA,signOutUser:()=>_A});var If=()=>{};var Tf=function(n){let e=[],t=0;for(let r=0;r<n.length;r++){let i=n.charCodeAt(r);i<128?e[t++]=i:i<2048?(e[t++]=i>>6|192,e[t++]=i&63|128):(i&64512)===55296&&r+1<n.length&&(n.charCodeAt(r+1)&64512)===56320?(i=65536+((i&1023)<<10)+(n.charCodeAt(++r)&1023),e[t++]=i>>18|240,e[t++]=i>>12&63|128,e[t++]=i>>6&63|128,e[t++]=i&63|128):(e[t++]=i>>12|224,e[t++]=i>>6&63|128,e[t++]=i&63|128)}return e},By=function(n){let e=[],t=0,r=0;for(;t<n.length;){let i=n[t++];if(i<128)e[r++]=String.fromCharCode(i);else if(i>191&&i<224){let s=n[t++];e[r++]=String.fromCharCode((i&31)<<6|s&63)}else if(i>239&&i<365){let s=n[t++],o=n[t++],c=n[t++],u=((i&7)<<18|(s&63)<<12|(o&63)<<6|c&63)-65536;e[r++]=String.fromCharCode(55296+(u>>10)),e[r++]=String.fromCharCode(56320+(u&1023))}else{let s=n[t++],o=n[t++];e[r++]=String.fromCharCode((i&15)<<12|(s&63)<<6|o&63)}}return e.join("")},vf={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(n,e){if(!Array.isArray(n))throw Error("encodeByteArray takes an array as a parameter");this.init_();let t=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let i=0;i<n.length;i+=3){let s=n[i],o=i+1<n.length,c=o?n[i+1]:0,u=i+2<n.length,h=u?n[i+2]:0,f=s>>2,m=(s&3)<<4|c>>4,_=(c&15)<<2|h>>6,R=h&63;u||(R=64,o||(_=64)),r.push(t[f],t[m],t[_],t[R])}return r.join("")},encodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(n):this.encodeByteArray(Tf(n),e)},decodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(n):By(this.decodeStringToByteArray(n,e))},decodeStringToByteArray(n,e){this.init_();let t=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let i=0;i<n.length;){let s=t[n.charAt(i++)],c=i<n.length?t[n.charAt(i)]:0;++i;let h=i<n.length?t[n.charAt(i)]:64;++i;let m=i<n.length?t[n.charAt(i)]:64;if(++i,s==null||c==null||h==null||m==null)throw new wc;let _=s<<2|c>>4;if(r.push(_),h!==64){let R=c<<4&240|h>>2;if(r.push(R),m!==64){let k=h<<6&192|m;r.push(k)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let n=0;n<this.ENCODED_VALS.length;n++)this.byteToCharMap_[n]=this.ENCODED_VALS.charAt(n),this.charToByteMap_[this.byteToCharMap_[n]]=n,this.byteToCharMapWebSafe_[n]=this.ENCODED_VALS_WEBSAFE.charAt(n),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[n]]=n,n>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(n)]=n,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(n)]=n)}}},wc=class extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}},qy=function(n){let e=Tf(n);return vf.encodeByteArray(e,!0)},ri=function(n){return qy(n).replace(/\./g,"")},Ps=function(n){try{return vf.decodeString(n,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};function Tc(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}var jy=()=>Tc().__FIREBASE_DEFAULTS__,zy=()=>{if(typeof process>"u"||typeof process.env>"u")return;let n=process.env.__FIREBASE_DEFAULTS__;if(n)return JSON.parse(n)},Gy=()=>{if(typeof document>"u")return;let n;try{n=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}let e=n&&Ps(n[1]);return e&&JSON.parse(e)},Cs=()=>{try{return If()||jy()||zy()||Gy()}catch(n){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${n}`);return}},vc=n=>Cs()?.emulatorHosts?.[n],Af=n=>{let e=vc(n);if(!e)return;let t=e.lastIndexOf(":");if(t<=0||t+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);let r=parseInt(e.substring(t+1),10);return e[0]==="["?[e.substring(1,t-1),r]:[e.substring(0,t),r]},Ac=()=>Cs()?.config,bc=n=>Cs()?.[`_${n}`];var Rs=class{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,r)=>{t?this.reject(t):this.resolve(r),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(t):e(t,r))}}};function Rt(n){try{return(n.startsWith("http://")||n.startsWith("https://")?new URL(n).hostname:n).endsWith(".cloudworkstations.dev")}catch{return!1}}async function Ns(n){return(await fetch(n,{credentials:"include"})).ok}function bf(n,e){if(n.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');let t={alg:"none",type:"JWT"},r=e||"demo-project",i=n.iat||0,s=n.sub||n.user_id;if(!s)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");let o={iss:`https://securetoken.google.com/${r}`,aud:r,iat:i,exp:i+3600,auth_time:i,sub:s,user_id:s,firebase:{sign_in_provider:"custom",identities:{}},...n};return[ri(JSON.stringify(t)),ri(JSON.stringify(o)),""].join(".")}var ni={};function $y(){let n={prod:[],emulator:[]};for(let e of Object.keys(ni))ni[e]?n.emulator.push(e):n.prod.push(e);return n}function Ky(n){let e=document.getElementById(n),t=!1;return e||(e=document.createElement("div"),e.setAttribute("id",n),t=!0),{created:t,element:e}}var wf=!1;function ks(n,e){if(typeof window>"u"||typeof document>"u"||!Rt(window.location.host)||ni[n]===e||ni[n]||wf)return;ni[n]=e;function t(_){return`__firebase__banner__${_}`}let r="__firebase__banner",s=$y().prod.length>0;function o(){let _=document.getElementById(r);_&&_.remove()}function c(_){_.style.display="flex",_.style.background="#7faaf0",_.style.position="fixed",_.style.bottom="5px",_.style.left="5px",_.style.padding=".5em",_.style.borderRadius="5px",_.style.alignItems="center"}function u(_,R){_.setAttribute("width","24"),_.setAttribute("id",R),_.setAttribute("height","24"),_.setAttribute("viewBox","0 0 24 24"),_.setAttribute("fill","none"),_.style.marginLeft="-6px"}function h(){let _=document.createElement("span");return _.style.cursor="pointer",_.style.marginLeft="16px",_.style.fontSize="24px",_.innerHTML=" &times;",_.onclick=()=>{wf=!0,o()},_}function f(_,R){_.setAttribute("id",R),_.innerText="Learn more",_.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",_.setAttribute("target","__blank"),_.style.paddingLeft="5px",_.style.textDecoration="underline"}function m(){let _=Ky(r),R=t("text"),k=document.getElementById(R)||document.createElement("span"),O=t("learnmore"),N=document.getElementById(O)||document.createElement("a"),j=t("preprendIcon"),q=document.getElementById(j)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(_.created){let U=_.element;c(U),f(N,O);let ee=h();u(q,j),U.append(q,k,N,ee),document.body.appendChild(U)}s?(k.innerText="Preview backend disconnected.",q.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(q.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,k.innerText="Preview backend running in this workspace."),k.setAttribute("id",R)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",m):m()}function ue(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function Sf(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(ue())}function Rf(){let n=Cs()?.forceEnvironment;if(n==="node")return!0;if(n==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function Pf(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function Cf(){let n=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof n=="object"&&n.id!==void 0}function Nf(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function kf(){let n=ue();return n.indexOf("MSIE ")>=0||n.indexOf("Trident/")>=0}function Sc(){return!Rf()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function Rc(){return!Rf()&&!!navigator.userAgent&&(navigator.userAgent.includes("Safari")||navigator.userAgent.includes("WebKit"))&&!navigator.userAgent.includes("Chrome")}function Ds(){try{return typeof indexedDB=="object"}catch{return!1}}function Df(){return new Promise((n,e)=>{try{let t=!0,r="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(r);i.onsuccess=()=>{i.result.close(),t||self.indexedDB.deleteDatabase(r),n(!0)},i.onupgradeneeded=()=>{t=!1},i.onerror=()=>{e(i.error?.message||"")}}catch(t){e(t)}})}var Wy="FirebaseError",Le=class n extends Error{constructor(e,t,r){super(t),this.code=e,this.customData=r,this.name=Wy,Object.setPrototypeOf(this,n.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,ct.prototype.create)}},ct=class{constructor(e,t,r){this.service=e,this.serviceName=t,this.errors=r}create(e,...t){let r=t[0]||{},i=`${this.service}/${e}`,s=this.errors[e],o=s?Hy(s,r):"Error",c=`${this.serviceName}: ${o} (${i}).`;return new Le(i,c,r)}};function Hy(n,e){return n.replace(Qy,(t,r)=>{let i=e[r];return i!=null?String(i):`<${r}?>`})}var Qy=/\{\$([^}]+)}/g;function Of(n){for(let e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}function Ze(n,e){if(n===e)return!0;let t=Object.keys(n),r=Object.keys(e);for(let i of t){if(!r.includes(i))return!1;let s=n[i],o=e[i];if(Ef(s)&&Ef(o)){if(!Ze(s,o))return!1}else if(s!==o)return!1}for(let i of r)if(!t.includes(i))return!1;return!0}function Ef(n){return n!==null&&typeof n=="object"}function Wn(n){let e=[];for(let[t,r]of Object.entries(n))Array.isArray(r)?r.forEach(i=>{e.push(encodeURIComponent(t)+"="+encodeURIComponent(i))}):e.push(encodeURIComponent(t)+"="+encodeURIComponent(r));return e.length?"&"+e.join("&"):""}function Hn(n){let e={};return n.replace(/^\?/,"").split("&").forEach(r=>{if(r){let[i,s]=r.split("=");e[decodeURIComponent(i)]=decodeURIComponent(s)}}),e}function Qn(n){let e=n.indexOf("?");if(!e)return"";let t=n.indexOf("#",e);return n.substring(e,t>0?t:void 0)}function Vf(n,e){let t=new Ec(n,e);return t.subscribe.bind(t)}var Ec=class{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then(()=>{e(this)}).catch(r=>{this.error(r)})}next(e){this.forEachObserver(t=>{t.next(e)})}error(e){this.forEachObserver(t=>{t.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,t,r){let i;if(e===void 0&&t===void 0&&r===void 0)throw new Error("Missing Observer.");Jy(e,["next","error","complete"])?i=e:i={next:e,error:t,complete:r},i.next===void 0&&(i.next=Ic),i.error===void 0&&(i.error=Ic),i.complete===void 0&&(i.complete=Ic);let s=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?i.error(this.finalError):i.complete()}catch{}}),this.observers.push(i),s}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{t(this.observers[e])}catch(r){typeof console<"u"&&console.error&&console.error(r)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}};function Jy(n,e){if(typeof n!="object"||n===null)return!1;for(let t of e)if(t in n&&typeof n[t]=="function")return!0;return!1}function Ic(){}var RA=14400*1e3;function ce(n){return n&&n._delegate?n._delegate:n}var qe=class{constructor(e,t,r){this.name=e,this.instanceFactory=t,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}};var ln="[DEFAULT]";var Pc=class{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){let t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){let r=new Rs;if(this.instancesDeferred.set(t,r),this.isInitialized(t)||this.shouldAutoInitialize())try{let i=this.getOrInitializeService({instanceIdentifier:t});i&&r.resolve(i)}catch{}}return this.instancesDeferred.get(t).promise}getImmediate(e){let t=this.normalizeInstanceIdentifier(e?.identifier),r=e?.optional??!1;if(this.isInitialized(t)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:t})}catch(i){if(r)return null;throw i}else{if(r)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(Xy(e))try{this.getOrInitializeService({instanceIdentifier:ln})}catch{}for(let[t,r]of this.instancesDeferred.entries()){let i=this.normalizeInstanceIdentifier(t);try{let s=this.getOrInitializeService({instanceIdentifier:i});r.resolve(s)}catch{}}}}clearInstance(e=ln){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){let e=Array.from(this.instances.values());await Promise.all([...e.filter(t=>"INTERNAL"in t).map(t=>t.INTERNAL.delete()),...e.filter(t=>"_delete"in t).map(t=>t._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=ln){return this.instances.has(e)}getOptions(e=ln){return this.instancesOptions.get(e)||{}}initialize(e={}){let{options:t={}}=e,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);let i=this.getOrInitializeService({instanceIdentifier:r,options:t});for(let[s,o]of this.instancesDeferred.entries()){let c=this.normalizeInstanceIdentifier(s);r===c&&o.resolve(i)}return i}onInit(e,t){let r=this.normalizeInstanceIdentifier(t),i=this.onInitCallbacks.get(r)??new Set;i.add(e),this.onInitCallbacks.set(r,i);let s=this.instances.get(r);return s&&e(s,r),()=>{i.delete(e)}}invokeOnInitCallbacks(e,t){let r=this.onInitCallbacks.get(t);if(r)for(let i of r)try{i(e,t)}catch{}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let r=this.instances.get(e);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:Yy(e),options:t}),this.instances.set(e,r),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(r,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,r)}catch{}return r||null}normalizeInstanceIdentifier(e=ln){return this.component?this.component.multipleInstances?e:ln:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}};function Yy(n){return n===ln?void 0:n}function Xy(n){return n.instantiationMode==="EAGER"}var Os=class{constructor(e){this.name=e,this.providers=new Map}addComponent(e){let t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);let t=new Pc(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}};var Zy=[],W;(function(n){n[n.DEBUG=0]="DEBUG",n[n.VERBOSE=1]="VERBOSE",n[n.INFO=2]="INFO",n[n.WARN=3]="WARN",n[n.ERROR=4]="ERROR",n[n.SILENT=5]="SILENT"})(W||(W={}));var eI={debug:W.DEBUG,verbose:W.VERBOSE,info:W.INFO,warn:W.WARN,error:W.ERROR,silent:W.SILENT},tI=W.INFO,nI={[W.DEBUG]:"log",[W.VERBOSE]:"log",[W.INFO]:"info",[W.WARN]:"warn",[W.ERROR]:"error"},rI=(n,e,...t)=>{if(e<n.logLevel)return;let r=new Date().toISOString(),i=nI[e];if(i)console[i](`[${r}]  ${n.name}:`,...t);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)},Pt=class{constructor(e){this.name=e,this._logLevel=tI,this._logHandler=rI,this._userLogHandler=null,Zy.push(this)}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in W))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?eI[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,W.DEBUG,...e),this._logHandler(this,W.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,W.VERBOSE,...e),this._logHandler(this,W.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,W.INFO,...e),this._logHandler(this,W.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,W.WARN,...e),this._logHandler(this,W.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,W.ERROR,...e),this._logHandler(this,W.ERROR,...e)}};var iI=(n,e)=>e.some(t=>n instanceof t),xf,Lf;function sI(){return xf||(xf=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function oI(){return Lf||(Lf=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}var Mf=new WeakMap,Nc=new WeakMap,Ff=new WeakMap,Cc=new WeakMap,Dc=new WeakMap;function aI(n){let e=new Promise((t,r)=>{let i=()=>{n.removeEventListener("success",s),n.removeEventListener("error",o)},s=()=>{t(et(n.result)),i()},o=()=>{r(n.error),i()};n.addEventListener("success",s),n.addEventListener("error",o)});return e.then(t=>{t instanceof IDBCursor&&Mf.set(t,n)}).catch(()=>{}),Dc.set(e,n),e}function cI(n){if(Nc.has(n))return;let e=new Promise((t,r)=>{let i=()=>{n.removeEventListener("complete",s),n.removeEventListener("error",o),n.removeEventListener("abort",o)},s=()=>{t(),i()},o=()=>{r(n.error||new DOMException("AbortError","AbortError")),i()};n.addEventListener("complete",s),n.addEventListener("error",o),n.addEventListener("abort",o)});Nc.set(n,e)}var kc={get(n,e,t){if(n instanceof IDBTransaction){if(e==="done")return Nc.get(n);if(e==="objectStoreNames")return n.objectStoreNames||Ff.get(n);if(e==="store")return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return et(n[e])},set(n,e,t){return n[e]=t,!0},has(n,e){return n instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in n}};function Uf(n){kc=n(kc)}function uI(n){return n===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...t){let r=n.call(Vs(this),e,...t);return Ff.set(r,e.sort?e.sort():[e]),et(r)}:oI().includes(n)?function(...e){return n.apply(Vs(this),e),et(Mf.get(this))}:function(...e){return et(n.apply(Vs(this),e))}}function lI(n){return typeof n=="function"?uI(n):(n instanceof IDBTransaction&&cI(n),iI(n,sI())?new Proxy(n,kc):n)}function et(n){if(n instanceof IDBRequest)return aI(n);if(Cc.has(n))return Cc.get(n);let e=lI(n);return e!==n&&(Cc.set(n,e),Dc.set(e,n)),e}var Vs=n=>Dc.get(n);function qf(n,e,{blocked:t,upgrade:r,blocking:i,terminated:s}={}){let o=indexedDB.open(n,e),c=et(o);return r&&o.addEventListener("upgradeneeded",u=>{r(et(o.result),u.oldVersion,u.newVersion,et(o.transaction),u)}),t&&o.addEventListener("blocked",u=>t(u.oldVersion,u.newVersion,u)),c.then(u=>{s&&u.addEventListener("close",()=>s()),i&&u.addEventListener("versionchange",h=>i(h.oldVersion,h.newVersion,h))}).catch(()=>{}),c}var hI=["get","getKey","getAll","getAllKeys","count"],dI=["put","add","delete","clear"],Oc=new Map;function Bf(n,e){if(!(n instanceof IDBDatabase&&!(e in n)&&typeof e=="string"))return;if(Oc.get(e))return Oc.get(e);let t=e.replace(/FromIndex$/,""),r=e!==t,i=dI.includes(t);if(!(t in(r?IDBIndex:IDBObjectStore).prototype)||!(i||hI.includes(t)))return;let s=async function(o,...c){let u=this.transaction(o,i?"readwrite":"readonly"),h=u.store;return r&&(h=h.index(c.shift())),(await Promise.all([h[t](...c),i&&u.done]))[0]};return Oc.set(e,s),s}Uf(n=>({...n,get:(e,t,r)=>Bf(e,t)||n.get(e,t,r),has:(e,t)=>!!Bf(e,t)||n.has(e,t)}));var xc=class{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(t=>{if(fI(t)){let r=t.getImmediate();return`${r.library}/${r.version}`}else return null}).filter(t=>t).join(" ")}};function fI(n){return n.getComponent()?.type==="VERSION"}var Lc="@firebase/app",jf="0.14.6";var ut=new Pt("@firebase/app"),pI="@firebase/app-compat",mI="@firebase/analytics-compat",gI="@firebase/analytics",_I="@firebase/app-check-compat",yI="@firebase/app-check",II="@firebase/auth",wI="@firebase/auth-compat",EI="@firebase/database",TI="@firebase/data-connect",vI="@firebase/database-compat",AI="@firebase/functions",bI="@firebase/functions-compat",SI="@firebase/installations",RI="@firebase/installations-compat",PI="@firebase/messaging",CI="@firebase/messaging-compat",NI="@firebase/performance",kI="@firebase/performance-compat",DI="@firebase/remote-config",OI="@firebase/remote-config-compat",VI="@firebase/storage",xI="@firebase/storage-compat",LI="@firebase/firestore",MI="@firebase/ai",FI="@firebase/firestore-compat",UI="firebase",BI="12.6.0";var Mc="[DEFAULT]",qI={[Lc]:"fire-core",[pI]:"fire-core-compat",[gI]:"fire-analytics",[mI]:"fire-analytics-compat",[yI]:"fire-app-check",[_I]:"fire-app-check-compat",[II]:"fire-auth",[wI]:"fire-auth-compat",[EI]:"fire-rtdb",[TI]:"fire-data-connect",[vI]:"fire-rtdb-compat",[AI]:"fire-fn",[bI]:"fire-fn-compat",[SI]:"fire-iid",[RI]:"fire-iid-compat",[PI]:"fire-fcm",[CI]:"fire-fcm-compat",[NI]:"fire-perf",[kI]:"fire-perf-compat",[DI]:"fire-rc",[OI]:"fire-rc-compat",[VI]:"fire-gcs",[xI]:"fire-gcs-compat",[LI]:"fire-fst",[FI]:"fire-fst-compat",[MI]:"fire-vertex","fire-js":"fire-js",[UI]:"fire-js-all"};var xs=new Map,jI=new Map,Fc=new Map;function zf(n,e){try{n.container.addComponent(e)}catch(t){ut.debug(`Component ${e.name} failed to register with FirebaseApp ${n.name}`,t)}}function Nt(n){let e=n.name;if(Fc.has(e))return ut.debug(`There were multiple attempts to register component ${e}.`),!1;Fc.set(e,n);for(let t of xs.values())zf(t,n);for(let t of jI.values())zf(t,n);return!0}function si(n,e){let t=n.container.getProvider("heartbeat").getImmediate({optional:!0});return t&&t.triggerHeartbeat(),n.container.getProvider(e)}function De(n){return n==null?!1:n.settings!==void 0}var zI={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},Ct=new ct("app","Firebase",zI);var Uc=class{constructor(e,t,r){this._isDeleted=!1,this._options={...e},this._config={...t},this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new qe("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw Ct.create("app-deleted",{appName:this._name})}};var kt=BI;function jc(n,e={}){let t=n;typeof e!="object"&&(e={name:e});let r={name:Mc,automaticDataCollectionEnabled:!0,...e},i=r.name;if(typeof i!="string"||!i)throw Ct.create("bad-app-name",{appName:String(i)});if(t||(t=Ac()),!t)throw Ct.create("no-options");let s=xs.get(i);if(s){if(Ze(t,s.options)&&Ze(r,s.config))return s;throw Ct.create("duplicate-app",{appName:i})}let o=new Os(i);for(let u of Fc.values())o.addComponent(u);let c=new Uc(t,r,o);return xs.set(i,c),c}function Ls(n=Mc){let e=xs.get(n);if(!e&&n===Mc&&Ac())return jc();if(!e)throw Ct.create("no-app",{appName:n});return e}function $e(n,e,t){let r=qI[n]??n;t&&(r+=`-${t}`);let i=r.match(/\s|\//),s=e.match(/\s|\//);if(i||s){let o=[`Unable to register library "${r}" with version "${e}":`];i&&o.push(`library name "${r}" contains illegal characters (whitespace or "/")`),i&&s&&o.push("and"),s&&o.push(`version name "${e}" contains illegal characters (whitespace or "/")`),ut.warn(o.join(" "));return}Nt(new qe(`${r}-version`,()=>({library:r,version:e}),"VERSION"))}var GI="firebase-heartbeat-database",$I=1,ii="firebase-heartbeat-store",Vc=null;function Wf(){return Vc||(Vc=qf(GI,$I,{upgrade:(n,e)=>{switch(e){case 0:try{n.createObjectStore(ii)}catch(t){console.warn(t)}}}}).catch(n=>{throw Ct.create("idb-open",{originalErrorMessage:n.message})})),Vc}async function KI(n){try{let t=(await Wf()).transaction(ii),r=await t.objectStore(ii).get(Hf(n));return await t.done,r}catch(e){if(e instanceof Le)ut.warn(e.message);else{let t=Ct.create("idb-get",{originalErrorMessage:e?.message});ut.warn(t.message)}}}async function Gf(n,e){try{let r=(await Wf()).transaction(ii,"readwrite");await r.objectStore(ii).put(e,Hf(n)),await r.done}catch(t){if(t instanceof Le)ut.warn(t.message);else{let r=Ct.create("idb-set",{originalErrorMessage:t?.message});ut.warn(r.message)}}}function Hf(n){return`${n.name}!${n.options.appId}`}var WI=1024,HI=30,Bc=class{constructor(e){this.container=e,this._heartbeatsCache=null;let t=this.container.getProvider("app").getImmediate();this._storage=new qc(t),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}async triggerHeartbeat(){try{let t=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),r=$f();if(this._heartbeatsCache?.heartbeats==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null)||this._heartbeatsCache.lastSentHeartbeatDate===r||this._heartbeatsCache.heartbeats.some(i=>i.date===r))return;if(this._heartbeatsCache.heartbeats.push({date:r,agent:t}),this._heartbeatsCache.heartbeats.length>HI){let i=JI(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(i,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(e){ut.warn(e)}}async getHeartbeatsHeader(){try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null||this._heartbeatsCache.heartbeats.length===0)return"";let e=$f(),{heartbeatsToSend:t,unsentEntries:r}=QI(this._heartbeatsCache.heartbeats),i=ri(JSON.stringify({version:2,heartbeats:t}));return this._heartbeatsCache.lastSentHeartbeatDate=e,r.length>0?(this._heartbeatsCache.heartbeats=r,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),i}catch(e){return ut.warn(e),""}}};function $f(){return new Date().toISOString().substring(0,10)}function QI(n,e=WI){let t=[],r=n.slice();for(let i of n){let s=t.find(o=>o.agent===i.agent);if(s){if(s.dates.push(i.date),Kf(t)>e){s.dates.pop();break}}else if(t.push({agent:i.agent,dates:[i.date]}),Kf(t)>e){t.pop();break}r=r.slice(1)}return{heartbeatsToSend:t,unsentEntries:r}}var qc=class{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return Ds()?Df().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){let t=await KI(this.app);return t?.heartbeats?t:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){if(await this._canUseIndexedDBPromise){let r=await this.read();return Gf(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??r.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){if(await this._canUseIndexedDBPromise){let r=await this.read();return Gf(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??r.lastSentHeartbeatDate,heartbeats:[...r.heartbeats,...e.heartbeats]})}else return}};function Kf(n){return ri(JSON.stringify({version:2,heartbeats:n})).length}function JI(n){if(n.length===0)return-1;let e=0,t=n[0].date;for(let r=1;r<n.length;r++)n[r].date<t&&(t=n[r].date,e=r);return e}function YI(n){Nt(new qe("platform-logger",e=>new xc(e),"PRIVATE")),Nt(new qe("heartbeat",e=>new Bc(e),"PRIVATE")),$e(Lc,jf,n),$e(Lc,jf,"esm2020"),$e("fire-js","")}YI("");var XI="firebase",ZI="12.6.0";$e(XI,ZI,"app");function fp(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}var pp=fp,mp=new ct("auth","Firebase",fp());var zs=new Pt("@firebase/auth");function ew(n,...e){zs.logLevel<=W.WARN&&zs.warn(`Auth (${kt}): ${n}`,...e)}function Fs(n,...e){zs.logLevel<=W.ERROR&&zs.error(`Auth (${kt}): ${n}`,...e)}function Ke(n,...e){throw fu(n,...e)}function nt(n,...e){return fu(n,...e)}function gp(n,e,t){let r={...pp(),[e]:t};return new ct("auth","Firebase",r).create(e,{appName:n.name})}function ht(n){return gp(n,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function fu(n,...e){if(typeof n!="string"){let t=e[0],r=[...e.slice(1)];return r[0]&&(r[0].appName=n.name),n._errorFactory.create(t,...r)}return mp.create(n,...e)}function M(n,e,...t){if(!n)throw fu(e,...t)}function tt(n){let e="INTERNAL ASSERTION FAILED: "+n;throw Fs(e),new Error(e)}function dt(n,e){n||tt(e)}function Hc(){return typeof self<"u"&&self.location?.href||""}function tw(){return Qf()==="http:"||Qf()==="https:"}function Qf(){return typeof self<"u"&&self.location?.protocol||null}function nw(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(tw()||Cf()||"connection"in navigator)?navigator.onLine:!0}function rw(){if(typeof navigator>"u")return null;let n=navigator;return n.languages&&n.languages[0]||n.language||null}var hn=class{constructor(e,t){this.shortDelay=e,this.longDelay=t,dt(t>e,"Short delay should be less than long delay!"),this.isMobile=Sf()||Nf()}get(){return nw()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}};function pu(n,e){dt(n.emulator,"Emulator should always be set here");let{url:t}=n.emulator;return e?`${t}${e.startsWith("/")?e.slice(1):e}`:t}var Gs=class{static initialize(e,t,r){this.fetchImpl=e,t&&(this.headersImpl=t),r&&(this.responseImpl=r)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;tt("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;tt("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;tt("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}};var iw={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};var sw=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],ow=new hn(3e4,6e4);function pe(n,e){return n.tenantId&&!e.tenantId?{...e,tenantId:n.tenantId}:e}async function ve(n,e,t,r,i={}){return _p(n,i,async()=>{let s={},o={};r&&(e==="GET"?o=r:s={body:JSON.stringify(r)});let c=Wn({key:n.config.apiKey,...o}).slice(1),u=await n._getAdditionalHeaders();u["Content-Type"]="application/json",n.languageCode&&(u["X-Firebase-Locale"]=n.languageCode);let h={method:e,headers:u,...s};return Pf()||(h.referrerPolicy="no-referrer"),n.emulatorConfig&&Rt(n.emulatorConfig.host)&&(h.credentials="include"),Gs.fetch()(await yp(n,n.config.apiHost,t,c),h)})}async function _p(n,e,t){n._canInitEmulator=!1;let r={...iw,...e};try{let i=new Qc(n),s=await Promise.race([t(),i.promise]);i.clearNetworkTimeout();let o=await s.json();if("needConfirmation"in o)throw ai(n,"account-exists-with-different-credential",o);if(s.ok&&!("errorMessage"in o))return o;{let c=s.ok?o.errorMessage:o.error.message,[u,h]=c.split(" : ");if(u==="FEDERATED_USER_ID_ALREADY_LINKED")throw ai(n,"credential-already-in-use",o);if(u==="EMAIL_EXISTS")throw ai(n,"email-already-in-use",o);if(u==="USER_DISABLED")throw ai(n,"user-disabled",o);let f=r[u]||u.toLowerCase().replace(/[_\s]+/g,"-");if(h)throw gp(n,f,h);Ke(n,f)}}catch(i){if(i instanceof Le)throw i;Ke(n,"network-request-failed",{message:String(i)})}}async function Vt(n,e,t,r,i={}){let s=await ve(n,e,t,r,i);return"mfaPendingCredential"in s&&Ke(n,"multi-factor-auth-required",{_serverResponse:s}),s}async function yp(n,e,t,r){let i=`${e}${t}?${r}`,s=n,o=s.config.emulator?pu(n.config,i):`${n.config.apiScheme}://${i}`;return sw.includes(t)&&(await s._persistenceManagerAvailable,s._getPersistenceType()==="COOKIE")?s._getPersistence()._getFinalTarget(o).toString():o}function aw(n){switch(n){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}var Qc=class{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((t,r)=>{this.timer=setTimeout(()=>r(nt(this.auth,"network-request-failed")),ow.get())})}};function ai(n,e,t){let r={appName:n.name};t.email&&(r.email=t.email),t.phoneNumber&&(r.phoneNumber=t.phoneNumber);let i=nt(n,e,r);return i.customData._tokenResponse=t,i}function Jf(n){return n!==void 0&&n.enterprise!==void 0}var $s=class{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(let t of this.recaptchaEnforcementState)if(t.provider&&t.provider===e)return aw(t.enforcementState);return null}isProviderEnabled(e){return this.getProviderEnforcementState(e)==="ENFORCE"||this.getProviderEnforcementState(e)==="AUDIT"}isAnyProviderEnabled(){return this.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")||this.isProviderEnabled("PHONE_PROVIDER")}};async function Ip(n,e){return ve(n,"GET","/v2/recaptchaConfig",pe(n,e))}async function cw(n,e){return ve(n,"POST","/v1/accounts:delete",e)}async function Ks(n,e){return ve(n,"POST","/v1/accounts:lookup",e)}function ci(n){if(n)try{let e=new Date(Number(n));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function wp(n,e=!1){let t=ce(n),r=await t.getIdToken(e),i=mu(r);M(i&&i.exp&&i.auth_time&&i.iat,t.auth,"internal-error");let s=typeof i.firebase=="object"?i.firebase:void 0,o=s?.sign_in_provider;return{claims:i,token:r,authTime:ci(zc(i.auth_time)),issuedAtTime:ci(zc(i.iat)),expirationTime:ci(zc(i.exp)),signInProvider:o||null,signInSecondFactor:s?.sign_in_second_factor||null}}function zc(n){return Number(n)*1e3}function mu(n){let[e,t,r]=n.split(".");if(e===void 0||t===void 0||r===void 0)return Fs("JWT malformed, contained fewer than 3 sections"),null;try{let i=Ps(t);return i?JSON.parse(i):(Fs("Failed to decode base64 JWT payload"),null)}catch(i){return Fs("Caught error parsing JWT payload as JSON",i?.toString()),null}}function Yf(n){let e=mu(n);return M(e,"internal-error"),M(typeof e.exp<"u","internal-error"),M(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}async function hi(n,e,t=!1){if(t)return e;try{return await e}catch(r){throw r instanceof Le&&uw(r)&&n.auth.currentUser===n&&await n.auth.signOut(),r}}function uw({code:n}){return n==="auth/user-disabled"||n==="auth/user-token-expired"}var Jc=class{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){if(e){let t=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),t}else{this.errorBackoff=3e4;let r=(this.user.stsTokenManager.expirationTime??0)-Date.now()-3e5;return Math.max(0,r)}}schedule(e=!1){if(!this.isRunning)return;let t=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},t)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){e?.code==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}};var di=class{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=ci(this.lastLoginAt),this.creationTime=ci(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}};async function Ws(n){let e=n.auth,t=await n.getIdToken(),r=await hi(n,Ks(e,{idToken:t}));M(r?.users.length,e,"internal-error");let i=r.users[0];n._notifyReloadListener(i);let s=i.providerUserInfo?.length?Tp(i.providerUserInfo):[],o=lw(n.providerData,s),c=n.isAnonymous,u=!(n.email&&i.passwordHash)&&!o?.length,h=c?u:!1,f={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:o,metadata:new di(i.createdAt,i.lastLoginAt),isAnonymous:h};Object.assign(n,f)}async function Ep(n){let e=ce(n);await Ws(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function lw(n,e){return[...n.filter(r=>!e.some(i=>i.providerId===r.providerId)),...e]}function Tp(n){return n.map(({providerId:e,...t})=>({providerId:e,uid:t.rawId||"",displayName:t.displayName||null,email:t.email||null,phoneNumber:t.phoneNumber||null,photoURL:t.photoUrl||null}))}async function hw(n,e){let t=await _p(n,{},async()=>{let r=Wn({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:i,apiKey:s}=n.config,o=await yp(n,i,"/v1/token",`key=${s}`),c=await n._getAdditionalHeaders();c["Content-Type"]="application/x-www-form-urlencoded";let u={method:"POST",headers:c,body:r};return n.emulatorConfig&&Rt(n.emulatorConfig.host)&&(u.credentials="include"),Gs.fetch()(o,u)});return{accessToken:t.access_token,expiresIn:t.expires_in,refreshToken:t.refresh_token}}async function dw(n,e){return ve(n,"POST","/v2/accounts:revokeToken",pe(n,e))}var ui=class n{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){M(e.idToken,"internal-error"),M(typeof e.idToken<"u","internal-error"),M(typeof e.refreshToken<"u","internal-error");let t="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):Yf(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}updateFromIdToken(e){M(e.length!==0,"internal-error");let t=Yf(e);this.updateTokensAndExpiration(e,null,t)}async getToken(e,t=!1){return!t&&this.accessToken&&!this.isExpired?this.accessToken:(M(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,t){let{accessToken:r,refreshToken:i,expiresIn:s}=await hw(e,t);this.updateTokensAndExpiration(r,i,Number(s))}updateTokensAndExpiration(e,t,r){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+r*1e3}static fromJSON(e,t){let{refreshToken:r,accessToken:i,expirationTime:s}=t,o=new n;return r&&(M(typeof r=="string","internal-error",{appName:e}),o.refreshToken=r),i&&(M(typeof i=="string","internal-error",{appName:e}),o.accessToken=i),s&&(M(typeof s=="number","internal-error",{appName:e}),o.expirationTime=s),o}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new n,this.toJSON())}_performRefresh(){return tt("not implemented")}};function Dt(n,e){M(typeof n=="string"||typeof n>"u","internal-error",{appName:e})}var Ot=class n{constructor({uid:e,auth:t,stsTokenManager:r,...i}){this.providerId="firebase",this.proactiveRefresh=new Jc(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=e,this.auth=t,this.stsTokenManager=r,this.accessToken=r.accessToken,this.displayName=i.displayName||null,this.email=i.email||null,this.emailVerified=i.emailVerified||!1,this.phoneNumber=i.phoneNumber||null,this.photoURL=i.photoURL||null,this.isAnonymous=i.isAnonymous||!1,this.tenantId=i.tenantId||null,this.providerData=i.providerData?[...i.providerData]:[],this.metadata=new di(i.createdAt||void 0,i.lastLoginAt||void 0)}async getIdToken(e){let t=await hi(this,this.stsTokenManager.getToken(this.auth,e));return M(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t}getIdTokenResult(e){return wp(this,e)}reload(){return Ep(this)}_assign(e){this!==e&&(M(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(t=>({...t})),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){let t=new n({...this,auth:e,stsTokenManager:this.stsTokenManager._clone()});return t.metadata._copy(this.metadata),t}_onReload(e){M(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,t=!1){let r=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),r=!0),t&&await Ws(this),await this.auth._persistUserIfCurrent(this),r&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(De(this.auth.app))return Promise.reject(ht(this.auth));let e=await this.getIdToken();return await hi(this,cw(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return{uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>({...e})),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId,...this.metadata.toJSON(),apiKey:this.auth.config.apiKey,appName:this.auth.name}}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){let r=t.displayName??void 0,i=t.email??void 0,s=t.phoneNumber??void 0,o=t.photoURL??void 0,c=t.tenantId??void 0,u=t._redirectEventId??void 0,h=t.createdAt??void 0,f=t.lastLoginAt??void 0,{uid:m,emailVerified:_,isAnonymous:R,providerData:k,stsTokenManager:O}=t;M(m&&O,e,"internal-error");let N=ui.fromJSON(this.name,O);M(typeof m=="string",e,"internal-error"),Dt(r,e.name),Dt(i,e.name),M(typeof _=="boolean",e,"internal-error"),M(typeof R=="boolean",e,"internal-error"),Dt(s,e.name),Dt(o,e.name),Dt(c,e.name),Dt(u,e.name),Dt(h,e.name),Dt(f,e.name);let j=new n({uid:m,auth:e,email:i,emailVerified:_,displayName:r,isAnonymous:R,photoURL:o,phoneNumber:s,tenantId:c,stsTokenManager:N,createdAt:h,lastLoginAt:f});return k&&Array.isArray(k)&&(j.providerData=k.map(q=>({...q}))),u&&(j._redirectEventId=u),j}static async _fromIdTokenResponse(e,t,r=!1){let i=new ui;i.updateFromServerResponse(t);let s=new n({uid:t.localId,auth:e,stsTokenManager:i,isAnonymous:r});return await Ws(s),s}static async _fromGetAccountInfoResponse(e,t,r){let i=t.users[0];M(i.localId!==void 0,"internal-error");let s=i.providerUserInfo!==void 0?Tp(i.providerUserInfo):[],o=!(i.email&&i.passwordHash)&&!s?.length,c=new ui;c.updateFromIdToken(r);let u=new n({uid:i.localId,auth:e,stsTokenManager:c,isAnonymous:o}),h={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:s,metadata:new di(i.createdAt,i.lastLoginAt),isAnonymous:!(i.email&&i.passwordHash)&&!s?.length};return Object.assign(u,h),u}};var Xf=new Map;function lt(n){dt(n instanceof Function,"Expected a class definition");let e=Xf.get(n);return e?(dt(e instanceof n,"Instance stored in cache mismatched with class"),e):(e=new n,Xf.set(n,e),e)}var Hs=class{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,t){this.storage[e]=t}async _get(e){let t=this.storage[e];return t===void 0?null:t}async _remove(e){delete this.storage[e]}_addListener(e,t){}_removeListener(e,t){}};Hs.type="NONE";var Yc=Hs;function Us(n,e,t){return`firebase:${n}:${e}:${t}`}var Qs=class n{constructor(e,t,r){this.persistence=e,this.auth=t,this.userKey=r;let{config:i,name:s}=this.auth;this.fullUserKey=Us(this.userKey,i.apiKey,s),this.fullPersistenceKey=Us("persistence",i.apiKey,s),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){let e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){let t=await Ks(this.auth,{idToken:e}).catch(()=>{});return t?Ot._fromGetAccountInfoResponse(this.auth,t,e):null}return Ot._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;let t=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,t)return this.setCurrentUser(t)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,t,r="authUser"){if(!t.length)return new n(lt(Yc),e,r);let i=(await Promise.all(t.map(async h=>{if(await h._isAvailable())return h}))).filter(h=>h),s=i[0]||lt(Yc),o=Us(r,e.config.apiKey,e.name),c=null;for(let h of t)try{let f=await h._get(o);if(f){let m;if(typeof f=="string"){let _=await Ks(e,{idToken:f}).catch(()=>{});if(!_)break;m=await Ot._fromGetAccountInfoResponse(e,_,f)}else m=Ot._fromJSON(e,f);h!==s&&(c=m),s=h;break}}catch{}let u=i.filter(h=>h._shouldAllowMigration);return!s._shouldAllowMigration||!u.length?new n(s,e,r):(s=u[0],c&&await s._set(o,c.toJSON()),await Promise.all(t.map(async h=>{if(h!==s)try{await h._remove(o)}catch{}})),new n(s,e,r))}};function Zf(n){let e=n.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(Sp(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(vp(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(Pp(e))return"Blackberry";if(Cp(e))return"Webos";if(Ap(e))return"Safari";if((e.includes("chrome/")||bp(e))&&!e.includes("edge/"))return"Chrome";if(Rp(e))return"Android";{let t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,r=n.match(t);if(r?.length===2)return r[1]}return"Other"}function vp(n=ue()){return/firefox\//i.test(n)}function Ap(n=ue()){let e=n.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function bp(n=ue()){return/crios\//i.test(n)}function Sp(n=ue()){return/iemobile/i.test(n)}function Rp(n=ue()){return/android/i.test(n)}function Pp(n=ue()){return/blackberry/i.test(n)}function Cp(n=ue()){return/webos/i.test(n)}function gu(n=ue()){return/iphone|ipad|ipod/i.test(n)||/macintosh/i.test(n)&&/mobile/i.test(n)}function fw(n=ue()){return gu(n)&&!!window.navigator?.standalone}function pw(){return kf()&&document.documentMode===10}function Np(n=ue()){return gu(n)||Rp(n)||Cp(n)||Pp(n)||/windows phone/i.test(n)||Sp(n)}function kp(n,e=[]){let t;switch(n){case"Browser":t=Zf(ue());break;case"Worker":t=`${Zf(ue())}-${n}`;break;default:t=n}let r=e.length?e.join(","):"FirebaseCore-web";return`${t}/JsCore/${kt}/${r}`}var Xc=class{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){let r=s=>new Promise((o,c)=>{try{let u=e(s);o(u)}catch(u){c(u)}});r.onAbort=t,this.queue.push(r);let i=this.queue.length-1;return()=>{this.queue[i]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;let t=[];try{for(let r of this.queue)await r(e),r.onAbort&&t.push(r.onAbort)}catch(r){t.reverse();for(let i of t)try{i()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:r?.message})}}};async function mw(n,e={}){return ve(n,"GET","/v2/passwordPolicy",pe(n,e))}var gw=6,Zc=class{constructor(e){let t=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=t.minPasswordLength??gw,t.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=t.maxPasswordLength),t.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=t.containsLowercaseCharacter),t.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=t.containsUppercaseCharacter),t.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=t.containsNumericCharacter),t.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=t.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=e.allowedNonAlphanumericCharacters?.join("")??"",this.forceUpgradeOnSignin=e.forceUpgradeOnSignin??!1,this.schemaVersion=e.schemaVersion}validatePassword(e){let t={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,t),this.validatePasswordCharacterOptions(e,t),t.isValid&&(t.isValid=t.meetsMinPasswordLength??!0),t.isValid&&(t.isValid=t.meetsMaxPasswordLength??!0),t.isValid&&(t.isValid=t.containsLowercaseLetter??!0),t.isValid&&(t.isValid=t.containsUppercaseLetter??!0),t.isValid&&(t.isValid=t.containsNumericCharacter??!0),t.isValid&&(t.isValid=t.containsNonAlphanumericCharacter??!0),t}validatePasswordLengthOptions(e,t){let r=this.customStrengthOptions.minPasswordLength,i=this.customStrengthOptions.maxPasswordLength;r&&(t.meetsMinPasswordLength=e.length>=r),i&&(t.meetsMaxPasswordLength=e.length<=i)}validatePasswordCharacterOptions(e,t){this.updatePasswordCharacterOptionsStatuses(t,!1,!1,!1,!1);let r;for(let i=0;i<e.length;i++)r=e.charAt(i),this.updatePasswordCharacterOptionsStatuses(t,r>="a"&&r<="z",r>="A"&&r<="Z",r>="0"&&r<="9",this.allowedNonAlphanumericCharacters.includes(r))}updatePasswordCharacterOptionsStatuses(e,t,r,i,s){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=t)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=r)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=i)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=s))}};var eu=class{constructor(e,t,r,i){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=r,this.config=i,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new Js(this),this.idTokenSubscription=new Js(this),this.beforeStateQueue=new Xc(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=mp,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=i.sdkClientVersion,this._persistenceManagerAvailable=new Promise(s=>this._resolvePersistenceManagerAvailable=s)}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=lt(t)),this._initializationPromise=this.queue(async()=>{if(!this._deleted&&(this.persistenceManager=await Qs.create(this,e),this._resolvePersistenceManagerAvailable?.(),!this._deleted)){if(this._popupRedirectResolver?._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(t),this.lastNotifiedUid=this.currentUser?.uid||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;let e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{let t=await Ks(this,{idToken:e}),r=await Ot._fromGetAccountInfoResponse(this,t,e);await this.directlySetCurrentUser(r)}catch(t){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",t),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){if(De(this.app)){let s=this.app.settings.authIdToken;return s?new Promise(o=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(s).then(o,o))}):this.directlySetCurrentUser(null)}let t=await this.assertedPersistence.getCurrentUser(),r=t,i=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();let s=this.redirectUser?._redirectEventId,o=r?._redirectEventId,c=await this.tryRedirectSignIn(e);(!s||s===o)&&c?.user&&(r=c.user,i=!0)}if(!r)return this.directlySetCurrentUser(null);if(!r._redirectEventId){if(i)try{await this.beforeStateQueue.runMiddleware(r)}catch(s){r=t,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(s))}return r?this.reloadAndSetCurrentUserOrClear(r):this.directlySetCurrentUser(null)}return M(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===r._redirectEventId?this.directlySetCurrentUser(r):this.reloadAndSetCurrentUserOrClear(r)}async tryRedirectSignIn(e){let t=null;try{t=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return t}async reloadAndSetCurrentUserOrClear(e){try{await Ws(e)}catch(t){if(t?.code!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=rw()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(De(this.app))return Promise.reject(ht(this));let t=e?ce(e):null;return t&&M(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))}async _updateCurrentUser(e,t=!1){if(!this._deleted)return e&&M(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return De(this.app)?Promise.reject(ht(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return De(this.app)?Promise.reject(ht(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(lt(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();let t=this._getPasswordPolicyInternal();return t.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):t.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){let e=await mw(this),t=new Zc(e);this.tenantId===null?this._projectPasswordPolicy=t:this._tenantPasswordPolicies[this.tenantId]=t}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new ct("auth","Firebase",e())}onAuthStateChanged(e,t,r){return this.registerStateListener(this.authStateSubscription,e,t,r)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,r){return this.registerStateListener(this.idTokenSubscription,e,t,r)}authStateReady(){return new Promise((e,t)=>{if(this.currentUser)e();else{let r=this.onAuthStateChanged(()=>{r(),e()},t)}})}async revokeAccessToken(e){if(this.currentUser){let t=await this.currentUser.getIdToken(),r={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:t};this.tenantId!=null&&(r.tenantId=this.tenantId),await dw(this,r)}}toJSON(){return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:this._currentUser?.toJSON()}}async _setRedirectUser(e,t){let r=await this.getOrInitRedirectPersistenceManager(t);return e===null?r.removeCurrentUser():r.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){let t=e&&lt(e)||this._popupRedirectResolver;M(t,this,"argument-error"),this.redirectPersistenceManager=await Qs.create(this,[lt(t._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){return this._isInitialized&&await this.queue(async()=>{}),this._currentUser?._redirectEventId===e?this._currentUser:this.redirectUser?._redirectEventId===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);let e=this.currentUser?.uid??null;this.lastNotifiedUid!==e&&(this.lastNotifiedUid=e,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,r,i){if(this._deleted)return()=>{};let s=typeof t=="function"?t:t.next.bind(t),o=!1,c=this._isInitialized?Promise.resolve():this._initializationPromise;if(M(c,this,"internal-error"),c.then(()=>{o||s(this.currentUser)}),typeof t=="function"){let u=e.addObserver(t,r,i);return()=>{o=!0,u()}}else{let u=e.addObserver(t);return()=>{o=!0,u()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return M(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=kp(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){let e={"X-Client-Version":this.clientVersion};this.app.options.appId&&(e["X-Firebase-gmpid"]=this.app.options.appId);let t=await this.heartbeatServiceProvider.getImmediate({optional:!0})?.getHeartbeatsHeader();t&&(e["X-Firebase-Client"]=t);let r=await this._getAppCheckToken();return r&&(e["X-Firebase-AppCheck"]=r),e}async _getAppCheckToken(){if(De(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;let e=await this.appCheckServiceProvider.getImmediate({optional:!0})?.getToken();return e?.error&&ew(`Error while retrieving App Check token: ${e.error}`),e?.token}};function ft(n){return ce(n)}var Js=class{constructor(e){this.auth=e,this.observer=null,this.addObserver=Vf(t=>this.observer=t)}get next(){return M(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}};var mo={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function _w(n){mo=n}function Dp(n){return mo.loadJS(n)}function yw(){return mo.recaptchaEnterpriseScript}function Iw(){return mo.gapiScript}function Op(n){return`__${n}${Math.floor(Math.random()*1e6)}`}var tu=class{constructor(){this.enterprise=new nu}ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}},nu=class{ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}};var ww="recaptcha-enterprise",li="NO_RECAPTCHA",Ys=class{constructor(e){this.type=ww,this.auth=ft(e)}async verify(e="verify",t=!1){async function r(s){if(!t){if(s.tenantId==null&&s._agentRecaptchaConfig!=null)return s._agentRecaptchaConfig.siteKey;if(s.tenantId!=null&&s._tenantRecaptchaConfigs[s.tenantId]!==void 0)return s._tenantRecaptchaConfigs[s.tenantId].siteKey}return new Promise(async(o,c)=>{Ip(s,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(u=>{if(u.recaptchaKey===void 0)c(new Error("recaptcha Enterprise site key undefined"));else{let h=new $s(u);return s.tenantId==null?s._agentRecaptchaConfig=h:s._tenantRecaptchaConfigs[s.tenantId]=h,o(h.siteKey)}}).catch(u=>{c(u)})})}function i(s,o,c){let u=window.grecaptcha;Jf(u)?u.enterprise.ready(()=>{u.enterprise.execute(s,{action:e}).then(h=>{o(h)}).catch(()=>{o(li)})}):c(Error("No reCAPTCHA enterprise script loaded."))}return this.auth.settings.appVerificationDisabledForTesting?new tu().execute("siteKey",{action:"verify"}):new Promise((s,o)=>{r(this.auth).then(c=>{if(!t&&Jf(window.grecaptcha))i(c,s,o);else{if(typeof window>"u"){o(new Error("RecaptchaVerifier is only supported in browser"));return}let u=yw();u.length!==0&&(u+=c),Dp(u).then(()=>{i(c,s,o)}).catch(h=>{o(h)})}}).catch(c=>{o(c)})})}};async function oi(n,e,t,r=!1,i=!1){let s=new Ys(n),o;if(i)o=li;else try{o=await s.verify(t)}catch{o=await s.verify(t,!0)}let c={...e};if(t==="mfaSmsEnrollment"||t==="mfaSmsSignIn"){if("phoneEnrollmentInfo"in c){let u=c.phoneEnrollmentInfo.phoneNumber,h=c.phoneEnrollmentInfo.recaptchaToken;Object.assign(c,{phoneEnrollmentInfo:{phoneNumber:u,recaptchaToken:h,captchaResponse:o,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}else if("phoneSignInInfo"in c){let u=c.phoneSignInInfo.recaptchaToken;Object.assign(c,{phoneSignInInfo:{recaptchaToken:u,captchaResponse:o,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}return c}return r?Object.assign(c,{captchaResp:o}):Object.assign(c,{captchaResponse:o}),Object.assign(c,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(c,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),c}async function Jn(n,e,t,r,i){if(i==="EMAIL_PASSWORD_PROVIDER")if(n._getRecaptchaConfig()?.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){let s=await oi(n,e,t,t==="getOobCode");return r(n,s)}else return r(n,e).catch(async s=>{if(s.code==="auth/missing-recaptcha-token"){console.log(`${t} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);let o=await oi(n,e,t,t==="getOobCode");return r(n,o)}else return Promise.reject(s)});else if(i==="PHONE_PROVIDER")if(n._getRecaptchaConfig()?.isProviderEnabled("PHONE_PROVIDER")){let s=await oi(n,e,t);return r(n,s).catch(async o=>{if(n._getRecaptchaConfig()?.getProviderEnforcementState("PHONE_PROVIDER")==="AUDIT"&&(o.code==="auth/missing-recaptcha-token"||o.code==="auth/invalid-app-credential")){console.log(`Failed to verify with reCAPTCHA Enterprise. Automatically triggering the reCAPTCHA v2 flow to complete the ${t} flow.`);let c=await oi(n,e,t,!1,!0);return r(n,c)}return Promise.reject(o)})}else{let s=await oi(n,e,t,!1,!0);return r(n,s)}else return Promise.reject(i+" provider is not supported.")}async function Ew(n){let e=ft(n),t=await Ip(e,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}),r=new $s(t);e.tenantId==null?e._agentRecaptchaConfig=r:e._tenantRecaptchaConfigs[e.tenantId]=r,r.isAnyProviderEnabled()&&new Ys(e).verify()}function Vp(n,e){let t=si(n,"auth");if(t.isInitialized()){let i=t.getImmediate(),s=t.getOptions();if(Ze(s,e??{}))return i;Ke(i,"already-initialized")}return t.initialize({options:e})}function Tw(n,e){let t=e?.persistence||[],r=(Array.isArray(t)?t:[t]).map(lt);e?.errorMap&&n._updateErrorMap(e.errorMap),n._initializeWithPersistence(r,e?.popupRedirectResolver)}function xp(n,e,t){let r=ft(n);M(/^https?:\/\//.test(e),r,"invalid-emulator-scheme");let i=!!t?.disableWarnings,s=Lp(e),{host:o,port:c}=vw(e),u=c===null?"":`:${c}`,h={url:`${s}//${o}${u}/`},f=Object.freeze({host:o,port:c,protocol:s.replace(":",""),options:Object.freeze({disableWarnings:i})});if(!r._canInitEmulator){M(r.config.emulator&&r.emulatorConfig,r,"emulator-config-failed"),M(Ze(h,r.config.emulator)&&Ze(f,r.emulatorConfig),r,"emulator-config-failed");return}r.config.emulator=h,r.emulatorConfig=f,r.settings.appVerificationDisabledForTesting=!0,Rt(o)?(Ns(`${s}//${o}${u}`),ks("Auth",!0)):i||Aw()}function Lp(n){let e=n.indexOf(":");return e<0?"":n.substr(0,e+1)}function vw(n){let e=Lp(n),t=/(\/\/)?([^?#/]+)/.exec(n.substr(e.length));if(!t)return{host:"",port:null};let r=t[2].split("@").pop()||"",i=/^(\[[^\]]+\])(:|$)/.exec(r);if(i){let s=i[1];return{host:s,port:ep(r.substr(s.length+1))}}else{let[s,o]=r.split(":");return{host:s,port:ep(o)}}}function ep(n){if(!n)return null;let e=Number(n);return isNaN(e)?null:e}function Aw(){function n(){let e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",n):n())}var dn=class{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return tt("not implemented")}_getIdTokenResponse(e){return tt("not implemented")}_linkToIdToken(e,t){return tt("not implemented")}_getReauthenticationResolver(e){return tt("not implemented")}};async function bw(n,e){return ve(n,"POST","/v1/accounts:signUp",e)}async function Sw(n,e){return Vt(n,"POST","/v1/accounts:signInWithPassword",pe(n,e))}async function Rw(n,e){return Vt(n,"POST","/v1/accounts:signInWithEmailLink",pe(n,e))}async function Pw(n,e){return Vt(n,"POST","/v1/accounts:signInWithEmailLink",pe(n,e))}var fi=class n extends dn{constructor(e,t,r,i=null){super("password",r),this._email=e,this._password=t,this._tenantId=i}static _fromEmailAndPassword(e,t){return new n(e,t,"password")}static _fromEmailAndCode(e,t,r=null){return new n(e,t,"emailLink",r)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){let t=typeof e=="string"?JSON.parse(e):e;if(t?.email&&t?.password){if(t.signInMethod==="password")return this._fromEmailAndPassword(t.email,t.password);if(t.signInMethod==="emailLink")return this._fromEmailAndCode(t.email,t.password,t.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":let t={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return Jn(e,t,"signInWithPassword",Sw,"EMAIL_PASSWORD_PROVIDER");case"emailLink":return Rw(e,{email:this._email,oobCode:this._password});default:Ke(e,"internal-error")}}async _linkToIdToken(e,t){switch(this.signInMethod){case"password":let r={idToken:t,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return Jn(e,r,"signUpPassword",bw,"EMAIL_PASSWORD_PROVIDER");case"emailLink":return Pw(e,{idToken:t,email:this._email,oobCode:this._password});default:Ke(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}};async function Yn(n,e){return Vt(n,"POST","/v1/accounts:signInWithIdp",pe(n,e))}var Cw="http://localhost",fn=class n extends dn{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){let t=new n(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):Ke("argument-error"),t}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){let t=typeof e=="string"?JSON.parse(e):e,{providerId:r,signInMethod:i,...s}=t;if(!r||!i)return null;let o=new n(r,i);return o.idToken=s.idToken||void 0,o.accessToken=s.accessToken||void 0,o.secret=s.secret,o.nonce=s.nonce,o.pendingToken=s.pendingToken||null,o}_getIdTokenResponse(e){let t=this.buildRequest();return Yn(e,t)}_linkToIdToken(e,t){let r=this.buildRequest();return r.idToken=t,Yn(e,r)}_getReauthenticationResolver(e){let t=this.buildRequest();return t.autoCreate=!1,Yn(e,t)}buildRequest(){let e={requestUri:Cw,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{let t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=Wn(t)}return e}};async function tp(n,e){return ve(n,"POST","/v1/accounts:sendVerificationCode",pe(n,e))}async function Nw(n,e){return Vt(n,"POST","/v1/accounts:signInWithPhoneNumber",pe(n,e))}async function kw(n,e){let t=await Vt(n,"POST","/v1/accounts:signInWithPhoneNumber",pe(n,e));if(t.temporaryProof)throw ai(n,"account-exists-with-different-credential",t);return t}var Dw={USER_NOT_FOUND:"user-not-found"};async function Ow(n,e){let t={...e,operation:"REAUTH"};return Vt(n,"POST","/v1/accounts:signInWithPhoneNumber",pe(n,t),Dw)}var pi=class n extends dn{constructor(e){super("phone","phone"),this.params=e}static _fromVerification(e,t){return new n({verificationId:e,verificationCode:t})}static _fromTokenResponse(e,t){return new n({phoneNumber:e,temporaryProof:t})}_getIdTokenResponse(e){return Nw(e,this._makeVerificationRequest())}_linkToIdToken(e,t){return kw(e,{idToken:t,...this._makeVerificationRequest()})}_getReauthenticationResolver(e){return Ow(e,this._makeVerificationRequest())}_makeVerificationRequest(){let{temporaryProof:e,phoneNumber:t,verificationId:r,verificationCode:i}=this.params;return e&&t?{temporaryProof:e,phoneNumber:t}:{sessionInfo:r,code:i}}toJSON(){let e={providerId:this.providerId};return this.params.phoneNumber&&(e.phoneNumber=this.params.phoneNumber),this.params.temporaryProof&&(e.temporaryProof=this.params.temporaryProof),this.params.verificationCode&&(e.verificationCode=this.params.verificationCode),this.params.verificationId&&(e.verificationId=this.params.verificationId),e}static fromJSON(e){typeof e=="string"&&(e=JSON.parse(e));let{verificationId:t,verificationCode:r,phoneNumber:i,temporaryProof:s}=e;return!r&&!t&&!i&&!s?null:new n({verificationId:t,verificationCode:r,phoneNumber:i,temporaryProof:s})}};function Vw(n){switch(n){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function xw(n){let e=Hn(Qn(n)).link,t=e?Hn(Qn(e)).deep_link_id:null,r=Hn(Qn(n)).deep_link_id;return(r?Hn(Qn(r)).link:null)||r||t||e||n}var Xs=class n{constructor(e){let t=Hn(Qn(e)),r=t.apiKey??null,i=t.oobCode??null,s=Vw(t.mode??null);M(r&&i&&s,"argument-error"),this.apiKey=r,this.operation=s,this.code=i,this.continueUrl=t.continueUrl??null,this.languageCode=t.lang??null,this.tenantId=t.tenantId??null}static parseLink(e){let t=xw(e);try{return new n(t)}catch{return null}}};var pn=class n{constructor(){this.providerId=n.PROVIDER_ID}static credential(e,t){return fi._fromEmailAndPassword(e,t)}static credentialWithLink(e,t){let r=Xs.parseLink(t);return M(r,"argument-error"),fi._fromEmailAndCode(e,r.code,r.tenantId)}};pn.PROVIDER_ID="password";pn.EMAIL_PASSWORD_SIGN_IN_METHOD="password";pn.EMAIL_LINK_SIGN_IN_METHOD="emailLink";var Zs=class{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}};var mn=class extends Zs{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}};var mi=class n extends mn{constructor(){super("facebook.com")}static credential(e){return fn._fromParams({providerId:n.PROVIDER_ID,signInMethod:n.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return n.credentialFromTaggedObject(e)}static credentialFromError(e){return n.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return n.credential(e.oauthAccessToken)}catch{return null}}};mi.FACEBOOK_SIGN_IN_METHOD="facebook.com";mi.PROVIDER_ID="facebook.com";var gi=class n extends mn{constructor(){super("google.com"),this.addScope("profile")}static credential(e,t){return fn._fromParams({providerId:n.PROVIDER_ID,signInMethod:n.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:t})}static credentialFromResult(e){return n.credentialFromTaggedObject(e)}static credentialFromError(e){return n.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;let{oauthIdToken:t,oauthAccessToken:r}=e;if(!t&&!r)return null;try{return n.credential(t,r)}catch{return null}}};gi.GOOGLE_SIGN_IN_METHOD="google.com";gi.PROVIDER_ID="google.com";var _i=class n extends mn{constructor(){super("github.com")}static credential(e){return fn._fromParams({providerId:n.PROVIDER_ID,signInMethod:n.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return n.credentialFromTaggedObject(e)}static credentialFromError(e){return n.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return n.credential(e.oauthAccessToken)}catch{return null}}};_i.GITHUB_SIGN_IN_METHOD="github.com";_i.PROVIDER_ID="github.com";var yi=class n extends mn{constructor(){super("twitter.com")}static credential(e,t){return fn._fromParams({providerId:n.PROVIDER_ID,signInMethod:n.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:t})}static credentialFromResult(e){return n.credentialFromTaggedObject(e)}static credentialFromError(e){return n.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;let{oauthAccessToken:t,oauthTokenSecret:r}=e;if(!t||!r)return null;try{return n.credential(t,r)}catch{return null}}};yi.TWITTER_SIGN_IN_METHOD="twitter.com";yi.PROVIDER_ID="twitter.com";async function Lw(n,e){return Vt(n,"POST","/v1/accounts:signUp",pe(n,e))}var Xn=class n{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,t,r,i=!1){let s=await Ot._fromIdTokenResponse(e,r,i),o=np(r);return new n({user:s,providerId:o,_tokenResponse:r,operationType:t})}static async _forOperation(e,t,r){await e._updateTokensIfNecessary(r,!0);let i=np(r);return new n({user:e,providerId:i,_tokenResponse:r,operationType:t})}};function np(n){return n.providerId?n.providerId:"phoneNumber"in n?"phone":null}var ru=class n extends Le{constructor(e,t,r,i){super(t.code,t.message),this.operationType=r,this.user=i,Object.setPrototypeOf(this,n.prototype),this.customData={appName:e.name,tenantId:e.tenantId??void 0,_serverResponse:t.customData._serverResponse,operationType:r}}static _fromErrorAndOperation(e,t,r,i){return new n(e,t,r,i)}};function Mp(n,e,t,r){return(e==="reauthenticate"?t._getReauthenticationResolver(n):t._getIdTokenResponse(n)).catch(s=>{throw s.code==="auth/multi-factor-auth-required"?ru._fromErrorAndOperation(n,s,e,r):s})}async function Mw(n,e,t=!1){let r=await hi(n,e._linkToIdToken(n.auth,await n.getIdToken()),t);return Xn._forOperation(n,"link",r)}async function Fw(n,e,t=!1){let{auth:r}=n;if(De(r.app))return Promise.reject(ht(r));let i="reauthenticate";try{let s=await hi(n,Mp(r,i,e,n),t);M(s.idToken,r,"internal-error");let o=mu(s.idToken);M(o,r,"internal-error");let{sub:c}=o;return M(n.uid===c,r,"user-mismatch"),Xn._forOperation(n,i,s)}catch(s){throw s?.code==="auth/user-not-found"&&Ke(r,"user-mismatch"),s}}async function Fp(n,e,t=!1){if(De(n.app))return Promise.reject(ht(n));let r="signIn",i=await Mp(n,r,e),s=await Xn._fromIdTokenResponse(n,r,i);return t||await n._updateCurrentUser(s.user),s}async function Up(n,e){return Fp(ft(n),e)}async function Bp(n){let e=ft(n);e._getPasswordPolicyInternal()&&await e._updatePasswordPolicy()}async function _u(n,e,t){if(De(n.app))return Promise.reject(ht(n));let r=ft(n),o=await Jn(r,{returnSecureToken:!0,email:e,password:t,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",Lw,"EMAIL_PASSWORD_PROVIDER").catch(u=>{throw u.code==="auth/password-does-not-meet-requirements"&&Bp(n),u}),c=await Xn._fromIdTokenResponse(r,"signIn",o);return await r._updateCurrentUser(c.user),c}function yu(n,e,t){return De(n.app)?Promise.reject(ht(n)):Up(ce(n),pn.credential(e,t)).catch(async r=>{throw r.code==="auth/password-does-not-meet-requirements"&&Bp(n),r})}function Iu(n,e){return ce(n).setPersistence(e)}function qp(n,e,t,r){return ce(n).onIdTokenChanged(e,t,r)}function jp(n,e,t){return ce(n).beforeAuthStateChanged(e,t)}function wu(n,e,t,r){return ce(n).onAuthStateChanged(e,t,r)}function Eu(n){return ce(n).signOut()}function rp(n,e){return ve(n,"POST","/v2/accounts/mfaEnrollment:start",pe(n,e))}function Uw(n,e){return ve(n,"POST","/v2/accounts/mfaEnrollment:finalize",pe(n,e))}function Bw(n,e){return ve(n,"POST","/v2/accounts/mfaEnrollment:start",pe(n,e))}function qw(n,e){return ve(n,"POST","/v2/accounts/mfaEnrollment:finalize",pe(n,e))}var eo="__sak";var to=class{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem(eo,"1"),this.storage.removeItem(eo),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){let t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}};var jw=1e3,zw=10,no=class extends to{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,t)=>this.onStorageEvent(e,t),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=Np(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(let t of Object.keys(this.listeners)){let r=this.storage.getItem(t),i=this.localCache[t];r!==i&&e(t,i,r)}}onStorageEvent(e,t=!1){if(!e.key){this.forAllChangedKeys((o,c,u)=>{this.notifyListeners(o,u)});return}let r=e.key;t?this.detachListener():this.stopPolling();let i=()=>{let o=this.storage.getItem(r);!t&&this.localCache[r]===o||this.notifyListeners(r,o)},s=this.storage.getItem(r);pw()&&s!==e.newValue&&e.newValue!==e.oldValue?setTimeout(i,zw):i()}notifyListeners(e,t){this.localCache[e]=t;let r=this.listeners[e];if(r)for(let i of Array.from(r))i(t&&JSON.parse(t))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,t,r)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:t,newValue:r}),!0)})},jw)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,t){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,t){await super._set(e,t),this.localCache[e]=JSON.stringify(t)}async _get(e){let t=await super._get(e);return this.localCache[e]=JSON.stringify(t),t}async _remove(e){await super._remove(e),delete this.localCache[e]}};no.type="LOCAL";var zp=no;var Gw=1e3;function Gc(n){let e=n.replace(/[\\^$.*+?()[\]{}|]/g,"\\$&"),t=RegExp(`${e}=([^;]+)`);return document.cookie.match(t)?.[1]??null}function $c(n){return`${window.location.protocol==="http:"?"__dev_":"__HOST-"}FIREBASE_${n.split(":")[3]}`}var iu=class{constructor(){this.type="COOKIE",this.listenerUnsubscribes=new Map}_getFinalTarget(e){if(typeof window===void 0)return e;let t=new URL(`${window.location.origin}/__cookies__`);return t.searchParams.set("finalTarget",e),t}async _isAvailable(){return typeof isSecureContext=="boolean"&&!isSecureContext||typeof navigator>"u"||typeof document>"u"?!1:navigator.cookieEnabled??!0}async _set(e,t){}async _get(e){if(!this._isAvailable())return null;let t=$c(e);return window.cookieStore?(await window.cookieStore.get(t))?.value:Gc(t)}async _remove(e){if(!this._isAvailable()||!await this._get(e))return;let r=$c(e);document.cookie=`${r}=;Max-Age=34560000;Partitioned;Secure;SameSite=Strict;Path=/;Priority=High`,await fetch("/__cookies__",{method:"DELETE"}).catch(()=>{})}_addListener(e,t){if(!this._isAvailable())return;let r=$c(e);if(window.cookieStore){let c=(h=>{let f=h.changed.find(_=>_.name===r);f&&t(f.value),h.deleted.find(_=>_.name===r)&&t(null)}),u=()=>window.cookieStore.removeEventListener("change",c);return this.listenerUnsubscribes.set(t,u),window.cookieStore.addEventListener("change",c)}let i=Gc(r),s=setInterval(()=>{let c=Gc(r);c!==i&&(t(c),i=c)},Gw),o=()=>clearInterval(s);this.listenerUnsubscribes.set(t,o)}_removeListener(e,t){let r=this.listenerUnsubscribes.get(t);r&&(r(),this.listenerUnsubscribes.delete(t))}};iu.type="COOKIE";var ro=class extends to{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,t){}_removeListener(e,t){}};ro.type="SESSION";var Tu=ro;function $w(n){return Promise.all(n.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(t){return{fulfilled:!1,reason:t}}}))}var io=class n{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){let t=this.receivers.find(i=>i.isListeningto(e));if(t)return t;let r=new n(e);return this.receivers.push(r),r}isListeningto(e){return this.eventTarget===e}async handleEvent(e){let t=e,{eventId:r,eventType:i,data:s}=t.data,o=this.handlersMap[i];if(!o?.size)return;t.ports[0].postMessage({status:"ack",eventId:r,eventType:i});let c=Array.from(o).map(async h=>h(t.origin,s)),u=await $w(c);t.ports[0].postMessage({status:"done",eventId:r,eventType:i,response:u})}_subscribe(e,t){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(t)}_unsubscribe(e,t){this.handlersMap[e]&&t&&this.handlersMap[e].delete(t),(!t||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}};io.receivers=[];function vu(n="",e=10){let t="";for(let r=0;r<e;r++)t+=Math.floor(Math.random()*10);return n+t}var su=class{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,t,r=50){let i=typeof MessageChannel<"u"?new MessageChannel:null;if(!i)throw new Error("connection_unavailable");let s,o;return new Promise((c,u)=>{let h=vu("",20);i.port1.start();let f=setTimeout(()=>{u(new Error("unsupported_event"))},r);o={messageChannel:i,onMessage(m){let _=m;if(_.data.eventId===h)switch(_.data.status){case"ack":clearTimeout(f),s=setTimeout(()=>{u(new Error("timeout"))},3e3);break;case"done":clearTimeout(s),c(_.data.response);break;default:clearTimeout(f),clearTimeout(s),u(new Error("invalid_response"));break}}},this.handlers.add(o),i.port1.addEventListener("message",o.onMessage),this.target.postMessage({eventType:e,eventId:h,data:t},[i.port2])}).finally(()=>{o&&this.removeMessageHandler(o)})}};function rt(){return window}function Kw(n){rt().location.href=n}function Gp(){return typeof rt().WorkerGlobalScope<"u"&&typeof rt().importScripts=="function"}async function Ww(){if(!navigator?.serviceWorker)return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function Hw(){return navigator?.serviceWorker?.controller||null}function Qw(){return Gp()?self:null}var $p="firebaseLocalStorageDb",Jw=1,so="firebaseLocalStorage",Kp="fbase_key",gn=class{constructor(e){this.request=e}toPromise(){return new Promise((e,t)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{t(this.request.error)})})}};function go(n,e){return n.transaction([so],e?"readwrite":"readonly").objectStore(so)}function Yw(){let n=indexedDB.deleteDatabase($p);return new gn(n).toPromise()}function ou(){let n=indexedDB.open($p,Jw);return new Promise((e,t)=>{n.addEventListener("error",()=>{t(n.error)}),n.addEventListener("upgradeneeded",()=>{let r=n.result;try{r.createObjectStore(so,{keyPath:Kp})}catch(i){t(i)}}),n.addEventListener("success",async()=>{let r=n.result;r.objectStoreNames.contains(so)?e(r):(r.close(),await Yw(),e(await ou()))})})}async function ip(n,e,t){let r=go(n,!0).put({[Kp]:e,value:t});return new gn(r).toPromise()}async function Xw(n,e){let t=go(n,!1).get(e),r=await new gn(t).toPromise();return r===void 0?null:r.value}function sp(n,e){let t=go(n,!0).delete(e);return new gn(t).toPromise()}var Zw=800,eE=3,oo=class{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await ou(),this.db)}async _withRetries(e){let t=0;for(;;)try{let r=await this._openDb();return await e(r)}catch(r){if(t++>eE)throw r;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return Gp()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=io._getInstance(Qw()),this.receiver._subscribe("keyChanged",async(e,t)=>({keyProcessed:(await this._poll()).includes(t.key)})),this.receiver._subscribe("ping",async(e,t)=>["keyChanged"])}async initializeSender(){if(this.activeServiceWorker=await Ww(),!this.activeServiceWorker)return;this.sender=new su(this.activeServiceWorker);let e=await this.sender._send("ping",{},800);e&&e[0]?.fulfilled&&e[0]?.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||Hw()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;let e=await ou();return await ip(e,eo,"1"),await sp(e,eo),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,t){return this._withPendingWrite(async()=>(await this._withRetries(r=>ip(r,e,t)),this.localCache[e]=t,this.notifyServiceWorker(e)))}async _get(e){let t=await this._withRetries(r=>Xw(r,e));return this.localCache[e]=t,t}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(t=>sp(t,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){let e=await this._withRetries(i=>{let s=go(i,!1).getAll();return new gn(s).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];let t=[],r=new Set;if(e.length!==0)for(let{fbase_key:i,value:s}of e)r.add(i),JSON.stringify(this.localCache[i])!==JSON.stringify(s)&&(this.notifyListeners(i,s),t.push(i));for(let i of Object.keys(this.localCache))this.localCache[i]&&!r.has(i)&&(this.notifyListeners(i,null),t.push(i));return t}notifyListeners(e,t){this.localCache[e]=t;let r=this.listeners[e];if(r)for(let i of Array.from(r))i(t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),Zw)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,t){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}};oo.type="LOCAL";var _o=oo;function op(n,e){return ve(n,"POST","/v2/accounts/mfaSignIn:start",pe(n,e))}function tE(n,e){return ve(n,"POST","/v2/accounts/mfaSignIn:finalize",pe(n,e))}function nE(n,e){return ve(n,"POST","/v2/accounts/mfaSignIn:finalize",pe(n,e))}var ZA=Op("rcb"),eb=new hn(3e4,6e4);var Bs="recaptcha";async function rE(n,e,t){if(!n._getRecaptchaConfig())try{await Ew(n)}catch{console.log("Failed to initialize reCAPTCHA Enterprise config. Triggering the reCAPTCHA v2 verification.")}try{let r;if(typeof e=="string"?r={phoneNumber:e}:r=e,"session"in r){let i=r.session;if("phoneNumber"in r){M(i.type==="enroll",n,"internal-error");let s={idToken:i.credential,phoneEnrollmentInfo:{phoneNumber:r.phoneNumber,clientType:"CLIENT_TYPE_WEB"}};return(await Jn(n,s,"mfaSmsEnrollment",async(h,f)=>{if(f.phoneEnrollmentInfo.captchaResponse===li){M(t?.type===Bs,h,"argument-error");let m=await Kc(h,f,t);return rp(h,m)}return rp(h,f)},"PHONE_PROVIDER").catch(h=>Promise.reject(h))).phoneSessionInfo.sessionInfo}else{M(i.type==="signin",n,"internal-error");let s=r.multiFactorHint?.uid||r.multiFactorUid;M(s,n,"missing-multi-factor-info");let o={mfaPendingCredential:i.credential,mfaEnrollmentId:s,phoneSignInInfo:{clientType:"CLIENT_TYPE_WEB"}};return(await Jn(n,o,"mfaSmsSignIn",async(f,m)=>{if(m.phoneSignInInfo.captchaResponse===li){M(t?.type===Bs,f,"argument-error");let _=await Kc(f,m,t);return op(f,_)}return op(f,m)},"PHONE_PROVIDER").catch(f=>Promise.reject(f))).phoneResponseInfo.sessionInfo}}else{let i={phoneNumber:r.phoneNumber,clientType:"CLIENT_TYPE_WEB"};return(await Jn(n,i,"sendVerificationCode",async(u,h)=>{if(h.captchaResponse===li){M(t?.type===Bs,u,"argument-error");let f=await Kc(u,h,t);return tp(u,f)}return tp(u,h)},"PHONE_PROVIDER").catch(u=>Promise.reject(u))).sessionInfo}}finally{t?._reset()}}async function Kc(n,e,t){M(t.type===Bs,n,"argument-error");let r=await t.verify();M(typeof r=="string",n,"argument-error");let i={...e};if("phoneEnrollmentInfo"in i){let s=i.phoneEnrollmentInfo.phoneNumber,o=i.phoneEnrollmentInfo.captchaResponse,c=i.phoneEnrollmentInfo.clientType,u=i.phoneEnrollmentInfo.recaptchaVersion;return Object.assign(i,{phoneEnrollmentInfo:{phoneNumber:s,recaptchaToken:r,captchaResponse:o,clientType:c,recaptchaVersion:u}}),i}else if("phoneSignInInfo"in i){let s=i.phoneSignInInfo.captchaResponse,o=i.phoneSignInInfo.clientType,c=i.phoneSignInInfo.recaptchaVersion;return Object.assign(i,{phoneSignInInfo:{recaptchaToken:r,captchaResponse:s,clientType:o,recaptchaVersion:c}}),i}else return Object.assign(i,{recaptchaToken:r}),i}var Ii=class n{constructor(e){this.providerId=n.PROVIDER_ID,this.auth=ft(e)}verifyPhoneNumber(e,t){return rE(this.auth,e,ce(t))}static credential(e,t){return pi._fromVerification(e,t)}static credentialFromResult(e){let t=e;return n.credentialFromTaggedObject(t)}static credentialFromError(e){return n.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;let{phoneNumber:t,temporaryProof:r}=e;return t&&r?pi._fromTokenResponse(t,r):null}};Ii.PROVIDER_ID="phone";Ii.PHONE_SIGN_IN_METHOD="phone";function iE(n,e){return e?lt(e):(M(n._popupRedirectResolver,n,"argument-error"),n._popupRedirectResolver)}var wi=class extends dn{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return Yn(e,this._buildIdpRequest())}_linkToIdToken(e,t){return Yn(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return Yn(e,this._buildIdpRequest())}_buildIdpRequest(e){let t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}};function sE(n){return Fp(n.auth,new wi(n),n.bypassAuthState)}function oE(n){let{auth:e,user:t}=n;return M(t,e,"internal-error"),Fw(t,new wi(n),n.bypassAuthState)}async function aE(n){let{auth:e,user:t}=n;return M(t,e,"internal-error"),Mw(t,new wi(n),n.bypassAuthState)}var ao=class{constructor(e,t,r,i,s=!1){this.auth=e,this.resolver=r,this.user=i,this.bypassAuthState=s,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise(async(e,t)=>{this.pendingPromise={resolve:e,reject:t};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(r){this.reject(r)}})}async onAuthEvent(e){let{urlResponse:t,sessionId:r,postBody:i,tenantId:s,error:o,type:c}=e;if(o){this.reject(o);return}let u={auth:this.auth,requestUri:t,sessionId:r,tenantId:s||void 0,postBody:i||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(c)(u))}catch(h){this.reject(h)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return sE;case"linkViaPopup":case"linkViaRedirect":return aE;case"reauthViaPopup":case"reauthViaRedirect":return oE;default:Ke(this.auth,"internal-error")}}resolve(e){dt(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){dt(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}};var cE=new hn(2e3,1e4);var au=class n extends ao{constructor(e,t,r,i,s){super(e,t,i,s),this.provider=r,this.authWindow=null,this.pollId=null,n.currentPopupAction&&n.currentPopupAction.cancel(),n.currentPopupAction=this}async executeNotNull(){let e=await this.execute();return M(e,this.auth,"internal-error"),e}async onExecution(){dt(this.filter.length===1,"Popup operations only handle one event");let e=vu();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(t=>{this.reject(t)}),this.resolver._isIframeWebStorageSupported(this.auth,t=>{t||this.reject(nt(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){return this.authWindow?.associatedEvent||null}cancel(){this.reject(nt(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,n.currentPopupAction=null}pollUserCancellation(){let e=()=>{if(this.authWindow?.window?.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(nt(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,cE.get())};e()}};au.currentPopupAction=null;var uE="pendingRedirect",qs=new Map,cu=class extends ao{constructor(e,t,r=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,r),this.eventId=null}async execute(){let e=qs.get(this.auth._key());if(!e){try{let r=await lE(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(r)}catch(t){e=()=>Promise.reject(t)}qs.set(this.auth._key(),e)}return this.bypassAuthState||qs.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){let t=await this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}};async function lE(n,e){let t=fE(e),r=dE(n);if(!await r._isAvailable())return!1;let i=await r._get(t)==="true";return await r._remove(t),i}function hE(n,e){qs.set(n._key(),e)}function dE(n){return lt(n._redirectPersistence)}function fE(n){return Us(uE,n.config.apiKey,n.name)}async function pE(n,e,t=!1){if(De(n.app))return Promise.reject(ht(n));let r=ft(n),i=iE(r,e),o=await new cu(r,i,t).execute();return o&&!t&&(delete o.user._redirectEventId,await r._persistUserIfCurrent(o.user),await r._setRedirectUser(null,e)),o}var mE=600*1e3,uu=class{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach(r=>{this.isEventForConsumer(e,r)&&(t=!0,this.sendToConsumer(e,r),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!gE(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){if(e.error&&!Wp(e)){let r=e.error.code?.split("auth/")[1]||"internal-error";t.onError(nt(this.auth,r))}else t.onAuthEvent(e)}isEventForConsumer(e,t){let r=t.eventId===null||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&r}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=mE&&this.cachedEventUids.clear(),this.cachedEventUids.has(ap(e))}saveEventToCache(e){this.cachedEventUids.add(ap(e)),this.lastProcessedEventTime=Date.now()}};function ap(n){return[n.type,n.eventId,n.sessionId,n.tenantId].filter(e=>e).join("-")}function Wp({type:n,error:e}){return n==="unknown"&&e?.code==="auth/no-auth-event"}function gE(n){switch(n.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return Wp(n);default:return!1}}async function _E(n,e={}){return ve(n,"GET","/v1/projects",e)}var yE=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,IE=/^https?/;async function wE(n){if(n.config.emulator)return;let{authorizedDomains:e}=await _E(n);for(let t of e)try{if(EE(t))return}catch{}Ke(n,"unauthorized-domain")}function EE(n){let e=Hc(),{protocol:t,hostname:r}=new URL(e);if(n.startsWith("chrome-extension://")){let o=new URL(n);return o.hostname===""&&r===""?t==="chrome-extension:"&&n.replace("chrome-extension://","")===e.replace("chrome-extension://",""):t==="chrome-extension:"&&o.hostname===r}if(!IE.test(t))return!1;if(yE.test(n))return r===n;let i=n.replace(/\./g,"\\.");return new RegExp("^(.+\\."+i+"|"+i+")$","i").test(r)}var TE=new hn(3e4,6e4);function cp(){let n=rt().___jsl;if(n?.H){for(let e of Object.keys(n.H))if(n.H[e].r=n.H[e].r||[],n.H[e].L=n.H[e].L||[],n.H[e].r=[...n.H[e].L],n.CP)for(let t=0;t<n.CP.length;t++)n.CP[t]=null}}function vE(n){return new Promise((e,t)=>{function r(){cp(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{cp(),t(nt(n,"network-request-failed"))},timeout:TE.get()})}if(rt().gapi?.iframes?.Iframe)e(gapi.iframes.getContext());else if(rt().gapi?.load)r();else{let i=Op("iframefcb");return rt()[i]=()=>{gapi.load?r():t(nt(n,"network-request-failed"))},Dp(`${Iw()}?onload=${i}`).catch(s=>t(s))}}).catch(e=>{throw js=null,e})}var js=null;function AE(n){return js=js||vE(n),js}var bE=new hn(5e3,15e3),SE="__/auth/iframe",RE="emulator/auth/iframe",PE={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},CE=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function NE(n){let e=n.config;M(e.authDomain,n,"auth-domain-config-required");let t=e.emulator?pu(e,RE):`https://${n.config.authDomain}/${SE}`,r={apiKey:e.apiKey,appName:n.name,v:kt},i=CE.get(n.config.apiHost);i&&(r.eid=i);let s=n._getFrameworks();return s.length&&(r.fw=s.join(",")),`${t}?${Wn(r).slice(1)}`}async function kE(n){let e=await AE(n),t=rt().gapi;return M(t,n,"internal-error"),e.open({where:document.body,url:NE(n),messageHandlersFilter:t.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:PE,dontclear:!0},r=>new Promise(async(i,s)=>{await r.restyle({setHideOnLeave:!1});let o=nt(n,"network-request-failed"),c=rt().setTimeout(()=>{s(o)},bE.get());function u(){rt().clearTimeout(c),i(r)}r.ping(u).then(u,()=>{s(o)})}))}var DE={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},OE=500,VE=600,xE="_blank",LE="http://localhost",co=class{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}};function ME(n,e,t,r=OE,i=VE){let s=Math.max((window.screen.availHeight-i)/2,0).toString(),o=Math.max((window.screen.availWidth-r)/2,0).toString(),c="",u={...DE,width:r.toString(),height:i.toString(),top:s,left:o},h=ue().toLowerCase();t&&(c=bp(h)?xE:t),vp(h)&&(e=e||LE,u.scrollbars="yes");let f=Object.entries(u).reduce((_,[R,k])=>`${_}${R}=${k},`,"");if(fw(h)&&c!=="_self")return FE(e||"",c),new co(null);let m=window.open(e||"",c,f);M(m,n,"popup-blocked");try{m.focus()}catch{}return new co(m)}function FE(n,e){let t=document.createElement("a");t.href=n,t.target=e;let r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),t.dispatchEvent(r)}var UE="__/auth/handler",BE="emulator/auth/handler",qE=encodeURIComponent("fac");async function up(n,e,t,r,i,s){M(n.config.authDomain,n,"auth-domain-config-required"),M(n.config.apiKey,n,"invalid-api-key");let o={apiKey:n.config.apiKey,appName:n.name,authType:t,redirectUrl:r,v:kt,eventId:i};if(e instanceof Zs){e.setDefaultLanguage(n.languageCode),o.providerId=e.providerId||"",Of(e.getCustomParameters())||(o.customParameters=JSON.stringify(e.getCustomParameters()));for(let[f,m]of Object.entries(s||{}))o[f]=m}if(e instanceof mn){let f=e.getScopes().filter(m=>m!=="");f.length>0&&(o.scopes=f.join(","))}n.tenantId&&(o.tid=n.tenantId);let c=o;for(let f of Object.keys(c))c[f]===void 0&&delete c[f];let u=await n._getAppCheckToken(),h=u?`#${qE}=${encodeURIComponent(u)}`:"";return`${jE(n)}?${Wn(c).slice(1)}${h}`}function jE({config:n}){return n.emulator?pu(n,BE):`https://${n.authDomain}/${UE}`}var Wc="webStorageSupport",lu=class{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=Tu,this._completeRedirectFn=pE,this._overrideRedirectResult=hE}async _openPopup(e,t,r,i){dt(this.eventManagers[e._key()]?.manager,"_initialize() not called before _openPopup()");let s=await up(e,t,r,Hc(),i);return ME(e,s,vu())}async _openRedirect(e,t,r,i){await this._originValidation(e);let s=await up(e,t,r,Hc(),i);return Kw(s),new Promise(()=>{})}_initialize(e){let t=e._key();if(this.eventManagers[t]){let{manager:i,promise:s}=this.eventManagers[t];return i?Promise.resolve(i):(dt(s,"If manager is not set, promise should be"),s)}let r=this.initAndGetManager(e);return this.eventManagers[t]={promise:r},r.catch(()=>{delete this.eventManagers[t]}),r}async initAndGetManager(e){let t=await kE(e),r=new uu(e);return t.register("authEvent",i=>(M(i?.authEvent,e,"invalid-auth-event"),{status:r.onEvent(i.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:r},this.iframes[e._key()]=t,r}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send(Wc,{type:Wc},i=>{let s=i?.[0]?.[Wc];s!==void 0&&t(!!s),Ke(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){let t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=wE(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return Np()||Ap()||gu()}},Hp=lu,uo=class{constructor(e){this.factorId=e}_process(e,t,r){switch(t.type){case"enroll":return this._finalizeEnroll(e,t.credential,r);case"signin":return this._finalizeSignIn(e,t.credential);default:return tt("unexpected MultiFactorSessionType")}}},hu=class n extends uo{constructor(e){super("phone"),this.credential=e}static _fromCredential(e){return new n(e)}_finalizeEnroll(e,t,r){return Uw(e,{idToken:t,displayName:r,phoneVerificationInfo:this.credential._makeVerificationRequest()})}_finalizeSignIn(e,t){return tE(e,{mfaPendingCredential:t,phoneVerificationInfo:this.credential._makeVerificationRequest()})}},lo=class{constructor(){}static assertion(e){return hu._fromCredential(e)}};lo.FACTOR_ID="phone";var ho=class{static assertionForEnrollment(e,t){return fo._fromSecret(e,t)}static assertionForSignIn(e,t){return fo._fromEnrollmentId(e,t)}static async generateSecret(e){let t=e;M(typeof t.user?.auth<"u","internal-error");let r=await Bw(t.user.auth,{idToken:t.credential,totpEnrollmentInfo:{}});return po._fromStartTotpMfaEnrollmentResponse(r,t.user.auth)}};ho.FACTOR_ID="totp";var fo=class n extends uo{constructor(e,t,r){super("totp"),this.otp=e,this.enrollmentId=t,this.secret=r}static _fromSecret(e,t){return new n(t,void 0,e)}static _fromEnrollmentId(e,t){return new n(t,e)}async _finalizeEnroll(e,t,r){return M(typeof this.secret<"u",e,"argument-error"),qw(e,{idToken:t,displayName:r,totpVerificationInfo:this.secret._makeTotpVerificationInfo(this.otp)})}async _finalizeSignIn(e,t){M(this.enrollmentId!==void 0&&this.otp!==void 0,e,"argument-error");let r={verificationCode:this.otp};return nE(e,{mfaPendingCredential:t,mfaEnrollmentId:this.enrollmentId,totpVerificationInfo:r})}},po=class n{constructor(e,t,r,i,s,o,c){this.sessionInfo=o,this.auth=c,this.secretKey=e,this.hashingAlgorithm=t,this.codeLength=r,this.codeIntervalSeconds=i,this.enrollmentCompletionDeadline=s}static _fromStartTotpMfaEnrollmentResponse(e,t){return new n(e.totpSessionInfo.sharedSecretKey,e.totpSessionInfo.hashingAlgorithm,e.totpSessionInfo.verificationCodeLength,e.totpSessionInfo.periodSec,new Date(e.totpSessionInfo.finalizeEnrollmentTime).toUTCString(),e.totpSessionInfo.sessionInfo,t)}_makeTotpVerificationInfo(e){return{sessionInfo:this.sessionInfo,verificationCode:e}}generateQrCodeUrl(e,t){let r=!1;return(Ms(e)||Ms(t))&&(r=!0),r&&(Ms(e)&&(e=this.auth.currentUser?.email||"unknownuser"),Ms(t)&&(t=this.auth.name)),`otpauth://totp/${t}:${e}?secret=${this.secretKey}&issuer=${t}&algorithm=${this.hashingAlgorithm}&digits=${this.codeLength}`}};function Ms(n){return typeof n>"u"||n?.length===0}var lp="@firebase/auth",hp="1.11.1";var du=class{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){return this.assertAuthConfigured(),this.auth.currentUser?.uid||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;let t=this.auth.onIdTokenChanged(r=>{e(r?.stsTokenManager.accessToken||null)});this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();let t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){M(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}};function zE(n){switch(n){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function GE(n){Nt(new qe("auth",(e,{options:t})=>{let r=e.getProvider("app").getImmediate(),i=e.getProvider("heartbeat"),s=e.getProvider("app-check-internal"),{apiKey:o,authDomain:c}=r.options;M(o&&!o.includes(":"),"invalid-api-key",{appName:r.name});let u={apiKey:o,authDomain:c,clientPlatform:n,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:kp(n)},h=new eu(r,i,s,u);return Tw(h,t),h},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,t,r)=>{e.getProvider("auth-internal").initialize()})),Nt(new qe("auth-internal",e=>{let t=ft(e.getProvider("auth").getImmediate());return(r=>new du(r))(t)},"PRIVATE").setInstantiationMode("EXPLICIT")),$e(lp,hp,zE(n)),$e(lp,hp,"esm2020")}var $E=300,KE=bc("authIdTokenMaxAge")||$E,dp=null,WE=n=>async e=>{let t=e&&await e.getIdTokenResult(),r=t&&(new Date().getTime()-Date.parse(t.issuedAtTime))/1e3;if(r&&r>KE)return;let i=t?.token;dp!==i&&(dp=i,await fetch(n,{method:i?"POST":"DELETE",headers:i?{Authorization:`Bearer ${i}`}:{}}))};function Au(n=Ls()){let e=si(n,"auth");if(e.isInitialized())return e.getImmediate();let t=Vp(n,{popupRedirectResolver:Hp,persistence:[_o,zp,Tu]}),r=bc("authTokenSyncURL");if(r&&typeof isSecureContext=="boolean"&&isSecureContext){let s=new URL(r,location.origin);if(location.origin===s.origin){let o=WE(s.toString());jp(t,o,()=>o(t.currentUser)),qp(t,c=>o(c))}}let i=vc("auth");return i&&xp(t,`http://${i}`),t}function HE(){return document.getElementsByTagName("head")?.[0]??document}_w({loadJS(n){return new Promise((e,t)=>{let r=document.createElement("script");r.setAttribute("src",n),r.onload=e,r.onerror=i=>{let s=nt("internal-error");s.customData=i,t(s)},r.type="text/javascript",r.charset="UTF-8",HE().appendChild(r)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});GE("Browser");var Qp=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},Jp={};var pt,bu;(function(){var n;function e(w,g){function I(){}I.prototype=g.prototype,w.F=g.prototype,w.prototype=new I,w.prototype.constructor=w,w.D=function(T,E,A){for(var y=Array(arguments.length-2),ke=2;ke<arguments.length;ke++)y[ke-2]=arguments[ke];return g.prototype[E].apply(T,y)}}function t(){this.blockSize=-1}function r(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.C=Array(this.blockSize),this.o=this.h=0,this.u()}e(r,t),r.prototype.u=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function i(w,g,I){I||(I=0);let T=Array(16);if(typeof g=="string")for(var E=0;E<16;++E)T[E]=g.charCodeAt(I++)|g.charCodeAt(I++)<<8|g.charCodeAt(I++)<<16|g.charCodeAt(I++)<<24;else for(E=0;E<16;++E)T[E]=g[I++]|g[I++]<<8|g[I++]<<16|g[I++]<<24;g=w.g[0],I=w.g[1],E=w.g[2];let A=w.g[3],y;y=g+(A^I&(E^A))+T[0]+3614090360&4294967295,g=I+(y<<7&4294967295|y>>>25),y=A+(E^g&(I^E))+T[1]+3905402710&4294967295,A=g+(y<<12&4294967295|y>>>20),y=E+(I^A&(g^I))+T[2]+606105819&4294967295,E=A+(y<<17&4294967295|y>>>15),y=I+(g^E&(A^g))+T[3]+3250441966&4294967295,I=E+(y<<22&4294967295|y>>>10),y=g+(A^I&(E^A))+T[4]+4118548399&4294967295,g=I+(y<<7&4294967295|y>>>25),y=A+(E^g&(I^E))+T[5]+1200080426&4294967295,A=g+(y<<12&4294967295|y>>>20),y=E+(I^A&(g^I))+T[6]+2821735955&4294967295,E=A+(y<<17&4294967295|y>>>15),y=I+(g^E&(A^g))+T[7]+4249261313&4294967295,I=E+(y<<22&4294967295|y>>>10),y=g+(A^I&(E^A))+T[8]+1770035416&4294967295,g=I+(y<<7&4294967295|y>>>25),y=A+(E^g&(I^E))+T[9]+2336552879&4294967295,A=g+(y<<12&4294967295|y>>>20),y=E+(I^A&(g^I))+T[10]+4294925233&4294967295,E=A+(y<<17&4294967295|y>>>15),y=I+(g^E&(A^g))+T[11]+2304563134&4294967295,I=E+(y<<22&4294967295|y>>>10),y=g+(A^I&(E^A))+T[12]+1804603682&4294967295,g=I+(y<<7&4294967295|y>>>25),y=A+(E^g&(I^E))+T[13]+4254626195&4294967295,A=g+(y<<12&4294967295|y>>>20),y=E+(I^A&(g^I))+T[14]+2792965006&4294967295,E=A+(y<<17&4294967295|y>>>15),y=I+(g^E&(A^g))+T[15]+1236535329&4294967295,I=E+(y<<22&4294967295|y>>>10),y=g+(E^A&(I^E))+T[1]+4129170786&4294967295,g=I+(y<<5&4294967295|y>>>27),y=A+(I^E&(g^I))+T[6]+3225465664&4294967295,A=g+(y<<9&4294967295|y>>>23),y=E+(g^I&(A^g))+T[11]+643717713&4294967295,E=A+(y<<14&4294967295|y>>>18),y=I+(A^g&(E^A))+T[0]+3921069994&4294967295,I=E+(y<<20&4294967295|y>>>12),y=g+(E^A&(I^E))+T[5]+3593408605&4294967295,g=I+(y<<5&4294967295|y>>>27),y=A+(I^E&(g^I))+T[10]+38016083&4294967295,A=g+(y<<9&4294967295|y>>>23),y=E+(g^I&(A^g))+T[15]+3634488961&4294967295,E=A+(y<<14&4294967295|y>>>18),y=I+(A^g&(E^A))+T[4]+3889429448&4294967295,I=E+(y<<20&4294967295|y>>>12),y=g+(E^A&(I^E))+T[9]+568446438&4294967295,g=I+(y<<5&4294967295|y>>>27),y=A+(I^E&(g^I))+T[14]+3275163606&4294967295,A=g+(y<<9&4294967295|y>>>23),y=E+(g^I&(A^g))+T[3]+4107603335&4294967295,E=A+(y<<14&4294967295|y>>>18),y=I+(A^g&(E^A))+T[8]+1163531501&4294967295,I=E+(y<<20&4294967295|y>>>12),y=g+(E^A&(I^E))+T[13]+2850285829&4294967295,g=I+(y<<5&4294967295|y>>>27),y=A+(I^E&(g^I))+T[2]+4243563512&4294967295,A=g+(y<<9&4294967295|y>>>23),y=E+(g^I&(A^g))+T[7]+1735328473&4294967295,E=A+(y<<14&4294967295|y>>>18),y=I+(A^g&(E^A))+T[12]+2368359562&4294967295,I=E+(y<<20&4294967295|y>>>12),y=g+(I^E^A)+T[5]+4294588738&4294967295,g=I+(y<<4&4294967295|y>>>28),y=A+(g^I^E)+T[8]+2272392833&4294967295,A=g+(y<<11&4294967295|y>>>21),y=E+(A^g^I)+T[11]+1839030562&4294967295,E=A+(y<<16&4294967295|y>>>16),y=I+(E^A^g)+T[14]+4259657740&4294967295,I=E+(y<<23&4294967295|y>>>9),y=g+(I^E^A)+T[1]+2763975236&4294967295,g=I+(y<<4&4294967295|y>>>28),y=A+(g^I^E)+T[4]+1272893353&4294967295,A=g+(y<<11&4294967295|y>>>21),y=E+(A^g^I)+T[7]+4139469664&4294967295,E=A+(y<<16&4294967295|y>>>16),y=I+(E^A^g)+T[10]+3200236656&4294967295,I=E+(y<<23&4294967295|y>>>9),y=g+(I^E^A)+T[13]+681279174&4294967295,g=I+(y<<4&4294967295|y>>>28),y=A+(g^I^E)+T[0]+3936430074&4294967295,A=g+(y<<11&4294967295|y>>>21),y=E+(A^g^I)+T[3]+3572445317&4294967295,E=A+(y<<16&4294967295|y>>>16),y=I+(E^A^g)+T[6]+76029189&4294967295,I=E+(y<<23&4294967295|y>>>9),y=g+(I^E^A)+T[9]+3654602809&4294967295,g=I+(y<<4&4294967295|y>>>28),y=A+(g^I^E)+T[12]+3873151461&4294967295,A=g+(y<<11&4294967295|y>>>21),y=E+(A^g^I)+T[15]+530742520&4294967295,E=A+(y<<16&4294967295|y>>>16),y=I+(E^A^g)+T[2]+3299628645&4294967295,I=E+(y<<23&4294967295|y>>>9),y=g+(E^(I|~A))+T[0]+4096336452&4294967295,g=I+(y<<6&4294967295|y>>>26),y=A+(I^(g|~E))+T[7]+1126891415&4294967295,A=g+(y<<10&4294967295|y>>>22),y=E+(g^(A|~I))+T[14]+2878612391&4294967295,E=A+(y<<15&4294967295|y>>>17),y=I+(A^(E|~g))+T[5]+4237533241&4294967295,I=E+(y<<21&4294967295|y>>>11),y=g+(E^(I|~A))+T[12]+1700485571&4294967295,g=I+(y<<6&4294967295|y>>>26),y=A+(I^(g|~E))+T[3]+2399980690&4294967295,A=g+(y<<10&4294967295|y>>>22),y=E+(g^(A|~I))+T[10]+4293915773&4294967295,E=A+(y<<15&4294967295|y>>>17),y=I+(A^(E|~g))+T[1]+2240044497&4294967295,I=E+(y<<21&4294967295|y>>>11),y=g+(E^(I|~A))+T[8]+1873313359&4294967295,g=I+(y<<6&4294967295|y>>>26),y=A+(I^(g|~E))+T[15]+4264355552&4294967295,A=g+(y<<10&4294967295|y>>>22),y=E+(g^(A|~I))+T[6]+2734768916&4294967295,E=A+(y<<15&4294967295|y>>>17),y=I+(A^(E|~g))+T[13]+1309151649&4294967295,I=E+(y<<21&4294967295|y>>>11),y=g+(E^(I|~A))+T[4]+4149444226&4294967295,g=I+(y<<6&4294967295|y>>>26),y=A+(I^(g|~E))+T[11]+3174756917&4294967295,A=g+(y<<10&4294967295|y>>>22),y=E+(g^(A|~I))+T[2]+718787259&4294967295,E=A+(y<<15&4294967295|y>>>17),y=I+(A^(E|~g))+T[9]+3951481745&4294967295,w.g[0]=w.g[0]+g&4294967295,w.g[1]=w.g[1]+(E+(y<<21&4294967295|y>>>11))&4294967295,w.g[2]=w.g[2]+E&4294967295,w.g[3]=w.g[3]+A&4294967295}r.prototype.v=function(w,g){g===void 0&&(g=w.length);let I=g-this.blockSize,T=this.C,E=this.h,A=0;for(;A<g;){if(E==0)for(;A<=I;)i(this,w,A),A+=this.blockSize;if(typeof w=="string"){for(;A<g;)if(T[E++]=w.charCodeAt(A++),E==this.blockSize){i(this,T),E=0;break}}else for(;A<g;)if(T[E++]=w[A++],E==this.blockSize){i(this,T),E=0;break}}this.h=E,this.o+=g},r.prototype.A=function(){var w=Array((this.h<56?this.blockSize:this.blockSize*2)-this.h);w[0]=128;for(var g=1;g<w.length-8;++g)w[g]=0;g=this.o*8;for(var I=w.length-8;I<w.length;++I)w[I]=g&255,g/=256;for(this.v(w),w=Array(16),g=0,I=0;I<4;++I)for(let T=0;T<32;T+=8)w[g++]=this.g[I]>>>T&255;return w};function s(w,g){var I=c;return Object.prototype.hasOwnProperty.call(I,w)?I[w]:I[w]=g(w)}function o(w,g){this.h=g;let I=[],T=!0;for(let E=w.length-1;E>=0;E--){let A=w[E]|0;T&&A==g||(I[E]=A,T=!1)}this.g=I}var c={};function u(w){return-128<=w&&w<128?s(w,function(g){return new o([g|0],g<0?-1:0)}):new o([w|0],w<0?-1:0)}function h(w){if(isNaN(w)||!isFinite(w))return m;if(w<0)return N(h(-w));let g=[],I=1;for(let T=0;w>=I;T++)g[T]=w/I|0,I*=4294967296;return new o(g,0)}function f(w,g){if(w.length==0)throw Error("number format error: empty string");if(g=g||10,g<2||36<g)throw Error("radix out of range: "+g);if(w.charAt(0)=="-")return N(f(w.substring(1),g));if(w.indexOf("-")>=0)throw Error('number format error: interior "-" character');let I=h(Math.pow(g,8)),T=m;for(let A=0;A<w.length;A+=8){var E=Math.min(8,w.length-A);let y=parseInt(w.substring(A,A+E),g);E<8?(E=h(Math.pow(g,E)),T=T.j(E).add(h(y))):(T=T.j(I),T=T.add(h(y)))}return T}var m=u(0),_=u(1),R=u(16777216);n=o.prototype,n.m=function(){if(O(this))return-N(this).m();let w=0,g=1;for(let I=0;I<this.g.length;I++){let T=this.i(I);w+=(T>=0?T:4294967296+T)*g,g*=4294967296}return w},n.toString=function(w){if(w=w||10,w<2||36<w)throw Error("radix out of range: "+w);if(k(this))return"0";if(O(this))return"-"+N(this).toString(w);let g=h(Math.pow(w,6));var I=this;let T="";for(;;){let E=ee(I,g).g;I=j(I,E.j(g));let A=((I.g.length>0?I.g[0]:I.h)>>>0).toString(w);if(I=E,k(I))return A+T;for(;A.length<6;)A="0"+A;T=A+T}},n.i=function(w){return w<0?0:w<this.g.length?this.g[w]:this.h};function k(w){if(w.h!=0)return!1;for(let g=0;g<w.g.length;g++)if(w.g[g]!=0)return!1;return!0}function O(w){return w.h==-1}n.l=function(w){return w=j(this,w),O(w)?-1:k(w)?0:1};function N(w){let g=w.g.length,I=[];for(let T=0;T<g;T++)I[T]=~w.g[T];return new o(I,~w.h).add(_)}n.abs=function(){return O(this)?N(this):this},n.add=function(w){let g=Math.max(this.g.length,w.g.length),I=[],T=0;for(let E=0;E<=g;E++){let A=T+(this.i(E)&65535)+(w.i(E)&65535),y=(A>>>16)+(this.i(E)>>>16)+(w.i(E)>>>16);T=y>>>16,A&=65535,y&=65535,I[E]=y<<16|A}return new o(I,I[I.length-1]&-2147483648?-1:0)};function j(w,g){return w.add(N(g))}n.j=function(w){if(k(this)||k(w))return m;if(O(this))return O(w)?N(this).j(N(w)):N(N(this).j(w));if(O(w))return N(this.j(N(w)));if(this.l(R)<0&&w.l(R)<0)return h(this.m()*w.m());let g=this.g.length+w.g.length,I=[];for(var T=0;T<2*g;T++)I[T]=0;for(T=0;T<this.g.length;T++)for(let E=0;E<w.g.length;E++){let A=this.i(T)>>>16,y=this.i(T)&65535,ke=w.i(E)>>>16,wt=w.i(E)&65535;I[2*T+2*E]+=y*wt,q(I,2*T+2*E),I[2*T+2*E+1]+=A*wt,q(I,2*T+2*E+1),I[2*T+2*E+1]+=y*ke,q(I,2*T+2*E+1),I[2*T+2*E+2]+=A*ke,q(I,2*T+2*E+2)}for(w=0;w<g;w++)I[w]=I[2*w+1]<<16|I[2*w];for(w=g;w<2*g;w++)I[w]=0;return new o(I,0)};function q(w,g){for(;(w[g]&65535)!=w[g];)w[g+1]+=w[g]>>>16,w[g]&=65535,g++}function U(w,g){this.g=w,this.h=g}function ee(w,g){if(k(g))throw Error("division by zero");if(k(w))return new U(m,m);if(O(w))return g=ee(N(w),g),new U(N(g.g),N(g.h));if(O(g))return g=ee(w,N(g)),new U(N(g.g),g.h);if(w.g.length>30){if(O(w)||O(g))throw Error("slowDivide_ only works with positive integers.");for(var I=_,T=g;T.l(w)<=0;)I=Y(I),T=Y(T);var E=Q(I,1),A=Q(T,1);for(T=Q(T,2),I=Q(I,2);!k(T);){var y=A.add(T);y.l(w)<=0&&(E=E.add(I),A=y),T=Q(T,1),I=Q(I,1)}return g=j(w,E.j(g)),new U(E,g)}for(E=m;w.l(g)>=0;){for(I=Math.max(1,Math.floor(w.m()/g.m())),T=Math.ceil(Math.log(I)/Math.LN2),T=T<=48?1:Math.pow(2,T-48),A=h(I),y=A.j(g);O(y)||y.l(w)>0;)I-=T,A=h(I),y=A.j(g);k(A)&&(A=_),E=E.add(A),w=j(w,y)}return new U(E,w)}n.B=function(w){return ee(this,w).h},n.and=function(w){let g=Math.max(this.g.length,w.g.length),I=[];for(let T=0;T<g;T++)I[T]=this.i(T)&w.i(T);return new o(I,this.h&w.h)},n.or=function(w){let g=Math.max(this.g.length,w.g.length),I=[];for(let T=0;T<g;T++)I[T]=this.i(T)|w.i(T);return new o(I,this.h|w.h)},n.xor=function(w){let g=Math.max(this.g.length,w.g.length),I=[];for(let T=0;T<g;T++)I[T]=this.i(T)^w.i(T);return new o(I,this.h^w.h)};function Y(w){let g=w.g.length+1,I=[];for(let T=0;T<g;T++)I[T]=w.i(T)<<1|w.i(T-1)>>>31;return new o(I,w.h)}function Q(w,g){let I=g>>5;g%=32;let T=w.g.length-I,E=[];for(let A=0;A<T;A++)E[A]=g>0?w.i(A+I)>>>g|w.i(A+I+1)<<32-g:w.i(A+I);return new o(E,w.h)}r.prototype.digest=r.prototype.A,r.prototype.reset=r.prototype.u,r.prototype.update=r.prototype.v,bu=Jp.Md5=r,o.prototype.add=o.prototype.add,o.prototype.multiply=o.prototype.j,o.prototype.modulo=o.prototype.B,o.prototype.compare=o.prototype.l,o.prototype.toNumber=o.prototype.m,o.prototype.toString=o.prototype.toString,o.prototype.getBits=o.prototype.i,o.fromNumber=h,o.fromString=f,pt=Jp.Integer=o}).apply(typeof Qp<"u"?Qp:typeof self<"u"?self:typeof window<"u"?window:{});var yo=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},mt={};var Su,QE,Zn,Ru,Ei,Io,Pu,Cu,Nu;(function(){var n,e=Object.defineProperty;function t(a){a=[typeof globalThis=="object"&&globalThis,a,typeof window=="object"&&window,typeof self=="object"&&self,typeof yo=="object"&&yo];for(var l=0;l<a.length;++l){var d=a[l];if(d&&d.Math==Math)return d}throw Error("Cannot find global object")}var r=t(this);function i(a,l){if(l)e:{var d=r;a=a.split(".");for(var p=0;p<a.length-1;p++){var v=a[p];if(!(v in d))break e;d=d[v]}a=a[a.length-1],p=d[a],l=l(p),l!=p&&l!=null&&e(d,a,{configurable:!0,writable:!0,value:l})}}i("Symbol.dispose",function(a){return a||Symbol("Symbol.dispose")}),i("Array.prototype.values",function(a){return a||function(){return this[Symbol.iterator]()}}),i("Object.entries",function(a){return a||function(l){var d=[],p;for(p in l)Object.prototype.hasOwnProperty.call(l,p)&&d.push([p,l[p]]);return d}});var s=s||{},o=this||self;function c(a){var l=typeof a;return l=="object"&&a!=null||l=="function"}function u(a,l,d){return a.call.apply(a.bind,arguments)}function h(a,l,d){return h=u,h.apply(null,arguments)}function f(a,l){var d=Array.prototype.slice.call(arguments,1);return function(){var p=d.slice();return p.push.apply(p,arguments),a.apply(this,p)}}function m(a,l){function d(){}d.prototype=l.prototype,a.Z=l.prototype,a.prototype=new d,a.prototype.constructor=a,a.Ob=function(p,v,S){for(var V=Array(arguments.length-2),$=2;$<arguments.length;$++)V[$-2]=arguments[$];return l.prototype[v].apply(p,V)}}var _=typeof AsyncContext<"u"&&typeof AsyncContext.Snapshot=="function"?a=>a&&AsyncContext.Snapshot.wrap(a):a=>a;function R(a){let l=a.length;if(l>0){let d=Array(l);for(let p=0;p<l;p++)d[p]=a[p];return d}return[]}function k(a,l){for(let p=1;p<arguments.length;p++){let v=arguments[p];var d=typeof v;if(d=d!="object"?d:v?Array.isArray(v)?"array":d:"null",d=="array"||d=="object"&&typeof v.length=="number"){d=a.length||0;let S=v.length||0;a.length=d+S;for(let V=0;V<S;V++)a[d+V]=v[V]}else a.push(v)}}class O{constructor(l,d){this.i=l,this.j=d,this.h=0,this.g=null}get(){let l;return this.h>0?(this.h--,l=this.g,this.g=l.next,l.next=null):l=this.i(),l}}function N(a){o.setTimeout(()=>{throw a},0)}function j(){var a=w;let l=null;return a.g&&(l=a.g,a.g=a.g.next,a.g||(a.h=null),l.next=null),l}class q{constructor(){this.h=this.g=null}add(l,d){let p=U.get();p.set(l,d),this.h?this.h.next=p:this.g=p,this.h=p}}var U=new O(()=>new ee,a=>a.reset());class ee{constructor(){this.next=this.g=this.h=null}set(l,d){this.h=l,this.g=d,this.next=null}reset(){this.next=this.g=this.h=null}}let Y,Q=!1,w=new q,g=()=>{let a=Promise.resolve(void 0);Y=()=>{a.then(I)}};function I(){for(var a;a=j();){try{a.h.call(a.g)}catch(d){N(d)}var l=U;l.j(a),l.h<100&&(l.h++,a.next=l.g,l.g=a)}Q=!1}function T(){this.u=this.u,this.C=this.C}T.prototype.u=!1,T.prototype.dispose=function(){this.u||(this.u=!0,this.N())},T.prototype[Symbol.dispose]=function(){this.dispose()},T.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function E(a,l){this.type=a,this.g=this.target=l,this.defaultPrevented=!1}E.prototype.h=function(){this.defaultPrevented=!0};var A=(function(){if(!o.addEventListener||!Object.defineProperty)return!1;var a=!1,l=Object.defineProperty({},"passive",{get:function(){a=!0}});try{let d=()=>{};o.addEventListener("test",d,l),o.removeEventListener("test",d,l)}catch{}return a})();function y(a){return/^[\s\xa0]*$/.test(a)}function ke(a,l){E.call(this,a?a.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,a&&this.init(a,l)}m(ke,E),ke.prototype.init=function(a,l){let d=this.type=a.type,p=a.changedTouches&&a.changedTouches.length?a.changedTouches[0]:null;this.target=a.target||a.srcElement,this.g=l,l=a.relatedTarget,l||(d=="mouseover"?l=a.fromElement:d=="mouseout"&&(l=a.toElement)),this.relatedTarget=l,p?(this.clientX=p.clientX!==void 0?p.clientX:p.pageX,this.clientY=p.clientY!==void 0?p.clientY:p.pageY,this.screenX=p.screenX||0,this.screenY=p.screenY||0):(this.clientX=a.clientX!==void 0?a.clientX:a.pageX,this.clientY=a.clientY!==void 0?a.clientY:a.pageY,this.screenX=a.screenX||0,this.screenY=a.screenY||0),this.button=a.button,this.key=a.key||"",this.ctrlKey=a.ctrlKey,this.altKey=a.altKey,this.shiftKey=a.shiftKey,this.metaKey=a.metaKey,this.pointerId=a.pointerId||0,this.pointerType=a.pointerType,this.state=a.state,this.i=a,a.defaultPrevented&&ke.Z.h.call(this)},ke.prototype.h=function(){ke.Z.h.call(this);let a=this.i;a.preventDefault?a.preventDefault():a.returnValue=!1};var wt="closure_listenable_"+(Math.random()*1e6|0),ry=0;function iy(a,l,d,p,v){this.listener=a,this.proxy=null,this.src=l,this.type=d,this.capture=!!p,this.ha=v,this.key=++ry,this.da=this.fa=!1}function hs(a){a.da=!0,a.listener=null,a.proxy=null,a.src=null,a.ha=null}function ds(a,l,d){for(let p in a)l.call(d,a[p],p,a)}function sy(a,l){for(let d in a)l.call(void 0,a[d],d,a)}function gd(a){let l={};for(let d in a)l[d]=a[d];return l}let _d="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function yd(a,l){let d,p;for(let v=1;v<arguments.length;v++){p=arguments[v];for(d in p)a[d]=p[d];for(let S=0;S<_d.length;S++)d=_d[S],Object.prototype.hasOwnProperty.call(p,d)&&(a[d]=p[d])}}function fs(a){this.src=a,this.g={},this.h=0}fs.prototype.add=function(a,l,d,p,v){let S=a.toString();a=this.g[S],a||(a=this.g[S]=[],this.h++);let V=Qa(a,l,p,v);return V>-1?(l=a[V],d||(l.fa=!1)):(l=new iy(l,this.src,S,!!p,v),l.fa=d,a.push(l)),l};function Ha(a,l){let d=l.type;if(d in a.g){var p=a.g[d],v=Array.prototype.indexOf.call(p,l,void 0),S;(S=v>=0)&&Array.prototype.splice.call(p,v,1),S&&(hs(l),a.g[d].length==0&&(delete a.g[d],a.h--))}}function Qa(a,l,d,p){for(let v=0;v<a.length;++v){let S=a[v];if(!S.da&&S.listener==l&&S.capture==!!d&&S.ha==p)return v}return-1}var Ja="closure_lm_"+(Math.random()*1e6|0),Ya={};function Id(a,l,d,p,v){if(p&&p.once)return Ed(a,l,d,p,v);if(Array.isArray(l)){for(let S=0;S<l.length;S++)Id(a,l[S],d,p,v);return null}return d=tc(d),a&&a[wt]?a.J(l,d,c(p)?!!p.capture:!!p,v):wd(a,l,d,!1,p,v)}function wd(a,l,d,p,v,S){if(!l)throw Error("Invalid event type");let V=c(v)?!!v.capture:!!v,$=Za(a);if($||(a[Ja]=$=new fs(a)),d=$.add(l,d,p,V,S),d.proxy)return d;if(p=oy(),d.proxy=p,p.src=a,p.listener=d,a.addEventListener)A||(v=V),v===void 0&&(v=!1),a.addEventListener(l.toString(),p,v);else if(a.attachEvent)a.attachEvent(vd(l.toString()),p);else if(a.addListener&&a.removeListener)a.addListener(p);else throw Error("addEventListener and attachEvent are unavailable.");return d}function oy(){function a(d){return l.call(a.src,a.listener,d)}let l=ay;return a}function Ed(a,l,d,p,v){if(Array.isArray(l)){for(let S=0;S<l.length;S++)Ed(a,l[S],d,p,v);return null}return d=tc(d),a&&a[wt]?a.K(l,d,c(p)?!!p.capture:!!p,v):wd(a,l,d,!0,p,v)}function Td(a,l,d,p,v){if(Array.isArray(l))for(var S=0;S<l.length;S++)Td(a,l[S],d,p,v);else p=c(p)?!!p.capture:!!p,d=tc(d),a&&a[wt]?(a=a.i,S=String(l).toString(),S in a.g&&(l=a.g[S],d=Qa(l,d,p,v),d>-1&&(hs(l[d]),Array.prototype.splice.call(l,d,1),l.length==0&&(delete a.g[S],a.h--)))):a&&(a=Za(a))&&(l=a.g[l.toString()],a=-1,l&&(a=Qa(l,d,p,v)),(d=a>-1?l[a]:null)&&Xa(d))}function Xa(a){if(typeof a!="number"&&a&&!a.da){var l=a.src;if(l&&l[wt])Ha(l.i,a);else{var d=a.type,p=a.proxy;l.removeEventListener?l.removeEventListener(d,p,a.capture):l.detachEvent?l.detachEvent(vd(d),p):l.addListener&&l.removeListener&&l.removeListener(p),(d=Za(l))?(Ha(d,a),d.h==0&&(d.src=null,l[Ja]=null)):hs(a)}}}function vd(a){return a in Ya?Ya[a]:Ya[a]="on"+a}function ay(a,l){if(a.da)a=!0;else{l=new ke(l,this);let d=a.listener,p=a.ha||a.src;a.fa&&Xa(a),a=d.call(p,l)}return a}function Za(a){return a=a[Ja],a instanceof fs?a:null}var ec="__closure_events_fn_"+(Math.random()*1e9>>>0);function tc(a){return typeof a=="function"?a:(a[ec]||(a[ec]=function(l){return a.handleEvent(l)}),a[ec])}function Te(){T.call(this),this.i=new fs(this),this.M=this,this.G=null}m(Te,T),Te.prototype[wt]=!0,Te.prototype.removeEventListener=function(a,l,d,p){Td(this,a,l,d,p)};function Se(a,l){var d,p=a.G;if(p)for(d=[];p;p=p.G)d.push(p);if(a=a.M,p=l.type||l,typeof l=="string")l=new E(l,a);else if(l instanceof E)l.target=l.target||a;else{var v=l;l=new E(p,a),yd(l,v)}v=!0;let S,V;if(d)for(V=d.length-1;V>=0;V--)S=l.g=d[V],v=ps(S,p,!0,l)&&v;if(S=l.g=a,v=ps(S,p,!0,l)&&v,v=ps(S,p,!1,l)&&v,d)for(V=0;V<d.length;V++)S=l.g=d[V],v=ps(S,p,!1,l)&&v}Te.prototype.N=function(){if(Te.Z.N.call(this),this.i){var a=this.i;for(let l in a.g){let d=a.g[l];for(let p=0;p<d.length;p++)hs(d[p]);delete a.g[l],a.h--}}this.G=null},Te.prototype.J=function(a,l,d,p){return this.i.add(String(a),l,!1,d,p)},Te.prototype.K=function(a,l,d,p){return this.i.add(String(a),l,!0,d,p)};function ps(a,l,d,p){if(l=a.i.g[String(l)],!l)return!0;l=l.concat();let v=!0;for(let S=0;S<l.length;++S){let V=l[S];if(V&&!V.da&&V.capture==d){let $=V.listener,fe=V.ha||V.src;V.fa&&Ha(a.i,V),v=$.call(fe,p)!==!1&&v}}return v&&!p.defaultPrevented}function cy(a,l){if(typeof a!="function")if(a&&typeof a.handleEvent=="function")a=h(a.handleEvent,a);else throw Error("Invalid listener argument");return Number(l)>2147483647?-1:o.setTimeout(a,l||0)}function Ad(a){a.g=cy(()=>{a.g=null,a.i&&(a.i=!1,Ad(a))},a.l);let l=a.h;a.h=null,a.m.apply(null,l)}class uy extends T{constructor(l,d){super(),this.m=l,this.l=d,this.h=null,this.i=!1,this.g=null}j(l){this.h=arguments,this.g?this.i=!0:Ad(this)}N(){super.N(),this.g&&(o.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Br(a){T.call(this),this.h=a,this.g={}}m(Br,T);var bd=[];function Sd(a){ds(a.g,function(l,d){this.g.hasOwnProperty(d)&&Xa(l)},a),a.g={}}Br.prototype.N=function(){Br.Z.N.call(this),Sd(this)},Br.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var nc=o.JSON.stringify,ly=o.JSON.parse,hy=class{stringify(a){return o.JSON.stringify(a,void 0)}parse(a){return o.JSON.parse(a,void 0)}};function Rd(){}function Pd(){}var qr={OPEN:"a",hb:"b",ERROR:"c",tb:"d"};function rc(){E.call(this,"d")}m(rc,E);function ic(){E.call(this,"c")}m(ic,E);var sn={},Cd=null;function ms(){return Cd=Cd||new Te}sn.Ia="serverreachability";function Nd(a){E.call(this,sn.Ia,a)}m(Nd,E);function jr(a){let l=ms();Se(l,new Nd(l))}sn.STAT_EVENT="statevent";function kd(a,l){E.call(this,sn.STAT_EVENT,a),this.stat=l}m(kd,E);function Re(a){let l=ms();Se(l,new kd(l,a))}sn.Ja="timingevent";function Dd(a,l){E.call(this,sn.Ja,a),this.size=l}m(Dd,E);function zr(a,l){if(typeof a!="function")throw Error("Fn must not be null and must be a function");return o.setTimeout(function(){a()},l)}function Gr(){this.g=!0}Gr.prototype.ua=function(){this.g=!1};function dy(a,l,d,p,v,S){a.info(function(){if(a.g)if(S){var V="",$=S.split("&");for(let ne=0;ne<$.length;ne++){var fe=$[ne].split("=");if(fe.length>1){let Ie=fe[0];fe=fe[1];let Xe=Ie.split("_");V=Xe.length>=2&&Xe[1]=="type"?V+(Ie+"="+fe+"&"):V+(Ie+"=redacted&")}}}else V=null;else V=S;return"XMLHTTP REQ ("+p+") [attempt "+v+"]: "+l+`
`+d+`
`+V})}function fy(a,l,d,p,v,S,V){a.info(function(){return"XMLHTTP RESP ("+p+") [ attempt "+v+"]: "+l+`
`+d+`
`+S+" "+V})}function Gn(a,l,d,p){a.info(function(){return"XMLHTTP TEXT ("+l+"): "+my(a,d)+(p?" "+p:"")})}function py(a,l){a.info(function(){return"TIMEOUT: "+l})}Gr.prototype.info=function(){};function my(a,l){if(!a.g)return l;if(!l)return null;try{let S=JSON.parse(l);if(S){for(a=0;a<S.length;a++)if(Array.isArray(S[a])){var d=S[a];if(!(d.length<2)){var p=d[1];if(Array.isArray(p)&&!(p.length<1)){var v=p[0];if(v!="noop"&&v!="stop"&&v!="close")for(let V=1;V<p.length;V++)p[V]=""}}}}return nc(S)}catch{return l}}var gs={NO_ERROR:0,cb:1,qb:2,pb:3,kb:4,ob:5,rb:6,Ga:7,TIMEOUT:8,ub:9},Od={ib:"complete",Fb:"success",ERROR:"error",Ga:"abort",xb:"ready",yb:"readystatechange",TIMEOUT:"timeout",sb:"incrementaldata",wb:"progress",lb:"downloadprogress",Nb:"uploadprogress"},Vd;function sc(){}m(sc,Rd),sc.prototype.g=function(){return new XMLHttpRequest},Vd=new sc;function $r(a){return encodeURIComponent(String(a))}function gy(a){var l=1;a=a.split(":");let d=[];for(;l>0&&a.length;)d.push(a.shift()),l--;return a.length&&d.push(a.join(":")),d}function Et(a,l,d,p){this.j=a,this.i=l,this.l=d,this.S=p||1,this.V=new Br(this),this.H=45e3,this.J=null,this.o=!1,this.u=this.B=this.A=this.M=this.F=this.T=this.D=null,this.G=[],this.g=null,this.C=0,this.m=this.v=null,this.X=-1,this.K=!1,this.P=0,this.O=null,this.W=this.L=this.U=this.R=!1,this.h=new xd}function xd(){this.i=null,this.g="",this.h=!1}var Ld={},oc={};function ac(a,l,d){a.M=1,a.A=ys(Ye(l)),a.u=d,a.R=!0,Md(a,null)}function Md(a,l){a.F=Date.now(),_s(a),a.B=Ye(a.A);var d=a.B,p=a.S;Array.isArray(p)||(p=[String(p)]),Jd(d.i,"t",p),a.C=0,d=a.j.L,a.h=new xd,a.g=mf(a.j,d?l:null,!a.u),a.P>0&&(a.O=new uy(h(a.Y,a,a.g),a.P)),l=a.V,d=a.g,p=a.ba;var v="readystatechange";Array.isArray(v)||(v&&(bd[0]=v.toString()),v=bd);for(let S=0;S<v.length;S++){let V=Id(d,v[S],p||l.handleEvent,!1,l.h||l);if(!V)break;l.g[V.key]=V}l=a.J?gd(a.J):{},a.u?(a.v||(a.v="POST"),l["Content-Type"]="application/x-www-form-urlencoded",a.g.ea(a.B,a.v,a.u,l)):(a.v="GET",a.g.ea(a.B,a.v,null,l)),jr(),dy(a.i,a.v,a.B,a.l,a.S,a.u)}Et.prototype.ba=function(a){a=a.target;let l=this.O;l&&At(a)==3?l.j():this.Y(a)},Et.prototype.Y=function(a){try{if(a==this.g)e:{let $=At(this.g),fe=this.g.ya(),ne=this.g.ca();if(!($<3)&&($!=3||this.g&&(this.h.h||this.g.la()||rf(this.g)))){this.K||$!=4||fe==7||(fe==8||ne<=0?jr(3):jr(2)),cc(this);var l=this.g.ca();this.X=l;var d=_y(this);if(this.o=l==200,fy(this.i,this.v,this.B,this.l,this.S,$,l),this.o){if(this.U&&!this.L){t:{if(this.g){var p,v=this.g;if((p=v.g?v.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!y(p)){var S=p;break t}}S=null}if(a=S)Gn(this.i,this.l,a,"Initial handshake response via X-HTTP-Initial-Response"),this.L=!0,uc(this,a);else{this.o=!1,this.m=3,Re(12),on(this),Kr(this);break e}}if(this.R){a=!0;let Ie;for(;!this.K&&this.C<d.length;)if(Ie=yy(this,d),Ie==oc){$==4&&(this.m=4,Re(14),a=!1),Gn(this.i,this.l,null,"[Incomplete Response]");break}else if(Ie==Ld){this.m=4,Re(15),Gn(this.i,this.l,d,"[Invalid Chunk]"),a=!1;break}else Gn(this.i,this.l,Ie,null),uc(this,Ie);if(Fd(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),$!=4||d.length!=0||this.h.h||(this.m=1,Re(16),a=!1),this.o=this.o&&a,!a)Gn(this.i,this.l,d,"[Invalid Chunked Response]"),on(this),Kr(this);else if(d.length>0&&!this.W){this.W=!0;var V=this.j;V.g==this&&V.aa&&!V.P&&(V.j.info("Great, no buffering proxy detected. Bytes received: "+d.length),gc(V),V.P=!0,Re(11))}}else Gn(this.i,this.l,d,null),uc(this,d);$==4&&on(this),this.o&&!this.K&&($==4?hf(this.j,this):(this.o=!1,_s(this)))}else Dy(this.g),l==400&&d.indexOf("Unknown SID")>0?(this.m=3,Re(12)):(this.m=0,Re(13)),on(this),Kr(this)}}}catch{}finally{}};function _y(a){if(!Fd(a))return a.g.la();let l=rf(a.g);if(l==="")return"";let d="",p=l.length,v=At(a.g)==4;if(!a.h.i){if(typeof TextDecoder>"u")return on(a),Kr(a),"";a.h.i=new o.TextDecoder}for(let S=0;S<p;S++)a.h.h=!0,d+=a.h.i.decode(l[S],{stream:!(v&&S==p-1)});return l.length=0,a.h.g+=d,a.C=0,a.h.g}function Fd(a){return a.g?a.v=="GET"&&a.M!=2&&a.j.Aa:!1}function yy(a,l){var d=a.C,p=l.indexOf(`
`,d);return p==-1?oc:(d=Number(l.substring(d,p)),isNaN(d)?Ld:(p+=1,p+d>l.length?oc:(l=l.slice(p,p+d),a.C=p+d,l)))}Et.prototype.cancel=function(){this.K=!0,on(this)};function _s(a){a.T=Date.now()+a.H,Ud(a,a.H)}function Ud(a,l){if(a.D!=null)throw Error("WatchDog timer not null");a.D=zr(h(a.aa,a),l)}function cc(a){a.D&&(o.clearTimeout(a.D),a.D=null)}Et.prototype.aa=function(){this.D=null;let a=Date.now();a-this.T>=0?(py(this.i,this.B),this.M!=2&&(jr(),Re(17)),on(this),this.m=2,Kr(this)):Ud(this,this.T-a)};function Kr(a){a.j.I==0||a.K||hf(a.j,a)}function on(a){cc(a);var l=a.O;l&&typeof l.dispose=="function"&&l.dispose(),a.O=null,Sd(a.V),a.g&&(l=a.g,a.g=null,l.abort(),l.dispose())}function uc(a,l){try{var d=a.j;if(d.I!=0&&(d.g==a||lc(d.h,a))){if(!a.L&&lc(d.h,a)&&d.I==3){try{var p=d.Ba.g.parse(l)}catch{p=null}if(Array.isArray(p)&&p.length==3){var v=p;if(v[0]==0){e:if(!d.v){if(d.g)if(d.g.F+3e3<a.F)As(d),Ts(d);else break e;mc(d),Re(18)}}else d.xa=v[1],0<d.xa-d.K&&v[2]<37500&&d.F&&d.A==0&&!d.C&&(d.C=zr(h(d.Va,d),6e3));jd(d.h)<=1&&d.ta&&(d.ta=void 0)}else cn(d,11)}else if((a.L||d.g==a)&&As(d),!y(l))for(v=d.Ba.g.parse(l),l=0;l<v.length;l++){let ne=v[l],Ie=ne[0];if(!(Ie<=d.K))if(d.K=Ie,ne=ne[1],d.I==2)if(ne[0]=="c"){d.M=ne[1],d.ba=ne[2];let Xe=ne[3];Xe!=null&&(d.ka=Xe,d.j.info("VER="+d.ka));let un=ne[4];un!=null&&(d.za=un,d.j.info("SVER="+d.za));let bt=ne[5];bt!=null&&typeof bt=="number"&&bt>0&&(p=1.5*bt,d.O=p,d.j.info("backChannelRequestTimeoutMs_="+p)),p=d;let St=a.g;if(St){let Ss=St.g?St.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(Ss){var S=p.h;S.g||Ss.indexOf("spdy")==-1&&Ss.indexOf("quic")==-1&&Ss.indexOf("h2")==-1||(S.j=S.l,S.g=new Set,S.h&&(hc(S,S.h),S.h=null))}if(p.G){let _c=St.g?St.g.getResponseHeader("X-HTTP-Session-Id"):null;_c&&(p.wa=_c,re(p.J,p.G,_c))}}d.I=3,d.l&&d.l.ra(),d.aa&&(d.T=Date.now()-a.F,d.j.info("Handshake RTT: "+d.T+"ms")),p=d;var V=a;if(p.na=pf(p,p.L?p.ba:null,p.W),V.L){zd(p.h,V);var $=V,fe=p.O;fe&&($.H=fe),$.D&&(cc($),_s($)),p.g=V}else uf(p);d.i.length>0&&vs(d)}else ne[0]!="stop"&&ne[0]!="close"||cn(d,7);else d.I==3&&(ne[0]=="stop"||ne[0]=="close"?ne[0]=="stop"?cn(d,7):pc(d):ne[0]!="noop"&&d.l&&d.l.qa(ne),d.A=0)}}jr(4)}catch{}}var Iy=class{constructor(a,l){this.g=a,this.map=l}};function Bd(a){this.l=a||10,o.PerformanceNavigationTiming?(a=o.performance.getEntriesByType("navigation"),a=a.length>0&&(a[0].nextHopProtocol=="hq"||a[0].nextHopProtocol=="h2")):a=!!(o.chrome&&o.chrome.loadTimes&&o.chrome.loadTimes()&&o.chrome.loadTimes().wasFetchedViaSpdy),this.j=a?this.l:1,this.g=null,this.j>1&&(this.g=new Set),this.h=null,this.i=[]}function qd(a){return a.h?!0:a.g?a.g.size>=a.j:!1}function jd(a){return a.h?1:a.g?a.g.size:0}function lc(a,l){return a.h?a.h==l:a.g?a.g.has(l):!1}function hc(a,l){a.g?a.g.add(l):a.h=l}function zd(a,l){a.h&&a.h==l?a.h=null:a.g&&a.g.has(l)&&a.g.delete(l)}Bd.prototype.cancel=function(){if(this.i=Gd(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(let a of this.g.values())a.cancel();this.g.clear()}};function Gd(a){if(a.h!=null)return a.i.concat(a.h.G);if(a.g!=null&&a.g.size!==0){let l=a.i;for(let d of a.g.values())l=l.concat(d.G);return l}return R(a.i)}var $d=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function wy(a,l){if(a){a=a.split("&");for(let d=0;d<a.length;d++){let p=a[d].indexOf("="),v,S=null;p>=0?(v=a[d].substring(0,p),S=a[d].substring(p+1)):v=a[d],l(v,S?decodeURIComponent(S.replace(/\+/g," ")):"")}}}function Tt(a){this.g=this.o=this.j="",this.u=null,this.m=this.h="",this.l=!1;let l;a instanceof Tt?(this.l=a.l,Wr(this,a.j),this.o=a.o,this.g=a.g,Hr(this,a.u),this.h=a.h,dc(this,Yd(a.i)),this.m=a.m):a&&(l=String(a).match($d))?(this.l=!1,Wr(this,l[1]||"",!0),this.o=Qr(l[2]||""),this.g=Qr(l[3]||"",!0),Hr(this,l[4]),this.h=Qr(l[5]||"",!0),dc(this,l[6]||"",!0),this.m=Qr(l[7]||"")):(this.l=!1,this.i=new Yr(null,this.l))}Tt.prototype.toString=function(){let a=[];var l=this.j;l&&a.push(Jr(l,Kd,!0),":");var d=this.g;return(d||l=="file")&&(a.push("//"),(l=this.o)&&a.push(Jr(l,Kd,!0),"@"),a.push($r(d).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),d=this.u,d!=null&&a.push(":",String(d))),(d=this.h)&&(this.g&&d.charAt(0)!="/"&&a.push("/"),a.push(Jr(d,d.charAt(0)=="/"?vy:Ty,!0))),(d=this.i.toString())&&a.push("?",d),(d=this.m)&&a.push("#",Jr(d,by)),a.join("")},Tt.prototype.resolve=function(a){let l=Ye(this),d=!!a.j;d?Wr(l,a.j):d=!!a.o,d?l.o=a.o:d=!!a.g,d?l.g=a.g:d=a.u!=null;var p=a.h;if(d)Hr(l,a.u);else if(d=!!a.h){if(p.charAt(0)!="/")if(this.g&&!this.h)p="/"+p;else{var v=l.h.lastIndexOf("/");v!=-1&&(p=l.h.slice(0,v+1)+p)}if(v=p,v==".."||v==".")p="";else if(v.indexOf("./")!=-1||v.indexOf("/.")!=-1){p=v.lastIndexOf("/",0)==0,v=v.split("/");let S=[];for(let V=0;V<v.length;){let $=v[V++];$=="."?p&&V==v.length&&S.push(""):$==".."?((S.length>1||S.length==1&&S[0]!="")&&S.pop(),p&&V==v.length&&S.push("")):(S.push($),p=!0)}p=S.join("/")}else p=v}return d?l.h=p:d=a.i.toString()!=="",d?dc(l,Yd(a.i)):d=!!a.m,d&&(l.m=a.m),l};function Ye(a){return new Tt(a)}function Wr(a,l,d){a.j=d?Qr(l,!0):l,a.j&&(a.j=a.j.replace(/:$/,""))}function Hr(a,l){if(l){if(l=Number(l),isNaN(l)||l<0)throw Error("Bad port number "+l);a.u=l}else a.u=null}function dc(a,l,d){l instanceof Yr?(a.i=l,Sy(a.i,a.l)):(d||(l=Jr(l,Ay)),a.i=new Yr(l,a.l))}function re(a,l,d){a.i.set(l,d)}function ys(a){return re(a,"zx",Math.floor(Math.random()*2147483648).toString(36)+Math.abs(Math.floor(Math.random()*2147483648)^Date.now()).toString(36)),a}function Qr(a,l){return a?l?decodeURI(a.replace(/%25/g,"%2525")):decodeURIComponent(a):""}function Jr(a,l,d){return typeof a=="string"?(a=encodeURI(a).replace(l,Ey),d&&(a=a.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),a):null}function Ey(a){return a=a.charCodeAt(0),"%"+(a>>4&15).toString(16)+(a&15).toString(16)}var Kd=/[#\/\?@]/g,Ty=/[#\?:]/g,vy=/[#\?]/g,Ay=/[#\?@]/g,by=/#/g;function Yr(a,l){this.h=this.g=null,this.i=a||null,this.j=!!l}function an(a){a.g||(a.g=new Map,a.h=0,a.i&&wy(a.i,function(l,d){a.add(decodeURIComponent(l.replace(/\+/g," ")),d)}))}n=Yr.prototype,n.add=function(a,l){an(this),this.i=null,a=$n(this,a);let d=this.g.get(a);return d||this.g.set(a,d=[]),d.push(l),this.h+=1,this};function Wd(a,l){an(a),l=$n(a,l),a.g.has(l)&&(a.i=null,a.h-=a.g.get(l).length,a.g.delete(l))}function Hd(a,l){return an(a),l=$n(a,l),a.g.has(l)}n.forEach=function(a,l){an(this),this.g.forEach(function(d,p){d.forEach(function(v){a.call(l,v,p,this)},this)},this)};function Qd(a,l){an(a);let d=[];if(typeof l=="string")Hd(a,l)&&(d=d.concat(a.g.get($n(a,l))));else for(a=Array.from(a.g.values()),l=0;l<a.length;l++)d=d.concat(a[l]);return d}n.set=function(a,l){return an(this),this.i=null,a=$n(this,a),Hd(this,a)&&(this.h-=this.g.get(a).length),this.g.set(a,[l]),this.h+=1,this},n.get=function(a,l){return a?(a=Qd(this,a),a.length>0?String(a[0]):l):l};function Jd(a,l,d){Wd(a,l),d.length>0&&(a.i=null,a.g.set($n(a,l),R(d)),a.h+=d.length)}n.toString=function(){if(this.i)return this.i;if(!this.g)return"";let a=[],l=Array.from(this.g.keys());for(let p=0;p<l.length;p++){var d=l[p];let v=$r(d);d=Qd(this,d);for(let S=0;S<d.length;S++){let V=v;d[S]!==""&&(V+="="+$r(d[S])),a.push(V)}}return this.i=a.join("&")};function Yd(a){let l=new Yr;return l.i=a.i,a.g&&(l.g=new Map(a.g),l.h=a.h),l}function $n(a,l){return l=String(l),a.j&&(l=l.toLowerCase()),l}function Sy(a,l){l&&!a.j&&(an(a),a.i=null,a.g.forEach(function(d,p){let v=p.toLowerCase();p!=v&&(Wd(this,p),Jd(this,v,d))},a)),a.j=l}function Ry(a,l){let d=new Gr;if(o.Image){let p=new Image;p.onload=f(vt,d,"TestLoadImage: loaded",!0,l,p),p.onerror=f(vt,d,"TestLoadImage: error",!1,l,p),p.onabort=f(vt,d,"TestLoadImage: abort",!1,l,p),p.ontimeout=f(vt,d,"TestLoadImage: timeout",!1,l,p),o.setTimeout(function(){p.ontimeout&&p.ontimeout()},1e4),p.src=a}else l(!1)}function Py(a,l){let d=new Gr,p=new AbortController,v=setTimeout(()=>{p.abort(),vt(d,"TestPingServer: timeout",!1,l)},1e4);fetch(a,{signal:p.signal}).then(S=>{clearTimeout(v),S.ok?vt(d,"TestPingServer: ok",!0,l):vt(d,"TestPingServer: server error",!1,l)}).catch(()=>{clearTimeout(v),vt(d,"TestPingServer: error",!1,l)})}function vt(a,l,d,p,v){try{v&&(v.onload=null,v.onerror=null,v.onabort=null,v.ontimeout=null),p(d)}catch{}}function Cy(){this.g=new hy}function Is(a){this.i=a.Sb||null,this.h=a.ab||!1}m(Is,Rd),Is.prototype.g=function(){return new ws(this.i,this.h)};function ws(a,l){Te.call(this),this.H=a,this.o=l,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.A=new Headers,this.h=null,this.F="GET",this.D="",this.g=!1,this.B=this.j=this.l=null,this.v=new AbortController}m(ws,Te),n=ws.prototype,n.open=function(a,l){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.F=a,this.D=l,this.readyState=1,Zr(this)},n.send=function(a){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");if(this.v.signal.aborted)throw this.abort(),Error("Request was aborted.");this.g=!0;let l={headers:this.A,method:this.F,credentials:this.m,cache:void 0,signal:this.v.signal};a&&(l.body=a),(this.H||o).fetch(new Request(this.D,l)).then(this.Pa.bind(this),this.ga.bind(this))},n.abort=function(){this.response=this.responseText="",this.A=new Headers,this.status=0,this.v.abort(),this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),this.readyState>=1&&this.g&&this.readyState!=4&&(this.g=!1,Xr(this)),this.readyState=0},n.Pa=function(a){if(this.g&&(this.l=a,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=a.headers,this.readyState=2,Zr(this)),this.g&&(this.readyState=3,Zr(this),this.g)))if(this.responseType==="arraybuffer")a.arrayBuffer().then(this.Na.bind(this),this.ga.bind(this));else if(typeof o.ReadableStream<"u"&&"body"in a){if(this.j=a.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.B=new TextDecoder;Xd(this)}else a.text().then(this.Oa.bind(this),this.ga.bind(this))};function Xd(a){a.j.read().then(a.Ma.bind(a)).catch(a.ga.bind(a))}n.Ma=function(a){if(this.g){if(this.o&&a.value)this.response.push(a.value);else if(!this.o){var l=a.value?a.value:new Uint8Array(0);(l=this.B.decode(l,{stream:!a.done}))&&(this.response=this.responseText+=l)}a.done?Xr(this):Zr(this),this.readyState==3&&Xd(this)}},n.Oa=function(a){this.g&&(this.response=this.responseText=a,Xr(this))},n.Na=function(a){this.g&&(this.response=a,Xr(this))},n.ga=function(){this.g&&Xr(this)};function Xr(a){a.readyState=4,a.l=null,a.j=null,a.B=null,Zr(a)}n.setRequestHeader=function(a,l){this.A.append(a,l)},n.getResponseHeader=function(a){return this.h&&this.h.get(a.toLowerCase())||""},n.getAllResponseHeaders=function(){if(!this.h)return"";let a=[],l=this.h.entries();for(var d=l.next();!d.done;)d=d.value,a.push(d[0]+": "+d[1]),d=l.next();return a.join(`\r
`)};function Zr(a){a.onreadystatechange&&a.onreadystatechange.call(a)}Object.defineProperty(ws.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(a){this.m=a?"include":"same-origin"}});function Zd(a){let l="";return ds(a,function(d,p){l+=p,l+=":",l+=d,l+=`\r
`}),l}function fc(a,l,d){e:{for(p in d){var p=!1;break e}p=!0}p||(d=Zd(d),typeof a=="string"?d!=null&&$r(d):re(a,l,d))}function ae(a){Te.call(this),this.headers=new Map,this.L=a||null,this.h=!1,this.g=null,this.D="",this.o=0,this.l="",this.j=this.B=this.v=this.A=!1,this.m=null,this.F="",this.H=!1}m(ae,Te);var Ny=/^https?$/i,ky=["POST","PUT"];n=ae.prototype,n.Fa=function(a){this.H=a},n.ea=function(a,l,d,p){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+a);l=l?l.toUpperCase():"GET",this.D=a,this.l="",this.o=0,this.A=!1,this.h=!0,this.g=this.L?this.L.g():Vd.g(),this.g.onreadystatechange=_(h(this.Ca,this));try{this.B=!0,this.g.open(l,String(a),!0),this.B=!1}catch(S){ef(this,S);return}if(a=d||"",d=new Map(this.headers),p)if(Object.getPrototypeOf(p)===Object.prototype)for(var v in p)d.set(v,p[v]);else if(typeof p.keys=="function"&&typeof p.get=="function")for(let S of p.keys())d.set(S,p.get(S));else throw Error("Unknown input type for opt_headers: "+String(p));p=Array.from(d.keys()).find(S=>S.toLowerCase()=="content-type"),v=o.FormData&&a instanceof o.FormData,!(Array.prototype.indexOf.call(ky,l,void 0)>=0)||p||v||d.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(let[S,V]of d)this.g.setRequestHeader(S,V);this.F&&(this.g.responseType=this.F),"withCredentials"in this.g&&this.g.withCredentials!==this.H&&(this.g.withCredentials=this.H);try{this.m&&(clearTimeout(this.m),this.m=null),this.v=!0,this.g.send(a),this.v=!1}catch(S){ef(this,S)}};function ef(a,l){a.h=!1,a.g&&(a.j=!0,a.g.abort(),a.j=!1),a.l=l,a.o=5,tf(a),Es(a)}function tf(a){a.A||(a.A=!0,Se(a,"complete"),Se(a,"error"))}n.abort=function(a){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.o=a||7,Se(this,"complete"),Se(this,"abort"),Es(this))},n.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),Es(this,!0)),ae.Z.N.call(this)},n.Ca=function(){this.u||(this.B||this.v||this.j?nf(this):this.Xa())},n.Xa=function(){nf(this)};function nf(a){if(a.h&&typeof s<"u"){if(a.v&&At(a)==4)setTimeout(a.Ca.bind(a),0);else if(Se(a,"readystatechange"),At(a)==4){a.h=!1;try{let S=a.ca();e:switch(S){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var l=!0;break e;default:l=!1}var d;if(!(d=l)){var p;if(p=S===0){let V=String(a.D).match($d)[1]||null;!V&&o.self&&o.self.location&&(V=o.self.location.protocol.slice(0,-1)),p=!Ny.test(V?V.toLowerCase():"")}d=p}if(d)Se(a,"complete"),Se(a,"success");else{a.o=6;try{var v=At(a)>2?a.g.statusText:""}catch{v=""}a.l=v+" ["+a.ca()+"]",tf(a)}}finally{Es(a)}}}}function Es(a,l){if(a.g){a.m&&(clearTimeout(a.m),a.m=null);let d=a.g;a.g=null,l||Se(a,"ready");try{d.onreadystatechange=null}catch{}}}n.isActive=function(){return!!this.g};function At(a){return a.g?a.g.readyState:0}n.ca=function(){try{return At(this)>2?this.g.status:-1}catch{return-1}},n.la=function(){try{return this.g?this.g.responseText:""}catch{return""}},n.La=function(a){if(this.g){var l=this.g.responseText;return a&&l.indexOf(a)==0&&(l=l.substring(a.length)),ly(l)}};function rf(a){try{if(!a.g)return null;if("response"in a.g)return a.g.response;switch(a.F){case"":case"text":return a.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in a.g)return a.g.mozResponseArrayBuffer}return null}catch{return null}}function Dy(a){let l={};a=(a.g&&At(a)>=2&&a.g.getAllResponseHeaders()||"").split(`\r
`);for(let p=0;p<a.length;p++){if(y(a[p]))continue;var d=gy(a[p]);let v=d[0];if(d=d[1],typeof d!="string")continue;d=d.trim();let S=l[v]||[];l[v]=S,S.push(d)}sy(l,function(p){return p.join(", ")})}n.ya=function(){return this.o},n.Ha=function(){return typeof this.l=="string"?this.l:String(this.l)};function ei(a,l,d){return d&&d.internalChannelParams&&d.internalChannelParams[a]||l}function sf(a){this.za=0,this.i=[],this.j=new Gr,this.ba=this.na=this.J=this.W=this.g=this.wa=this.G=this.H=this.u=this.U=this.o=null,this.Ya=this.V=0,this.Sa=ei("failFast",!1,a),this.F=this.C=this.v=this.m=this.l=null,this.X=!0,this.xa=this.K=-1,this.Y=this.A=this.D=0,this.Qa=ei("baseRetryDelayMs",5e3,a),this.Za=ei("retryDelaySeedMs",1e4,a),this.Ta=ei("forwardChannelMaxRetries",2,a),this.va=ei("forwardChannelRequestTimeoutMs",2e4,a),this.ma=a&&a.xmlHttpFactory||void 0,this.Ua=a&&a.Rb||void 0,this.Aa=a&&a.useFetchStreams||!1,this.O=void 0,this.L=a&&a.supportsCrossDomainXhr||!1,this.M="",this.h=new Bd(a&&a.concurrentRequestLimit),this.Ba=new Cy,this.S=a&&a.fastHandshake||!1,this.R=a&&a.encodeInitMessageHeaders||!1,this.S&&this.R&&(this.R=!1),this.Ra=a&&a.Pb||!1,a&&a.ua&&this.j.ua(),a&&a.forceLongPolling&&(this.X=!1),this.aa=!this.S&&this.X&&a&&a.detectBufferingProxy||!1,this.ia=void 0,a&&a.longPollingTimeout&&a.longPollingTimeout>0&&(this.ia=a.longPollingTimeout),this.ta=void 0,this.T=0,this.P=!1,this.ja=this.B=null}n=sf.prototype,n.ka=8,n.I=1,n.connect=function(a,l,d,p){Re(0),this.W=a,this.H=l||{},d&&p!==void 0&&(this.H.OSID=d,this.H.OAID=p),this.F=this.X,this.J=pf(this,null,this.W),vs(this)};function pc(a){if(of(a),a.I==3){var l=a.V++,d=Ye(a.J);if(re(d,"SID",a.M),re(d,"RID",l),re(d,"TYPE","terminate"),ti(a,d),l=new Et(a,a.j,l),l.M=2,l.A=ys(Ye(d)),d=!1,o.navigator&&o.navigator.sendBeacon)try{d=o.navigator.sendBeacon(l.A.toString(),"")}catch{}!d&&o.Image&&(new Image().src=l.A,d=!0),d||(l.g=mf(l.j,null),l.g.ea(l.A)),l.F=Date.now(),_s(l)}ff(a)}function Ts(a){a.g&&(gc(a),a.g.cancel(),a.g=null)}function of(a){Ts(a),a.v&&(o.clearTimeout(a.v),a.v=null),As(a),a.h.cancel(),a.m&&(typeof a.m=="number"&&o.clearTimeout(a.m),a.m=null)}function vs(a){if(!qd(a.h)&&!a.m){a.m=!0;var l=a.Ea;Y||g(),Q||(Y(),Q=!0),w.add(l,a),a.D=0}}function Oy(a,l){return jd(a.h)>=a.h.j-(a.m?1:0)?!1:a.m?(a.i=l.G.concat(a.i),!0):a.I==1||a.I==2||a.D>=(a.Sa?0:a.Ta)?!1:(a.m=zr(h(a.Ea,a,l),df(a,a.D)),a.D++,!0)}n.Ea=function(a){if(this.m)if(this.m=null,this.I==1){if(!a){this.V=Math.floor(Math.random()*1e5),a=this.V++;let v=new Et(this,this.j,a),S=this.o;if(this.U&&(S?(S=gd(S),yd(S,this.U)):S=this.U),this.u!==null||this.R||(v.J=S,S=null),this.S)e:{for(var l=0,d=0;d<this.i.length;d++){t:{var p=this.i[d];if("__data__"in p.map&&(p=p.map.__data__,typeof p=="string")){p=p.length;break t}p=void 0}if(p===void 0)break;if(l+=p,l>4096){l=d;break e}if(l===4096||d===this.i.length-1){l=d+1;break e}}l=1e3}else l=1e3;l=cf(this,v,l),d=Ye(this.J),re(d,"RID",a),re(d,"CVER",22),this.G&&re(d,"X-HTTP-Session-Id",this.G),ti(this,d),S&&(this.R?l="headers="+$r(Zd(S))+"&"+l:this.u&&fc(d,this.u,S)),hc(this.h,v),this.Ra&&re(d,"TYPE","init"),this.S?(re(d,"$req",l),re(d,"SID","null"),v.U=!0,ac(v,d,null)):ac(v,d,l),this.I=2}}else this.I==3&&(a?af(this,a):this.i.length==0||qd(this.h)||af(this))};function af(a,l){var d;l?d=l.l:d=a.V++;let p=Ye(a.J);re(p,"SID",a.M),re(p,"RID",d),re(p,"AID",a.K),ti(a,p),a.u&&a.o&&fc(p,a.u,a.o),d=new Et(a,a.j,d,a.D+1),a.u===null&&(d.J=a.o),l&&(a.i=l.G.concat(a.i)),l=cf(a,d,1e3),d.H=Math.round(a.va*.5)+Math.round(a.va*.5*Math.random()),hc(a.h,d),ac(d,p,l)}function ti(a,l){a.H&&ds(a.H,function(d,p){re(l,p,d)}),a.l&&ds({},function(d,p){re(l,p,d)})}function cf(a,l,d){d=Math.min(a.i.length,d);let p=a.l?h(a.l.Ka,a.l,a):null;e:{var v=a.i;let $=-1;for(;;){let fe=["count="+d];$==-1?d>0?($=v[0].g,fe.push("ofs="+$)):$=0:fe.push("ofs="+$);let ne=!0;for(let Ie=0;Ie<d;Ie++){var S=v[Ie].g;let Xe=v[Ie].map;if(S-=$,S<0)$=Math.max(0,v[Ie].g-100),ne=!1;else try{S="req"+S+"_"||"";try{var V=Xe instanceof Map?Xe:Object.entries(Xe);for(let[un,bt]of V){let St=bt;c(bt)&&(St=nc(bt)),fe.push(S+un+"="+encodeURIComponent(St))}}catch(un){throw fe.push(S+"type="+encodeURIComponent("_badmap")),un}}catch{p&&p(Xe)}}if(ne){V=fe.join("&");break e}}V=void 0}return a=a.i.splice(0,d),l.G=a,V}function uf(a){if(!a.g&&!a.v){a.Y=1;var l=a.Da;Y||g(),Q||(Y(),Q=!0),w.add(l,a),a.A=0}}function mc(a){return a.g||a.v||a.A>=3?!1:(a.Y++,a.v=zr(h(a.Da,a),df(a,a.A)),a.A++,!0)}n.Da=function(){if(this.v=null,lf(this),this.aa&&!(this.P||this.g==null||this.T<=0)){var a=4*this.T;this.j.info("BP detection timer enabled: "+a),this.B=zr(h(this.Wa,this),a)}},n.Wa=function(){this.B&&(this.B=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.P=!0,Re(10),Ts(this),lf(this))};function gc(a){a.B!=null&&(o.clearTimeout(a.B),a.B=null)}function lf(a){a.g=new Et(a,a.j,"rpc",a.Y),a.u===null&&(a.g.J=a.o),a.g.P=0;var l=Ye(a.na);re(l,"RID","rpc"),re(l,"SID",a.M),re(l,"AID",a.K),re(l,"CI",a.F?"0":"1"),!a.F&&a.ia&&re(l,"TO",a.ia),re(l,"TYPE","xmlhttp"),ti(a,l),a.u&&a.o&&fc(l,a.u,a.o),a.O&&(a.g.H=a.O);var d=a.g;a=a.ba,d.M=1,d.A=ys(Ye(l)),d.u=null,d.R=!0,Md(d,a)}n.Va=function(){this.C!=null&&(this.C=null,Ts(this),mc(this),Re(19))};function As(a){a.C!=null&&(o.clearTimeout(a.C),a.C=null)}function hf(a,l){var d=null;if(a.g==l){As(a),gc(a),a.g=null;var p=2}else if(lc(a.h,l))d=l.G,zd(a.h,l),p=1;else return;if(a.I!=0){if(l.o)if(p==1){d=l.u?l.u.length:0,l=Date.now()-l.F;var v=a.D;p=ms(),Se(p,new Dd(p,d)),vs(a)}else uf(a);else if(v=l.m,v==3||v==0&&l.X>0||!(p==1&&Oy(a,l)||p==2&&mc(a)))switch(d&&d.length>0&&(l=a.h,l.i=l.i.concat(d)),v){case 1:cn(a,5);break;case 4:cn(a,10);break;case 3:cn(a,6);break;default:cn(a,2)}}}function df(a,l){let d=a.Qa+Math.floor(Math.random()*a.Za);return a.isActive()||(d*=2),d*l}function cn(a,l){if(a.j.info("Error code "+l),l==2){var d=h(a.bb,a),p=a.Ua;let v=!p;p=new Tt(p||"//www.google.com/images/cleardot.gif"),o.location&&o.location.protocol=="http"||Wr(p,"https"),ys(p),v?Ry(p.toString(),d):Py(p.toString(),d)}else Re(2);a.I=0,a.l&&a.l.pa(l),ff(a),of(a)}n.bb=function(a){a?(this.j.info("Successfully pinged google.com"),Re(2)):(this.j.info("Failed to ping google.com"),Re(1))};function ff(a){if(a.I=0,a.ja=[],a.l){let l=Gd(a.h);(l.length!=0||a.i.length!=0)&&(k(a.ja,l),k(a.ja,a.i),a.h.i.length=0,R(a.i),a.i.length=0),a.l.oa()}}function pf(a,l,d){var p=d instanceof Tt?Ye(d):new Tt(d);if(p.g!="")l&&(p.g=l+"."+p.g),Hr(p,p.u);else{var v=o.location;p=v.protocol,l=l?l+"."+v.hostname:v.hostname,v=+v.port;let S=new Tt(null);p&&Wr(S,p),l&&(S.g=l),v&&Hr(S,v),d&&(S.h=d),p=S}return d=a.G,l=a.wa,d&&l&&re(p,d,l),re(p,"VER",a.ka),ti(a,p),p}function mf(a,l,d){if(l&&!a.L)throw Error("Can't create secondary domain capable XhrIo object.");return l=a.Aa&&!a.ma?new ae(new Is({ab:d})):new ae(a.ma),l.Fa(a.L),l}n.isActive=function(){return!!this.l&&this.l.isActive(this)};function gf(){}n=gf.prototype,n.ra=function(){},n.qa=function(){},n.pa=function(){},n.oa=function(){},n.isActive=function(){return!0},n.Ka=function(){};function bs(){}bs.prototype.g=function(a,l){return new xe(a,l)};function xe(a,l){Te.call(this),this.g=new sf(l),this.l=a,this.h=l&&l.messageUrlParams||null,a=l&&l.messageHeaders||null,l&&l.clientProtocolHeaderRequired&&(a?a["X-Client-Protocol"]="webchannel":a={"X-Client-Protocol":"webchannel"}),this.g.o=a,a=l&&l.initMessageHeaders||null,l&&l.messageContentType&&(a?a["X-WebChannel-Content-Type"]=l.messageContentType:a={"X-WebChannel-Content-Type":l.messageContentType}),l&&l.sa&&(a?a["X-WebChannel-Client-Profile"]=l.sa:a={"X-WebChannel-Client-Profile":l.sa}),this.g.U=a,(a=l&&l.Qb)&&!y(a)&&(this.g.u=a),this.A=l&&l.supportsCrossDomainXhr||!1,this.v=l&&l.sendRawJson||!1,(l=l&&l.httpSessionIdParam)&&!y(l)&&(this.g.G=l,a=this.h,a!==null&&l in a&&(a=this.h,l in a&&delete a[l])),this.j=new Kn(this)}m(xe,Te),xe.prototype.m=function(){this.g.l=this.j,this.A&&(this.g.L=!0),this.g.connect(this.l,this.h||void 0)},xe.prototype.close=function(){pc(this.g)},xe.prototype.o=function(a){var l=this.g;if(typeof a=="string"){var d={};d.__data__=a,a=d}else this.v&&(d={},d.__data__=nc(a),a=d);l.i.push(new Iy(l.Ya++,a)),l.I==3&&vs(l)},xe.prototype.N=function(){this.g.l=null,delete this.j,pc(this.g),delete this.g,xe.Z.N.call(this)};function _f(a){rc.call(this),a.__headers__&&(this.headers=a.__headers__,this.statusCode=a.__status__,delete a.__headers__,delete a.__status__);var l=a.__sm__;if(l){e:{for(let d in l){a=d;break e}a=void 0}(this.i=a)&&(a=this.i,l=l!==null&&a in l?l[a]:void 0),this.data=l}else this.data=a}m(_f,rc);function yf(){ic.call(this),this.status=1}m(yf,ic);function Kn(a){this.g=a}m(Kn,gf),Kn.prototype.ra=function(){Se(this.g,"a")},Kn.prototype.qa=function(a){Se(this.g,new _f(a))},Kn.prototype.pa=function(a){Se(this.g,new yf)},Kn.prototype.oa=function(){Se(this.g,"b")},bs.prototype.createWebChannel=bs.prototype.g,xe.prototype.send=xe.prototype.o,xe.prototype.open=xe.prototype.m,xe.prototype.close=xe.prototype.close,Nu=mt.createWebChannelTransport=function(){return new bs},Cu=mt.getStatEventTarget=function(){return ms()},Pu=mt.Event=sn,Io=mt.Stat={jb:0,mb:1,nb:2,Hb:3,Mb:4,Jb:5,Kb:6,Ib:7,Gb:8,Lb:9,PROXY:10,NOPROXY:11,Eb:12,Ab:13,Bb:14,zb:15,Cb:16,Db:17,fb:18,eb:19,gb:20},gs.NO_ERROR=0,gs.TIMEOUT=8,gs.HTTP_ERROR=6,Ei=mt.ErrorCode=gs,Od.COMPLETE="complete",Ru=mt.EventType=Od,Pd.EventType=qr,qr.OPEN="a",qr.CLOSE="b",qr.ERROR="c",qr.MESSAGE="d",Te.prototype.listen=Te.prototype.J,Zn=mt.WebChannel=Pd,QE=mt.FetchXmlHttpFactory=Is,ae.prototype.listenOnce=ae.prototype.K,ae.prototype.getLastError=ae.prototype.Ha,ae.prototype.getLastErrorCode=ae.prototype.ya,ae.prototype.getStatus=ae.prototype.ca,ae.prototype.getResponseJson=ae.prototype.La,ae.prototype.getResponseText=ae.prototype.la,ae.prototype.send=ae.prototype.ea,ae.prototype.setWithCredentials=ae.prototype.Fa,Su=mt.XhrIo=ae}).apply(typeof yo<"u"?yo:typeof self<"u"?self:typeof window<"u"?window:{});var Yp="@firebase/firestore",Xp="4.9.2";var me=class{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}};me.UNAUTHENTICATED=new me(null),me.GOOGLE_CREDENTIALS=new me("google-credentials-uid"),me.FIRST_PARTY=new me("first-party-uid"),me.MOCK_USER=new me("mock-user");var Mr="12.3.0";var Dn=new Pt("@firebase/firestore");function or(){return Dn.logLevel}function C(n,...e){if(Dn.logLevel<=W.DEBUG){let t=e.map(Vh);Dn.debug(`Firestore (${Mr}): ${n}`,...t)}}function Pe(n,...e){if(Dn.logLevel<=W.ERROR){let t=e.map(Vh);Dn.error(`Firestore (${Mr}): ${n}`,...t)}}function On(n,...e){if(Dn.logLevel<=W.WARN){let t=e.map(Vh);Dn.warn(`Firestore (${Mr}): ${n}`,...t)}}function Vh(n){if(typeof n=="string")return n;try{return(function(t){return JSON.stringify(t)})(n)}catch{return n}}function L(n,e,t){let r="Unexpected state";typeof e=="string"?r=e:t=e,ug(n,r,t)}function ug(n,e,t){let r=`FIRESTORE (${Mr}) INTERNAL ASSERTION FAILED: ${e} (ID: ${n.toString(16)})`;if(t!==void 0)try{r+=" CONTEXT: "+JSON.stringify(t)}catch{r+=" CONTEXT: "+t}throw Pe(r),new Error(r)}function F(n,e,t,r){let i="Unexpected state";typeof t=="string"?i=t:r=t,n||ug(e,i,r)}function G(n,e){return n}var P={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},D=class extends Le{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}};var je=class{constructor(){this.promise=new Promise(((e,t)=>{this.resolve=e,this.reject=t}))}};var Oo=class{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}},Fu=class{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable((()=>t(me.UNAUTHENTICATED)))}shutdown(){}},Uu=class{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable((()=>t(this.token.user)))}shutdown(){this.changeListener=null}},Bu=class{constructor(e){this.t=e,this.currentUser=me.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){F(this.o===void 0,42304);let r=this.i,i=u=>this.i!==r?(r=this.i,t(u)):Promise.resolve(),s=new je;this.o=()=>{this.i++,this.currentUser=this.u(),s.resolve(),s=new je,e.enqueueRetryable((()=>i(this.currentUser)))};let o=()=>{let u=s;e.enqueueRetryable((async()=>{await u.promise,await i(this.currentUser)}))},c=u=>{C("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=u,this.o&&(this.auth.addAuthTokenListener(this.o),o())};this.t.onInit((u=>c(u))),setTimeout((()=>{if(!this.auth){let u=this.t.getImmediate({optional:!0});u?c(u):(C("FirebaseAuthCredentialsProvider","Auth not yet detected"),s.resolve(),s=new je)}}),0),o()}getToken(){let e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then((r=>this.i!==e?(C("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(F(typeof r.accessToken=="string",31837,{l:r}),new Oo(r.accessToken,this.currentUser)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){let e=this.auth&&this.auth.getUid();return F(e===null||typeof e=="string",2055,{h:e}),new me(e)}},qu=class{constructor(e,t,r){this.P=e,this.T=t,this.I=r,this.type="FirstParty",this.user=me.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);let e=this.R();return e&&this.A.set("Authorization",e),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}},ju=class{constructor(e,t,r){this.P=e,this.T=t,this.I=r}getToken(){return Promise.resolve(new qu(this.P,this.T,this.I))}start(e,t){e.enqueueRetryable((()=>t(me.FIRST_PARTY)))}shutdown(){}invalidateToken(){}},Vo=class{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}},zu=class{constructor(e,t){this.V=t,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,De(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,t){F(this.o===void 0,3512);let r=s=>{s.error!=null&&C("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${s.error.message}`);let o=s.token!==this.m;return this.m=s.token,C("FirebaseAppCheckTokenProvider",`Received ${o?"new":"existing"} token.`),o?t(s.token):Promise.resolve()};this.o=s=>{e.enqueueRetryable((()=>r(s)))};let i=s=>{C("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=s,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit((s=>i(s))),setTimeout((()=>{if(!this.appCheck){let s=this.V.getImmediate({optional:!0});s?i(s):C("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}}),0)}getToken(){if(this.p)return Promise.resolve(new Vo(this.p));let e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then((t=>t?(F(typeof t.token=="string",44558,{tokenResult:t}),this.m=t.token,new Vo(t.token)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}};function JE(n){let e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(n);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(t);else for(let r=0;r<n;r++)t[r]=Math.floor(256*Math.random());return t}var xi=class{static newId(){let e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=62*Math.floor(4.129032258064516),r="";for(;r.length<20;){let i=JE(40);for(let s=0;s<i.length;++s)r.length<20&&i[s]<t&&(r+=e.charAt(i[s]%62))}return r}};function z(n,e){return n<e?-1:n>e?1:0}function Gu(n,e){let t=Math.min(n.length,e.length);for(let r=0;r<t;r++){let i=n.charAt(r),s=e.charAt(r);if(i!==s)return ku(i)===ku(s)?z(i,s):ku(i)?1:-1}return z(n.length,e.length)}var YE=55296,XE=57343;function ku(n){let e=n.charCodeAt(0);return e>=YE&&e<=XE}function gr(n,e,t){return n.length===e.length&&n.every(((r,i)=>t(r,e[i])))}function lg(n){return n+"\0"}var Zp="__name__",xo=class n{constructor(e,t,r){t===void 0?t=0:t>e.length&&L(637,{offset:t,range:e.length}),r===void 0?r=e.length-t:r>e.length-t&&L(1746,{length:r,range:e.length-t}),this.segments=e,this.offset=t,this.len=r}get length(){return this.len}isEqual(e){return n.comparator(this,e)===0}child(e){let t=this.segments.slice(this.offset,this.limit());return e instanceof n?e.forEach((r=>{t.push(r)})):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,r=this.limit();t<r;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){let r=Math.min(e.length,t.length);for(let i=0;i<r;i++){let s=n.compareSegments(e.get(i),t.get(i));if(s!==0)return s}return z(e.length,t.length)}static compareSegments(e,t){let r=n.isNumericId(e),i=n.isNumericId(t);return r&&!i?-1:!r&&i?1:r&&i?n.extractNumericId(e).compare(n.extractNumericId(t)):Gu(e,t)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return pt.fromString(e.substring(4,e.length-2))}},X=class n extends xo{construct(e,t,r){return new n(e,t,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){let t=[];for(let r of e){if(r.indexOf("//")>=0)throw new D(P.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);t.push(...r.split("/").filter((i=>i.length>0)))}return new n(t)}static emptyPath(){return new n([])}},ZE=/^[_a-zA-Z][_a-zA-Z0-9]*$/,ge=class n extends xo{construct(e,t,r){return new n(e,t,r)}static isValidIdentifier(e){return ZE.test(e)}canonicalString(){return this.toArray().map((e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),n.isValidIdentifier(e)||(e="`"+e+"`"),e))).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===Zp}static keyField(){return new n([Zp])}static fromServerFormat(e){let t=[],r="",i=0,s=()=>{if(r.length===0)throw new D(P.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(r),r=""},o=!1;for(;i<e.length;){let c=e[i];if(c==="\\"){if(i+1===e.length)throw new D(P.INVALID_ARGUMENT,"Path has trailing escape character: "+e);let u=e[i+1];if(u!=="\\"&&u!=="."&&u!=="`")throw new D(P.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=u,i+=2}else c==="`"?(o=!o,i++):c!=="."||o?(r+=c,i++):(s(),i++)}if(s(),o)throw new D(P.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new n(t)}static emptyPath(){return new n([])}};var x=class n{constructor(e){this.path=e}static fromPath(e){return new n(X.fromString(e))}static fromName(e){return new n(X.fromString(e).popFirst(5))}static empty(){return new n(X.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&X.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,t){return X.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new n(new X(e.slice()))}};function hg(n,e,t){if(!t)throw new D(P.INVALID_ARGUMENT,`Function ${n}() cannot be called with an empty ${e}.`)}function eT(n,e,t,r){if(e===!0&&r===!0)throw new D(P.INVALID_ARGUMENT,`${n} and ${t} cannot be used together.`)}function em(n){if(!x.isDocumentKey(n))throw new D(P.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${n} has ${n.length}.`)}function tm(n){if(x.isDocumentKey(n))throw new D(P.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${n} has ${n.length}.`)}function dg(n){return typeof n=="object"&&n!==null&&(Object.getPrototypeOf(n)===Object.prototype||Object.getPrototypeOf(n)===null)}function xa(n){if(n===void 0)return"undefined";if(n===null)return"null";if(typeof n=="string")return n.length>20&&(n=`${n.substring(0,20)}...`),JSON.stringify(n);if(typeof n=="number"||typeof n=="boolean")return""+n;if(typeof n=="object"){if(n instanceof Array)return"an array";{let e=(function(r){return r.constructor?r.constructor.name:null})(n);return e?`a custom ${e} object`:"an object"}}return typeof n=="function"?"a function":L(12329,{type:typeof n})}function He(n,e){if("_delegate"in n&&(n=n._delegate),!(n instanceof e)){if(e.name===n.constructor.name)throw new D(P.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{let t=xa(n);throw new D(P.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return n}function tT(n,e){if(e<=0)throw new D(P.INVALID_ARGUMENT,`Function ${n}() requires a positive number, but it was: ${e}.`)}function de(n,e){let t={typeString:n};return e&&(t.value=e),t}function ns(n,e){if(!dg(n))throw new D(P.INVALID_ARGUMENT,"JSON must be an object");let t;for(let r in e)if(e[r]){let i=e[r].typeString,s="value"in e[r]?{value:e[r].value}:void 0;if(!(r in n)){t=`JSON missing required field: '${r}'`;break}let o=n[r];if(i&&typeof o!==i){t=`JSON field '${r}' must be a ${i}.`;break}if(s!==void 0&&o!==s.value){t=`Expected '${r}' field to equal '${s.value}'`;break}}if(t)throw new D(P.INVALID_ARGUMENT,t);return!0}var nm=-62135596800,rm=1e6,se=class n{static now(){return n.fromMillis(Date.now())}static fromDate(e){return n.fromMillis(e.getTime())}static fromMillis(e){let t=Math.floor(e/1e3),r=Math.floor((e-1e3*t)*rm);return new n(t,r)}constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new D(P.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new D(P.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<nm)throw new D(P.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new D(P.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/rm}_compareTo(e){return this.seconds===e.seconds?z(this.nanoseconds,e.nanoseconds):z(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:n._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(ns(e,n._jsonSchema))return new n(e.seconds,e.nanoseconds)}valueOf(){let e=this.seconds-nm;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}};se._jsonSchemaVersion="firestore/timestamp/1.0",se._jsonSchema={type:de("string",se._jsonSchemaVersion),seconds:de("number"),nanoseconds:de("number")};var B=class n{static fromTimestamp(e){return new n(e)}static min(){return new n(new se(0,0))}static max(){return new n(new se(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}};var Li=-1,_r=class{constructor(e,t,r,i){this.indexId=e,this.collectionGroup=t,this.fields=r,this.indexState=i}};function $u(n){return n.fields.find((e=>e.kind===2))}function yn(n){return n.fields.filter((e=>e.kind!==2))}_r.UNKNOWN_ID=-1;var dr=class{constructor(e,t){this.fieldPath=e,this.kind=t}};var Mi=class n{constructor(e,t){this.sequenceNumber=e,this.offset=t}static empty(){return new n(0,Ge.min())}};function nT(n,e){let t=n.toTimestamp().seconds,r=n.toTimestamp().nanoseconds+1,i=B.fromTimestamp(r===1e9?new se(t+1,0):new se(t,r));return new Ge(i,x.empty(),e)}function fg(n){return new Ge(n.readTime,n.key,Li)}var Ge=class n{constructor(e,t,r){this.readTime=e,this.documentKey=t,this.largestBatchId=r}static min(){return new n(B.min(),x.empty(),Li)}static max(){return new n(B.max(),x.empty(),Li)}};function xh(n,e){let t=n.readTime.compareTo(e.readTime);return t!==0?t:(t=x.comparator(n.documentKey,e.documentKey),t!==0?t:z(n.largestBatchId,e.largestBatchId))}var pg="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.",Lo=class{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach((e=>e()))}};async function qn(n){if(n.code!==P.FAILED_PRECONDITION||n.message!==pg)throw n;C("LocalStore","Unexpectedly lost primary lease")}var b=class n{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e((t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)}),(t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)}))}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&L(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new n(((r,i)=>{this.nextCallback=s=>{this.wrapSuccess(e,s).next(r,i)},this.catchCallback=s=>{this.wrapFailure(t,s).next(r,i)}}))}toPromise(){return new Promise(((e,t)=>{this.next(e,t)}))}wrapUserFunction(e){try{let t=e();return t instanceof n?t:n.resolve(t)}catch(t){return n.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction((()=>e(t))):n.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction((()=>e(t))):n.reject(t)}static resolve(e){return new n(((t,r)=>{t(e)}))}static reject(e){return new n(((t,r)=>{r(e)}))}static waitFor(e){return new n(((t,r)=>{let i=0,s=0,o=!1;e.forEach((c=>{++i,c.next((()=>{++s,o&&s===i&&t()}),(u=>r(u)))})),o=!0,s===i&&t()}))}static or(e){let t=n.resolve(!1);for(let r of e)t=t.next((i=>i?n.resolve(i):r()));return t}static forEach(e,t){let r=[];return e.forEach(((i,s)=>{r.push(t.call(this,i,s))})),this.waitFor(r)}static mapArray(e,t){return new n(((r,i)=>{let s=e.length,o=new Array(s),c=0;for(let u=0;u<s;u++){let h=u;t(e[h]).next((f=>{o[h]=f,++c,c===s&&r(o)}),(f=>i(f)))}}))}static doWhile(e,t){return new n(((r,i)=>{let s=()=>{e()===!0?t().next((()=>{s()}),i):r()};s()}))}};var Me="SimpleDb",Mo=class n{static open(e,t,r,i){try{return new n(t,e.transaction(i,r))}catch(s){throw new Rn(t,s)}}constructor(e,t){this.action=e,this.transaction=t,this.aborted=!1,this.S=new je,this.transaction.oncomplete=()=>{this.S.resolve()},this.transaction.onabort=()=>{t.error?this.S.reject(new Rn(e,t.error)):this.S.resolve()},this.transaction.onerror=r=>{let i=Lh(r.target.error);this.S.reject(new Rn(e,i))}}get D(){return this.S.promise}abort(e){e&&this.S.reject(e),this.aborted||(C(Me,"Aborting transaction:",e?e.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())}C(){let e=this.transaction;this.aborted||typeof e.commit!="function"||e.commit()}store(e){let t=this.transaction.objectStore(e);return new Wu(t)}},yr=class n{static delete(e){return C(Me,"Removing database:",e),wn(Tc().indexedDB.deleteDatabase(e)).toPromise()}static v(){if(!Ds())return!1;if(n.F())return!0;let e=ue(),t=n.M(e),r=0<t&&t<10,i=mg(e),s=0<i&&i<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||r||s)}static F(){return typeof process<"u"&&process.__PRIVATE_env?.__PRIVATE_USE_MOCK_PERSISTENCE==="YES"}static O(e,t){return e.store(t)}static M(e){let t=e.match(/i(?:phone|pad|pod) os ([\d_]+)/i),r=t?t[1].split("_").slice(0,2).join("."):"-1";return Number(r)}constructor(e,t,r){this.name=e,this.version=t,this.N=r,this.B=null,n.M(ue())===12.2&&Pe("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}async L(e){return this.db||(C(Me,"Opening database:",this.name),this.db=await new Promise(((t,r)=>{let i=indexedDB.open(this.name,this.version);i.onsuccess=s=>{let o=s.target.result;t(o)},i.onblocked=()=>{r(new Rn(e,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},i.onerror=s=>{let o=s.target.error;o.name==="VersionError"?r(new D(P.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):o.name==="InvalidStateError"?r(new D(P.FAILED_PRECONDITION,"Unable to open an IndexedDB connection. This could be due to running in a private browsing session on a browser whose private browsing sessions do not support IndexedDB: "+o)):r(new Rn(e,o))},i.onupgradeneeded=s=>{C(Me,'Database "'+this.name+'" requires upgrade from version:',s.oldVersion);let o=s.target.result;this.N.k(o,i.transaction,s.oldVersion,this.version).next((()=>{C(Me,"Database upgrade to version "+this.version+" complete")}))}}))),this.q&&(this.db.onversionchange=t=>this.q(t)),this.db}$(e){this.q=e,this.db&&(this.db.onversionchange=t=>e(t))}async runTransaction(e,t,r,i){let s=t==="readonly",o=0;for(;;){++o;try{this.db=await this.L(e);let c=Mo.open(this.db,e,s?"readonly":"readwrite",r),u=i(c).next((h=>(c.C(),h))).catch((h=>(c.abort(h),b.reject(h)))).toPromise();return u.catch((()=>{})),await c.D,u}catch(c){let u=c,h=u.name!=="FirebaseError"&&o<3;if(C(Me,"Transaction failed with error:",u.message,"Retrying:",h),this.close(),!h)return Promise.reject(u)}}}close(){this.db&&this.db.close(),this.db=void 0}};function mg(n){let e=n.match(/Android ([\d.]+)/i),t=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(t)}var Ku=class{constructor(e){this.U=e,this.K=!1,this.W=null}get isDone(){return this.K}get G(){return this.W}set cursor(e){this.U=e}done(){this.K=!0}j(e){this.W=e}delete(){return wn(this.U.delete())}},Rn=class extends D{constructor(e,t){super(P.UNAVAILABLE,`IndexedDB transaction '${e}' failed: ${t}`),this.name="IndexedDbTransactionError"}};function tn(n){return n.name==="IndexedDbTransactionError"}var Wu=class{constructor(e){this.store=e}put(e,t){let r;return t!==void 0?(C(Me,"PUT",this.store.name,e,t),r=this.store.put(t,e)):(C(Me,"PUT",this.store.name,"<auto-key>",e),r=this.store.put(e)),wn(r)}add(e){return C(Me,"ADD",this.store.name,e,e),wn(this.store.add(e))}get(e){return wn(this.store.get(e)).next((t=>(t===void 0&&(t=null),C(Me,"GET",this.store.name,e,t),t)))}delete(e){return C(Me,"DELETE",this.store.name,e),wn(this.store.delete(e))}count(){return C(Me,"COUNT",this.store.name),wn(this.store.count())}J(e,t){let r=this.options(e,t),i=r.index?this.store.index(r.index):this.store;if(typeof i.getAll=="function"){let s=i.getAll(r.range);return new b(((o,c)=>{s.onerror=u=>{c(u.target.error)},s.onsuccess=u=>{o(u.target.result)}}))}{let s=this.cursor(r),o=[];return this.H(s,((c,u)=>{o.push(u)})).next((()=>o))}}Y(e,t){let r=this.store.getAll(e,t===null?void 0:t);return new b(((i,s)=>{r.onerror=o=>{s(o.target.error)},r.onsuccess=o=>{i(o.target.result)}}))}Z(e,t){C(Me,"DELETE ALL",this.store.name);let r=this.options(e,t);r.X=!1;let i=this.cursor(r);return this.H(i,((s,o,c)=>c.delete()))}ee(e,t){let r;t?r=e:(r={},t=e);let i=this.cursor(r);return this.H(i,t)}te(e){let t=this.cursor({});return new b(((r,i)=>{t.onerror=s=>{let o=Lh(s.target.error);i(o)},t.onsuccess=s=>{let o=s.target.result;o?e(o.primaryKey,o.value).next((c=>{c?o.continue():r()})):r()}}))}H(e,t){let r=[];return new b(((i,s)=>{e.onerror=o=>{s(o.target.error)},e.onsuccess=o=>{let c=o.target.result;if(!c)return void i();let u=new Ku(c),h=t(c.primaryKey,c.value,u);if(h instanceof b){let f=h.catch((m=>(u.done(),b.reject(m))));r.push(f)}u.isDone?i():u.G===null?c.continue():c.continue(u.G)}})).next((()=>b.waitFor(r)))}options(e,t){let r;return e!==void 0&&(typeof e=="string"?r=e:t=e),{index:r,range:t}}cursor(e){let t="next";if(e.reverse&&(t="prev"),e.index){let r=this.store.index(e.index);return e.X?r.openKeyCursor(e.range,t):r.openCursor(e.range,t)}return this.store.openCursor(e.range,t)}};function wn(n){return new b(((e,t)=>{n.onsuccess=r=>{let i=r.target.result;e(i)},n.onerror=r=>{let i=Lh(r.target.error);t(i)}}))}var im=!1;function Lh(n){let e=yr.M(ue());if(e>=12.2&&e<13){let t="An internal error was encountered in the Indexed Database server";if(n.message.indexOf(t)>=0){let r=new D("internal",`IOS_INDEXEDDB_BUG1: IndexedDb has thrown '${t}'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.`);return im||(im=!0,setTimeout((()=>{throw r}),0)),r}}return n}var Pi="IndexBackfiller",Hu=class{constructor(e,t){this.asyncQueue=e,this.ne=t,this.task=null}start(){this.re(15e3)}stop(){this.task&&(this.task.cancel(),this.task=null)}get started(){return this.task!==null}re(e){C(Pi,`Scheduled in ${e}ms`),this.task=this.asyncQueue.enqueueAfterDelay("index_backfill",e,(async()=>{this.task=null;try{let t=await this.ne.ie();C(Pi,`Documents written: ${t}`)}catch(t){tn(t)?C(Pi,"Ignoring IndexedDB error during index backfill: ",t):await qn(t)}await this.re(6e4)}))}},Qu=class{constructor(e,t){this.localStore=e,this.persistence=t}async ie(e=50){return this.persistence.runTransaction("Backfill Indexes","readwrite-primary",(t=>this.se(t,e)))}se(e,t){let r=new Set,i=t,s=!0;return b.doWhile((()=>s===!0&&i>0),(()=>this.localStore.indexManager.getNextCollectionGroupToUpdate(e).next((o=>{if(o!==null&&!r.has(o))return C(Pi,`Processing collection: ${o}`),this.oe(e,o,i).next((c=>{i-=c,r.add(o)}));s=!1})))).next((()=>t-i))}oe(e,t,r){return this.localStore.indexManager.getMinOffsetFromCollectionGroup(e,t).next((i=>this.localStore.localDocuments.getNextDocuments(e,t,i,r).next((s=>{let o=s.changes;return this.localStore.indexManager.updateIndexEntries(e,o).next((()=>this._e(i,s))).next((c=>(C(Pi,`Updating offset: ${c}`),this.localStore.indexManager.updateCollectionGroup(e,t,c)))).next((()=>o.size))}))))}_e(e,t){let r=e;return t.changes.forEach(((i,s)=>{let o=fg(s);xh(o,r)>0&&(r=o)})),new Ge(r.readTime,r.documentKey,Math.max(t.batchId,e.largestBatchId))}};var Ve=class{constructor(e,t){this.previousValue=e,t&&(t.sequenceNumberHandler=r=>this.ae(r),this.ue=r=>t.writeSequenceNumber(r))}ae(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){let e=++this.previousValue;return this.ue&&this.ue(e),e}};Ve.ce=-1;var Pn=-1;function La(n){return n==null}function Fi(n){return n===0&&1/n==-1/0}function rT(n){return typeof n=="number"&&Number.isInteger(n)&&!Fi(n)&&n<=Number.MAX_SAFE_INTEGER&&n>=Number.MIN_SAFE_INTEGER}var Fo="";function be(n){let e="";for(let t=0;t<n.length;t++)e.length>0&&(e=sm(e)),e=iT(n.get(t),e);return sm(e)}function iT(n,e){let t=e,r=n.length;for(let i=0;i<r;i++){let s=n.charAt(i);switch(s){case"\0":t+="";break;case Fo:t+="";break;default:t+=s}}return t}function sm(n){return n+Fo+""}function it(n){let e=n.length;if(F(e>=2,64408,{path:n}),e===2)return F(n.charAt(0)===Fo&&n.charAt(1)==="",56145,{path:n}),X.emptyPath();let t=e-2,r=[],i="";for(let s=0;s<e;){let o=n.indexOf(Fo,s);switch((o<0||o>t)&&L(50515,{path:n}),n.charAt(o+1)){case"":let c=n.substring(s,o),u;i.length===0?u=c:(i+=c,u=i,i=""),r.push(u);break;case"":i+=n.substring(s,o),i+="\0";break;case"":i+=n.substring(s,o+1);break;default:L(61167,{path:n})}s=o+2}return new X(r)}var In="remoteDocuments",rs="owner",er="owner",Ui="mutationQueues",sT="userId",We="mutations",om="batchId",An="userMutationsIndex",am=["userId","batchId"];function bo(n,e){return[n,be(e)]}function gg(n,e,t){return[n,be(e),t]}var oT={},Ir="documentMutations",Uo="remoteDocumentsV14",aT=["prefixPath","collectionGroup","readTime","documentId"],So="documentKeyIndex",cT=["prefixPath","collectionGroup","documentId"],_g="collectionGroupIndex",uT=["collectionGroup","readTime","prefixPath","documentId"],Bi="remoteDocumentGlobal",Ju="remoteDocumentGlobalKey",wr="targets",yg="queryTargetsIndex",lT=["canonicalId","targetId"],Er="targetDocuments",hT=["targetId","path"],Mh="documentTargetsIndex",dT=["path","targetId"],Bo="targetGlobalKey",Cn="targetGlobal",qi="collectionParents",fT=["collectionId","parent"],Tr="clientMetadata",pT="clientId",Ma="bundles",mT="bundleId",Fa="namedQueries",gT="name",Fh="indexConfiguration",_T="indexId",Yu="collectionGroupIndex",yT="collectionGroup",Ci="indexState",IT=["indexId","uid"],Ig="sequenceNumberIndex",wT=["uid","sequenceNumber"],Ni="indexEntries",ET=["indexId","uid","arrayValue","directionalValue","orderedDocumentKey","documentKey"],wg="documentKeyIndex",TT=["indexId","uid","orderedDocumentKey"],Ua="documentOverlays",vT=["userId","collectionPath","documentId"],Xu="collectionPathOverlayIndex",AT=["userId","collectionPath","largestBatchId"],Eg="collectionGroupOverlayIndex",bT=["userId","collectionGroup","largestBatchId"],Uh="globals",ST="name",Tg=[Ui,We,Ir,In,wr,rs,Cn,Er,Tr,Bi,qi,Ma,Fa],RT=[...Tg,Ua],vg=[Ui,We,Ir,Uo,wr,rs,Cn,Er,Tr,Bi,qi,Ma,Fa,Ua],Ag=vg,Bh=[...Ag,Fh,Ci,Ni],PT=Bh,bg=[...Bh,Uh],CT=bg;var ji=class extends Lo{constructor(e,t){super(),this.le=e,this.currentSequenceNumber=t}};function ye(n,e){let t=G(n);return yr.O(t.le,e)}function cm(n){let e=0;for(let t in n)Object.prototype.hasOwnProperty.call(n,t)&&e++;return e}function nn(n,e){for(let t in n)Object.prototype.hasOwnProperty.call(n,t)&&e(t,n[t])}function Sg(n){for(let e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}var oe=class n{constructor(e,t){this.comparator=e,this.root=t||ot.EMPTY}insert(e,t){return new n(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,ot.BLACK,null,null))}remove(e){return new n(this.comparator,this.root.remove(e,this.comparator).copy(null,null,ot.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){let r=this.comparator(e,t.key);if(r===0)return t.value;r<0?t=t.left:r>0&&(t=t.right)}return null}indexOf(e){let t=0,r=this.root;for(;!r.isEmpty();){let i=this.comparator(e,r.key);if(i===0)return t+r.left.size;i<0?r=r.left:(t+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal(((t,r)=>(e(t,r),!1)))}toString(){let e=[];return this.inorderTraversal(((t,r)=>(e.push(`${t}:${r}`),!1))),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new hr(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new hr(this.root,e,this.comparator,!1)}getReverseIterator(){return new hr(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new hr(this.root,e,this.comparator,!0)}},hr=class{constructor(e,t,r,i){this.isReverse=i,this.nodeStack=[];let s=1;for(;!e.isEmpty();)if(s=t?r(e.key,t):1,t&&i&&(s*=-1),s<0)e=this.isReverse?e.left:e.right;else{if(s===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop(),t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;let e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}},ot=class n{constructor(e,t,r,i,s){this.key=e,this.value=t,this.color=r??n.RED,this.left=i??n.EMPTY,this.right=s??n.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,r,i,s){return new n(e??this.key,t??this.value,r??this.color,i??this.left,s??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,r){let i=this,s=r(e,i.key);return i=s<0?i.copy(null,null,null,i.left.insert(e,t,r),null):s===0?i.copy(null,t,null,null,null):i.copy(null,null,null,null,i.right.insert(e,t,r)),i.fixUp()}removeMin(){if(this.left.isEmpty())return n.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let r,i=this;if(t(e,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(e,t),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),t(e,i.key)===0){if(i.right.isEmpty())return n.EMPTY;r=i.right.min(),i=i.copy(r.key,r.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(e,t))}return i.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){let e=this.copy(null,null,n.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){let e=this.copy(null,null,n.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){let e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){let e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw L(43730,{key:this.key,value:this.value});if(this.right.isRed())throw L(14113,{key:this.key,value:this.value});let e=this.left.check();if(e!==this.right.check())throw L(27949);return e+(this.isRed()?0:1)}};ot.EMPTY=null,ot.RED=!0,ot.BLACK=!1;ot.EMPTY=new class{constructor(){this.size=0}get key(){throw L(57766)}get value(){throw L(16141)}get color(){throw L(16727)}get left(){throw L(29726)}get right(){throw L(36894)}copy(e,t,r,i,s){return this}insert(e,t,r){return new ot(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};var te=class n{constructor(e){this.comparator=e,this.data=new oe(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal(((t,r)=>(e(t),!1)))}forEachInRange(e,t){let r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){let i=r.getNext();if(this.comparator(i.key,e[1])>=0)return;t(i.key)}}forEachWhile(e,t){let r;for(r=t!==void 0?this.data.getIteratorFrom(t):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){let t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new qo(this.data.getIterator())}getIteratorFrom(e){return new qo(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach((r=>{t=t.add(r)})),t}isEqual(e){if(!(e instanceof n)||this.size!==e.size)return!1;let t=this.data.getIterator(),r=e.data.getIterator();for(;t.hasNext();){let i=t.getNext().key,s=r.getNext().key;if(this.comparator(i,s)!==0)return!1}return!0}toArray(){let e=[];return this.forEach((t=>{e.push(t)})),e}toString(){let e=[];return this.forEach((t=>e.push(t))),"SortedSet("+e.toString()+")"}copy(e){let t=new n(this.comparator);return t.data=e,t}},qo=class{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}};function tr(n){return n.hasNext()?n.getNext():void 0}var Fe=class n{constructor(e){this.fields=e,e.sort(ge.comparator)}static empty(){return new n([])}unionWith(e){let t=new te(ge.comparator);for(let r of this.fields)t=t.add(r);for(let r of e)t=t.add(r);return new n(t.toArray())}covers(e){for(let t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return gr(this.fields,e.fields,((t,r)=>t.isEqual(r)))}};var jo=class extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}};var _e=class n{constructor(e){this.binaryString=e}static fromBase64String(e){let t=(function(i){try{return atob(i)}catch(s){throw typeof DOMException<"u"&&s instanceof DOMException?new jo("Invalid base64 string: "+s):s}})(e);return new n(t)}static fromUint8Array(e){let t=(function(i){let s="";for(let o=0;o<i.length;++o)s+=String.fromCharCode(i[o]);return s})(e);return new n(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return(function(t){return btoa(t)})(this.binaryString)}toUint8Array(){return(function(t){let r=new Uint8Array(t.length);for(let i=0;i<t.length;i++)r[i]=t.charCodeAt(i);return r})(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return z(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}};_e.EMPTY_BYTE_STRING=new _e("");var NT=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function _t(n){if(F(!!n,39018),typeof n=="string"){let e=0,t=NT.exec(n);if(F(!!t,46558,{timestamp:n}),t[1]){let i=t[1];i=(i+"000000000").substr(0,9),e=Number(i)}let r=new Date(n);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:ie(n.seconds),nanos:ie(n.nanos)}}function ie(n){return typeof n=="number"?n:typeof n=="string"?Number(n):0}function yt(n){return typeof n=="string"?_e.fromBase64String(n):_e.fromUint8Array(n)}var Rg="server_timestamp",Pg="__type__",Cg="__previous_value__",Ng="__local_write_time__";function qh(n){return(n?.mapValue?.fields||{})[Pg]?.stringValue===Rg}function Ba(n){let e=n.mapValue.fields[Cg];return qh(e)?Ba(e):e}function zi(n){let e=_t(n.mapValue.fields[Ng].timestampValue);return new se(e.seconds,e.nanos)}var Zu=class{constructor(e,t,r,i,s,o,c,u,h,f){this.databaseId=e,this.appId=t,this.persistenceKey=r,this.host=i,this.ssl=s,this.forceLongPolling=o,this.autoDetectLongPolling=c,this.longPollingOptions=u,this.useFetchStreams=h,this.isUsingEmulator=f}},zo="(default)",vr=class n{constructor(e,t){this.projectId=e,this.database=t||zo}static empty(){return new n("","")}get isDefaultDatabase(){return this.database===zo}isEqual(e){return e instanceof n&&e.projectId===this.projectId&&e.database===this.database}};var jh="__type__",kg="__max__",Ut={mapValue:{fields:{__type__:{stringValue:kg}}}},zh="__vector__",Ar="value",Ro={nullValue:"NULL_VALUE"};function Gt(n){return"nullValue"in n?0:"booleanValue"in n?1:"integerValue"in n||"doubleValue"in n?2:"timestampValue"in n?3:"stringValue"in n?5:"bytesValue"in n?6:"referenceValue"in n?7:"geoPointValue"in n?8:"arrayValue"in n?9:"mapValue"in n?qh(n)?4:Dg(n)?9007199254740991:qa(n)?10:11:L(28295,{value:n})}function at(n,e){if(n===e)return!0;let t=Gt(n);if(t!==Gt(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return n.booleanValue===e.booleanValue;case 4:return zi(n).isEqual(zi(e));case 3:return(function(i,s){if(typeof i.timestampValue=="string"&&typeof s.timestampValue=="string"&&i.timestampValue.length===s.timestampValue.length)return i.timestampValue===s.timestampValue;let o=_t(i.timestampValue),c=_t(s.timestampValue);return o.seconds===c.seconds&&o.nanos===c.nanos})(n,e);case 5:return n.stringValue===e.stringValue;case 6:return(function(i,s){return yt(i.bytesValue).isEqual(yt(s.bytesValue))})(n,e);case 7:return n.referenceValue===e.referenceValue;case 8:return(function(i,s){return ie(i.geoPointValue.latitude)===ie(s.geoPointValue.latitude)&&ie(i.geoPointValue.longitude)===ie(s.geoPointValue.longitude)})(n,e);case 2:return(function(i,s){if("integerValue"in i&&"integerValue"in s)return ie(i.integerValue)===ie(s.integerValue);if("doubleValue"in i&&"doubleValue"in s){let o=ie(i.doubleValue),c=ie(s.doubleValue);return o===c?Fi(o)===Fi(c):isNaN(o)&&isNaN(c)}return!1})(n,e);case 9:return gr(n.arrayValue.values||[],e.arrayValue.values||[],at);case 10:case 11:return(function(i,s){let o=i.mapValue.fields||{},c=s.mapValue.fields||{};if(cm(o)!==cm(c))return!1;for(let u in o)if(o.hasOwnProperty(u)&&(c[u]===void 0||!at(o[u],c[u])))return!1;return!0})(n,e);default:return L(52216,{left:n})}}function Gi(n,e){return(n.values||[]).find((t=>at(t,e)))!==void 0}function $t(n,e){if(n===e)return 0;let t=Gt(n),r=Gt(e);if(t!==r)return z(t,r);switch(t){case 0:case 9007199254740991:return 0;case 1:return z(n.booleanValue,e.booleanValue);case 2:return(function(s,o){let c=ie(s.integerValue||s.doubleValue),u=ie(o.integerValue||o.doubleValue);return c<u?-1:c>u?1:c===u?0:isNaN(c)?isNaN(u)?0:-1:1})(n,e);case 3:return um(n.timestampValue,e.timestampValue);case 4:return um(zi(n),zi(e));case 5:return Gu(n.stringValue,e.stringValue);case 6:return(function(s,o){let c=yt(s),u=yt(o);return c.compareTo(u)})(n.bytesValue,e.bytesValue);case 7:return(function(s,o){let c=s.split("/"),u=o.split("/");for(let h=0;h<c.length&&h<u.length;h++){let f=z(c[h],u[h]);if(f!==0)return f}return z(c.length,u.length)})(n.referenceValue,e.referenceValue);case 8:return(function(s,o){let c=z(ie(s.latitude),ie(o.latitude));return c!==0?c:z(ie(s.longitude),ie(o.longitude))})(n.geoPointValue,e.geoPointValue);case 9:return lm(n.arrayValue,e.arrayValue);case 10:return(function(s,o){let c=s.fields||{},u=o.fields||{},h=c[Ar]?.arrayValue,f=u[Ar]?.arrayValue,m=z(h?.values?.length||0,f?.values?.length||0);return m!==0?m:lm(h,f)})(n.mapValue,e.mapValue);case 11:return(function(s,o){if(s===Ut.mapValue&&o===Ut.mapValue)return 0;if(s===Ut.mapValue)return 1;if(o===Ut.mapValue)return-1;let c=s.fields||{},u=Object.keys(c),h=o.fields||{},f=Object.keys(h);u.sort(),f.sort();for(let m=0;m<u.length&&m<f.length;++m){let _=Gu(u[m],f[m]);if(_!==0)return _;let R=$t(c[u[m]],h[f[m]]);if(R!==0)return R}return z(u.length,f.length)})(n.mapValue,e.mapValue);default:throw L(23264,{he:t})}}function um(n,e){if(typeof n=="string"&&typeof e=="string"&&n.length===e.length)return z(n,e);let t=_t(n),r=_t(e),i=z(t.seconds,r.seconds);return i!==0?i:z(t.nanos,r.nanos)}function lm(n,e){let t=n.values||[],r=e.values||[];for(let i=0;i<t.length&&i<r.length;++i){let s=$t(t[i],r[i]);if(s)return s}return z(t.length,r.length)}function br(n){return el(n)}function el(n){return"nullValue"in n?"null":"booleanValue"in n?""+n.booleanValue:"integerValue"in n?""+n.integerValue:"doubleValue"in n?""+n.doubleValue:"timestampValue"in n?(function(t){let r=_t(t);return`time(${r.seconds},${r.nanos})`})(n.timestampValue):"stringValue"in n?n.stringValue:"bytesValue"in n?(function(t){return yt(t).toBase64()})(n.bytesValue):"referenceValue"in n?(function(t){return x.fromName(t).toString()})(n.referenceValue):"geoPointValue"in n?(function(t){return`geo(${t.latitude},${t.longitude})`})(n.geoPointValue):"arrayValue"in n?(function(t){let r="[",i=!0;for(let s of t.values||[])i?i=!1:r+=",",r+=el(s);return r+"]"})(n.arrayValue):"mapValue"in n?(function(t){let r=Object.keys(t.fields||{}).sort(),i="{",s=!0;for(let o of r)s?s=!1:i+=",",i+=`${o}:${el(t.fields[o])}`;return i+"}"})(n.mapValue):L(61005,{value:n})}function Po(n){switch(Gt(n)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:let e=Ba(n);return e?16+Po(e):16;case 5:return 2*n.stringValue.length;case 6:return yt(n.bytesValue).approximateByteSize();case 7:return n.referenceValue.length;case 9:return(function(r){return(r.values||[]).reduce(((i,s)=>i+Po(s)),0)})(n.arrayValue);case 10:case 11:return(function(r){let i=0;return nn(r.fields,((s,o)=>{i+=s.length+Po(o)})),i})(n.mapValue);default:throw L(13486,{value:n})}}function $i(n,e){return{referenceValue:`projects/${n.projectId}/databases/${n.database}/documents/${e.path.canonicalString()}`}}function tl(n){return!!n&&"integerValue"in n}function Ki(n){return!!n&&"arrayValue"in n}function hm(n){return!!n&&"nullValue"in n}function dm(n){return!!n&&"doubleValue"in n&&isNaN(Number(n.doubleValue))}function Co(n){return!!n&&"mapValue"in n}function qa(n){return(n?.mapValue?.fields||{})[jh]?.stringValue===zh}function ki(n){if(n.geoPointValue)return{geoPointValue:{...n.geoPointValue}};if(n.timestampValue&&typeof n.timestampValue=="object")return{timestampValue:{...n.timestampValue}};if(n.mapValue){let e={mapValue:{fields:{}}};return nn(n.mapValue.fields,((t,r)=>e.mapValue.fields[t]=ki(r))),e}if(n.arrayValue){let e={arrayValue:{values:[]}};for(let t=0;t<(n.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=ki(n.arrayValue.values[t]);return e}return{...n}}function Dg(n){return(((n.mapValue||{}).fields||{}).__type__||{}).stringValue===kg}var Og={mapValue:{fields:{[jh]:{stringValue:zh},[Ar]:{arrayValue:{}}}}};function kT(n){return"nullValue"in n?Ro:"booleanValue"in n?{booleanValue:!1}:"integerValue"in n||"doubleValue"in n?{doubleValue:NaN}:"timestampValue"in n?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"stringValue"in n?{stringValue:""}:"bytesValue"in n?{bytesValue:""}:"referenceValue"in n?$i(vr.empty(),x.empty()):"geoPointValue"in n?{geoPointValue:{latitude:-90,longitude:-180}}:"arrayValue"in n?{arrayValue:{}}:"mapValue"in n?qa(n)?Og:{mapValue:{}}:L(35942,{value:n})}function DT(n){return"nullValue"in n?{booleanValue:!1}:"booleanValue"in n?{doubleValue:NaN}:"integerValue"in n||"doubleValue"in n?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"timestampValue"in n?{stringValue:""}:"stringValue"in n?{bytesValue:""}:"bytesValue"in n?$i(vr.empty(),x.empty()):"referenceValue"in n?{geoPointValue:{latitude:-90,longitude:-180}}:"geoPointValue"in n?{arrayValue:{}}:"arrayValue"in n?Og:"mapValue"in n?qa(n)?{mapValue:{}}:Ut:L(61959,{value:n})}function fm(n,e){let t=$t(n.value,e.value);return t!==0?t:n.inclusive&&!e.inclusive?-1:!n.inclusive&&e.inclusive?1:0}function pm(n,e){let t=$t(n.value,e.value);return t!==0?t:n.inclusive&&!e.inclusive?1:!n.inclusive&&e.inclusive?-1:0}var Ce=class n{constructor(e){this.value=e}static empty(){return new n({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let r=0;r<e.length-1;++r)if(t=(t.mapValue.fields||{})[e.get(r)],!Co(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=ki(t)}setAll(e){let t=ge.emptyPath(),r={},i=[];e.forEach(((o,c)=>{if(!t.isImmediateParentOf(c)){let u=this.getFieldsMap(t);this.applyChanges(u,r,i),r={},i=[],t=c.popLast()}o?r[c.lastSegment()]=ki(o):i.push(c.lastSegment())}));let s=this.getFieldsMap(t);this.applyChanges(s,r,i)}delete(e){let t=this.field(e.popLast());Co(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return at(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let r=0;r<e.length;++r){let i=t.mapValue.fields[e.get(r)];Co(i)&&i.mapValue.fields||(i={mapValue:{fields:{}}},t.mapValue.fields[e.get(r)]=i),t=i}return t.mapValue.fields}applyChanges(e,t,r){nn(t,((i,s)=>e[i]=s));for(let i of r)delete e[i]}clone(){return new n(ki(this.value))}};function Vg(n){let e=[];return nn(n.fields,((t,r)=>{let i=new ge([t]);if(Co(r)){let s=Vg(r.mapValue).fields;if(s.length===0)e.push(i);else for(let o of s)e.push(i.child(o))}else e.push(i)})),new Fe(e)}var Ee=class n{constructor(e,t,r,i,s,o,c){this.key=e,this.documentType=t,this.version=r,this.readTime=i,this.createTime=s,this.data=o,this.documentState=c}static newInvalidDocument(e){return new n(e,0,B.min(),B.min(),B.min(),Ce.empty(),0)}static newFoundDocument(e,t,r,i){return new n(e,1,t,B.min(),r,i,0)}static newNoDocument(e,t){return new n(e,2,t,B.min(),B.min(),Ce.empty(),0)}static newUnknownDocument(e,t){return new n(e,3,t,B.min(),B.min(),Ce.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(B.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=Ce.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=Ce.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=B.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof n&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new n(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}};var Kt=class{constructor(e,t){this.position=e,this.inclusive=t}};function mm(n,e,t){let r=0;for(let i=0;i<n.position.length;i++){let s=e[i],o=n.position[i];if(s.field.isKeyField()?r=x.comparator(x.fromName(o.referenceValue),t.key):r=$t(o,t.data.field(s.field)),s.dir==="desc"&&(r*=-1),r!==0)break}return r}function gm(n,e){if(n===null)return e===null;if(e===null||n.inclusive!==e.inclusive||n.position.length!==e.position.length)return!1;for(let t=0;t<n.position.length;t++)if(!at(n.position[t],e.position[t]))return!1;return!0}var Vn=class{constructor(e,t="asc"){this.field=e,this.dir=t}};function OT(n,e){return n.dir===e.dir&&n.field.isEqual(e.field)}var Go=class{},H=class n extends Go{constructor(e,t,r){super(),this.field=e,this.op=t,this.value=r}static create(e,t,r){return e.isKeyField()?t==="in"||t==="not-in"?this.createKeyFieldInFilter(e,t,r):new il(e,t,r):t==="array-contains"?new al(e,r):t==="in"?new $o(e,r):t==="not-in"?new cl(e,r):t==="array-contains-any"?new ul(e,r):new n(e,t,r)}static createKeyFieldInFilter(e,t,r){return t==="in"?new sl(e,r):new ol(e,r)}matches(e){let t=e.data.field(this.field);return this.op==="!="?t!==null&&t.nullValue===void 0&&this.matchesComparison($t(t,this.value)):t!==null&&Gt(this.value)===Gt(t)&&this.matchesComparison($t(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return L(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}},Z=class n extends Go{constructor(e,t){super(),this.filters=e,this.op=t,this.Pe=null}static create(e,t){return new n(e,t)}matches(e){return Sr(this)?this.filters.find((t=>!t.matches(e)))===void 0:this.filters.find((t=>t.matches(e)))!==void 0}getFlattenedFilters(){return this.Pe!==null||(this.Pe=this.filters.reduce(((e,t)=>e.concat(t.getFlattenedFilters())),[])),this.Pe}getFilters(){return Object.assign([],this.filters)}};function Sr(n){return n.op==="and"}function nl(n){return n.op==="or"}function Gh(n){return xg(n)&&Sr(n)}function xg(n){for(let e of n.filters)if(e instanceof Z)return!1;return!0}function rl(n){if(n instanceof H)return n.field.canonicalString()+n.op.toString()+br(n.value);if(Gh(n))return n.filters.map((e=>rl(e))).join(",");{let e=n.filters.map((t=>rl(t))).join(",");return`${n.op}(${e})`}}function Lg(n,e){return n instanceof H?(function(r,i){return i instanceof H&&r.op===i.op&&r.field.isEqual(i.field)&&at(r.value,i.value)})(n,e):n instanceof Z?(function(r,i){return i instanceof Z&&r.op===i.op&&r.filters.length===i.filters.length?r.filters.reduce(((s,o,c)=>s&&Lg(o,i.filters[c])),!0):!1})(n,e):void L(19439)}function Mg(n,e){let t=n.filters.concat(e);return Z.create(t,n.op)}function Fg(n){return n instanceof H?(function(t){return`${t.field.canonicalString()} ${t.op} ${br(t.value)}`})(n):n instanceof Z?(function(t){return t.op.toString()+" {"+t.getFilters().map(Fg).join(" ,")+"}"})(n):"Filter"}var il=class extends H{constructor(e,t,r){super(e,t,r),this.key=x.fromName(r.referenceValue)}matches(e){let t=x.comparator(e.key,this.key);return this.matchesComparison(t)}},sl=class extends H{constructor(e,t){super(e,"in",t),this.keys=Ug("in",t)}matches(e){return this.keys.some((t=>t.isEqual(e.key)))}},ol=class extends H{constructor(e,t){super(e,"not-in",t),this.keys=Ug("not-in",t)}matches(e){return!this.keys.some((t=>t.isEqual(e.key)))}};function Ug(n,e){return(e.arrayValue?.values||[]).map((t=>x.fromName(t.referenceValue)))}var al=class extends H{constructor(e,t){super(e,"array-contains",t)}matches(e){let t=e.data.field(this.field);return Ki(t)&&Gi(t.arrayValue,this.value)}},$o=class extends H{constructor(e,t){super(e,"in",t)}matches(e){let t=e.data.field(this.field);return t!==null&&Gi(this.value.arrayValue,t)}},cl=class extends H{constructor(e,t){super(e,"not-in",t)}matches(e){if(Gi(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;let t=e.data.field(this.field);return t!==null&&t.nullValue===void 0&&!Gi(this.value.arrayValue,t)}},ul=class extends H{constructor(e,t){super(e,"array-contains-any",t)}matches(e){let t=e.data.field(this.field);return!(!Ki(t)||!t.arrayValue.values)&&t.arrayValue.values.some((r=>Gi(this.value.arrayValue,r)))}};var ll=class{constructor(e,t=null,r=[],i=[],s=null,o=null,c=null){this.path=e,this.collectionGroup=t,this.orderBy=r,this.filters=i,this.limit=s,this.startAt=o,this.endAt=c,this.Te=null}};function hl(n,e=null,t=[],r=[],i=null,s=null,o=null){return new ll(n,e,t,r,i,s,o)}function xn(n){let e=G(n);if(e.Te===null){let t=e.path.canonicalString();e.collectionGroup!==null&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map((r=>rl(r))).join(","),t+="|ob:",t+=e.orderBy.map((r=>(function(s){return s.field.canonicalString()+s.dir})(r))).join(","),La(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map((r=>br(r))).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map((r=>br(r))).join(",")),e.Te=t}return e.Te}function is(n,e){if(n.limit!==e.limit||n.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<n.orderBy.length;t++)if(!OT(n.orderBy[t],e.orderBy[t]))return!1;if(n.filters.length!==e.filters.length)return!1;for(let t=0;t<n.filters.length;t++)if(!Lg(n.filters[t],e.filters[t]))return!1;return n.collectionGroup===e.collectionGroup&&!!n.path.isEqual(e.path)&&!!gm(n.startAt,e.startAt)&&gm(n.endAt,e.endAt)}function Ko(n){return x.isDocumentKey(n.path)&&n.collectionGroup===null&&n.filters.length===0}function Wo(n,e){return n.filters.filter((t=>t instanceof H&&t.field.isEqual(e)))}function _m(n,e,t){let r=Ro,i=!0;for(let s of Wo(n,e)){let o=Ro,c=!0;switch(s.op){case"<":case"<=":o=kT(s.value);break;case"==":case"in":case">=":o=s.value;break;case">":o=s.value,c=!1;break;case"!=":case"not-in":o=Ro}fm({value:r,inclusive:i},{value:o,inclusive:c})<0&&(r=o,i=c)}if(t!==null){for(let s=0;s<n.orderBy.length;++s)if(n.orderBy[s].field.isEqual(e)){let o=t.position[s];fm({value:r,inclusive:i},{value:o,inclusive:t.inclusive})<0&&(r=o,i=t.inclusive);break}}return{value:r,inclusive:i}}function ym(n,e,t){let r=Ut,i=!0;for(let s of Wo(n,e)){let o=Ut,c=!0;switch(s.op){case">=":case">":o=DT(s.value),c=!1;break;case"==":case"in":case"<=":o=s.value;break;case"<":o=s.value,c=!1;break;case"!=":case"not-in":o=Ut}pm({value:r,inclusive:i},{value:o,inclusive:c})>0&&(r=o,i=c)}if(t!==null){for(let s=0;s<n.orderBy.length;++s)if(n.orderBy[s].field.isEqual(e)){let o=t.position[s];pm({value:r,inclusive:i},{value:o,inclusive:t.inclusive})>0&&(r=o,i=t.inclusive);break}}return{value:r,inclusive:i}}var Wt=class{constructor(e,t=null,r=[],i=[],s=null,o="F",c=null,u=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=r,this.filters=i,this.limit=s,this.limitType=o,this.startAt=c,this.endAt=u,this.Ie=null,this.Ee=null,this.de=null,this.startAt,this.endAt}};function VT(n,e,t,r,i,s,o,c){return new Wt(n,e,t,r,i,s,o,c)}function ja(n){return new Wt(n)}function Im(n){return n.filters.length===0&&n.limit===null&&n.startAt==null&&n.endAt==null&&(n.explicitOrderBy.length===0||n.explicitOrderBy.length===1&&n.explicitOrderBy[0].field.isKeyField())}function Bg(n){return n.collectionGroup!==null}function Di(n){let e=G(n);if(e.Ie===null){e.Ie=[];let t=new Set;for(let s of e.explicitOrderBy)e.Ie.push(s),t.add(s.field.canonicalString());let r=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(o){let c=new te(ge.comparator);return o.filters.forEach((u=>{u.getFlattenedFilters().forEach((h=>{h.isInequality()&&(c=c.add(h.field))}))})),c})(e).forEach((s=>{t.has(s.canonicalString())||s.isKeyField()||e.Ie.push(new Vn(s,r))})),t.has(ge.keyField().canonicalString())||e.Ie.push(new Vn(ge.keyField(),r))}return e.Ie}function ze(n){let e=G(n);return e.Ee||(e.Ee=xT(e,Di(n))),e.Ee}function xT(n,e){if(n.limitType==="F")return hl(n.path,n.collectionGroup,e,n.filters,n.limit,n.startAt,n.endAt);{e=e.map((i=>{let s=i.dir==="desc"?"asc":"desc";return new Vn(i.field,s)}));let t=n.endAt?new Kt(n.endAt.position,n.endAt.inclusive):null,r=n.startAt?new Kt(n.startAt.position,n.startAt.inclusive):null;return hl(n.path,n.collectionGroup,e,n.filters,n.limit,t,r)}}function dl(n,e){let t=n.filters.concat([e]);return new Wt(n.path,n.collectionGroup,n.explicitOrderBy.slice(),t,n.limit,n.limitType,n.startAt,n.endAt)}function Ho(n,e,t){return new Wt(n.path,n.collectionGroup,n.explicitOrderBy.slice(),n.filters.slice(),e,t,n.startAt,n.endAt)}function za(n,e){return is(ze(n),ze(e))&&n.limitType===e.limitType}function qg(n){return`${xn(ze(n))}|lt:${n.limitType}`}function ar(n){return`Query(target=${(function(t){let r=t.path.canonicalString();return t.collectionGroup!==null&&(r+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(r+=`, filters: [${t.filters.map((i=>Fg(i))).join(", ")}]`),La(t.limit)||(r+=", limit: "+t.limit),t.orderBy.length>0&&(r+=`, orderBy: [${t.orderBy.map((i=>(function(o){return`${o.field.canonicalString()} (${o.dir})`})(i))).join(", ")}]`),t.startAt&&(r+=", startAt: ",r+=t.startAt.inclusive?"b:":"a:",r+=t.startAt.position.map((i=>br(i))).join(",")),t.endAt&&(r+=", endAt: ",r+=t.endAt.inclusive?"a:":"b:",r+=t.endAt.position.map((i=>br(i))).join(",")),`Target(${r})`})(ze(n))}; limitType=${n.limitType})`}function ss(n,e){return e.isFoundDocument()&&(function(r,i){let s=i.key.path;return r.collectionGroup!==null?i.key.hasCollectionId(r.collectionGroup)&&r.path.isPrefixOf(s):x.isDocumentKey(r.path)?r.path.isEqual(s):r.path.isImmediateParentOf(s)})(n,e)&&(function(r,i){for(let s of Di(r))if(!s.field.isKeyField()&&i.data.field(s.field)===null)return!1;return!0})(n,e)&&(function(r,i){for(let s of r.filters)if(!s.matches(i))return!1;return!0})(n,e)&&(function(r,i){return!(r.startAt&&!(function(o,c,u){let h=mm(o,c,u);return o.inclusive?h<=0:h<0})(r.startAt,Di(r),i)||r.endAt&&!(function(o,c,u){let h=mm(o,c,u);return o.inclusive?h>=0:h>0})(r.endAt,Di(r),i))})(n,e)}function LT(n){return n.collectionGroup||(n.path.length%2==1?n.path.lastSegment():n.path.get(n.path.length-2))}function jg(n){return(e,t)=>{let r=!1;for(let i of Di(n)){let s=MT(i,e,t);if(s!==0)return s;r=r||i.field.isKeyField()}return 0}}function MT(n,e,t){let r=n.field.isKeyField()?x.comparator(e.key,t.key):(function(s,o,c){let u=o.data.field(s),h=c.data.field(s);return u!==null&&h!==null?$t(u,h):L(42886)})(n.field,e,t);switch(n.dir){case"asc":return r;case"desc":return-1*r;default:return L(19790,{direction:n.dir})}}var Qe=class{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){let t=this.mapKeyFn(e),r=this.inner[t];if(r!==void 0){for(let[i,s]of r)if(this.equalsFn(i,e))return s}}has(e){return this.get(e)!==void 0}set(e,t){let r=this.mapKeyFn(e),i=this.inner[r];if(i===void 0)return this.inner[r]=[[e,t]],void this.innerSize++;for(let s=0;s<i.length;s++)if(this.equalsFn(i[s][0],e))return void(i[s]=[e,t]);i.push([e,t]),this.innerSize++}delete(e){let t=this.mapKeyFn(e),r=this.inner[t];if(r===void 0)return!1;for(let i=0;i<r.length;i++)if(this.equalsFn(r[i][0],e))return r.length===1?delete this.inner[t]:r.splice(i,1),this.innerSize--,!0;return!1}forEach(e){nn(this.inner,((t,r)=>{for(let[i,s]of r)e(i,s)}))}isEmpty(){return Sg(this.inner)}size(){return this.innerSize}};var FT=new oe(x.comparator);function Ue(){return FT}var zg=new oe(x.comparator);function Si(...n){let e=zg;for(let t of n)e=e.insert(t.key,t);return e}function Gg(n){let e=zg;return n.forEach(((t,r)=>e=e.insert(t,r.overlayedDocument))),e}function st(){return Oi()}function $g(){return Oi()}function Oi(){return new Qe((n=>n.toString()),((n,e)=>n.isEqual(e)))}var UT=new oe(x.comparator),BT=new te(x.comparator);function K(...n){let e=BT;for(let t of n)e=e.add(t);return e}var qT=new te(z);function jT(){return qT}function $h(n,e){if(n.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Fi(e)?"-0":e}}function Kg(n){return{integerValue:""+n}}function zT(n,e){return rT(e)?Kg(e):$h(n,e)}var Rr=class{constructor(){this._=void 0}};function GT(n,e,t){return n instanceof Ht?(function(i,s){let o={fields:{[Pg]:{stringValue:Rg},[Ng]:{timestampValue:{seconds:i.seconds,nanos:i.nanoseconds}}}};return s&&qh(s)&&(s=Ba(s)),s&&(o.fields[Cg]=s),{mapValue:o}})(t,e):n instanceof Qt?Hg(n,e):n instanceof Jt?Qg(n,e):(function(i,s){let o=Wg(i,s),c=wm(o)+wm(i.Ae);return tl(o)&&tl(i.Ae)?Kg(c):$h(i.serializer,c)})(n,e)}function $T(n,e,t){return n instanceof Qt?Hg(n,e):n instanceof Jt?Qg(n,e):t}function Wg(n,e){return n instanceof Ln?(function(r){return tl(r)||(function(s){return!!s&&"doubleValue"in s})(r)})(e)?e:{integerValue:0}:null}var Ht=class extends Rr{},Qt=class extends Rr{constructor(e){super(),this.elements=e}};function Hg(n,e){let t=Jg(e);for(let r of n.elements)t.some((i=>at(i,r)))||t.push(r);return{arrayValue:{values:t}}}var Jt=class extends Rr{constructor(e){super(),this.elements=e}};function Qg(n,e){let t=Jg(e);for(let r of n.elements)t=t.filter((i=>!at(i,r)));return{arrayValue:{values:t}}}var Ln=class extends Rr{constructor(e,t){super(),this.serializer=e,this.Ae=t}};function wm(n){return ie(n.integerValue||n.doubleValue)}function Jg(n){return Ki(n)&&n.arrayValue.values?n.arrayValue.values.slice():[]}var Qo=class{constructor(e,t){this.field=e,this.transform=t}};function KT(n,e){return n.field.isEqual(e.field)&&(function(r,i){return r instanceof Qt&&i instanceof Qt||r instanceof Jt&&i instanceof Jt?gr(r.elements,i.elements,at):r instanceof Ln&&i instanceof Ln?at(r.Ae,i.Ae):r instanceof Ht&&i instanceof Ht})(n.transform,e.transform)}var fl=class{constructor(e,t){this.version=e,this.transformResults=t}},Be=class n{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new n}static exists(e){return new n(void 0,e)}static updateTime(e){return new n(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}};function No(n,e){return n.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(n.updateTime):n.exists===void 0||n.exists===e.isFoundDocument()}var Pr=class{};function Yg(n,e){if(!n.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return n.isNoDocument()?new Wi(n.key,Be.none()):new Yt(n.key,n.data,Be.none());{let t=n.data,r=Ce.empty(),i=new te(ge.comparator);for(let s of e.fields)if(!i.has(s)){let o=t.field(s);o===null&&s.length>1&&(s=s.popLast(),o=t.field(s)),o===null?r.delete(s):r.set(s,o),i=i.add(s)}return new Je(n.key,r,new Fe(i.toArray()),Be.none())}}function WT(n,e,t){n instanceof Yt?(function(i,s,o){let c=i.value.clone(),u=Tm(i.fieldTransforms,s,o.transformResults);c.setAll(u),s.convertToFoundDocument(o.version,c).setHasCommittedMutations()})(n,e,t):n instanceof Je?(function(i,s,o){if(!No(i.precondition,s))return void s.convertToUnknownDocument(o.version);let c=Tm(i.fieldTransforms,s,o.transformResults),u=s.data;u.setAll(Xg(i)),u.setAll(c),s.convertToFoundDocument(o.version,u).setHasCommittedMutations()})(n,e,t):(function(i,s,o){s.convertToNoDocument(o.version).setHasCommittedMutations()})(0,e,t)}function Vi(n,e,t,r){return n instanceof Yt?(function(s,o,c,u){if(!No(s.precondition,o))return c;let h=s.value.clone(),f=vm(s.fieldTransforms,u,o);return h.setAll(f),o.convertToFoundDocument(o.version,h).setHasLocalMutations(),null})(n,e,t,r):n instanceof Je?(function(s,o,c,u){if(!No(s.precondition,o))return c;let h=vm(s.fieldTransforms,u,o),f=o.data;return f.setAll(Xg(s)),f.setAll(h),o.convertToFoundDocument(o.version,f).setHasLocalMutations(),c===null?null:c.unionWith(s.fieldMask.fields).unionWith(s.fieldTransforms.map((m=>m.field)))})(n,e,t,r):(function(s,o,c){return No(s.precondition,o)?(o.convertToNoDocument(o.version).setHasLocalMutations(),null):c})(n,e,t)}function HT(n,e){let t=null;for(let r of n.fieldTransforms){let i=e.data.field(r.field),s=Wg(r.transform,i||null);s!=null&&(t===null&&(t=Ce.empty()),t.set(r.field,s))}return t||null}function Em(n,e){return n.type===e.type&&!!n.key.isEqual(e.key)&&!!n.precondition.isEqual(e.precondition)&&!!(function(r,i){return r===void 0&&i===void 0||!(!r||!i)&&gr(r,i,((s,o)=>KT(s,o)))})(n.fieldTransforms,e.fieldTransforms)&&(n.type===0?n.value.isEqual(e.value):n.type!==1||n.data.isEqual(e.data)&&n.fieldMask.isEqual(e.fieldMask))}var Yt=class extends Pr{constructor(e,t,r,i=[]){super(),this.key=e,this.value=t,this.precondition=r,this.fieldTransforms=i,this.type=0}getFieldMask(){return null}},Je=class extends Pr{constructor(e,t,r,i,s=[]){super(),this.key=e,this.data=t,this.fieldMask=r,this.precondition=i,this.fieldTransforms=s,this.type=1}getFieldMask(){return this.fieldMask}};function Xg(n){let e=new Map;return n.fieldMask.fields.forEach((t=>{if(!t.isEmpty()){let r=n.data.field(t);e.set(t,r)}})),e}function Tm(n,e,t){let r=new Map;F(n.length===t.length,32656,{Re:t.length,Ve:n.length});for(let i=0;i<t.length;i++){let s=n[i],o=s.transform,c=e.data.field(s.field);r.set(s.field,$T(o,c,t[i]))}return r}function vm(n,e,t){let r=new Map;for(let i of n){let s=i.transform,o=t.data.field(i.field);r.set(i.field,GT(s,o,e))}return r}var Wi=class extends Pr{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}},Jo=class extends Pr{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}};var Hi=class{constructor(e,t,r,i){this.batchId=e,this.localWriteTime=t,this.baseMutations=r,this.mutations=i}applyToRemoteDocument(e,t){let r=t.mutationResults;for(let i=0;i<this.mutations.length;i++){let s=this.mutations[i];s.key.isEqual(e.key)&&WT(s,e,r[i])}}applyToLocalView(e,t){for(let r of this.baseMutations)r.key.isEqual(e.key)&&(t=Vi(r,e,t,this.localWriteTime));for(let r of this.mutations)r.key.isEqual(e.key)&&(t=Vi(r,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){let r=$g();return this.mutations.forEach((i=>{let s=e.get(i.key),o=s.overlayedDocument,c=this.applyToLocalView(o,s.mutatedFields);c=t.has(i.key)?null:c;let u=Yg(o,c);u!==null&&r.set(i.key,u),o.isValidDocument()||o.convertToNoDocument(B.min())})),r}keys(){return this.mutations.reduce(((e,t)=>e.add(t.key)),K())}isEqual(e){return this.batchId===e.batchId&&gr(this.mutations,e.mutations,((t,r)=>Em(t,r)))&&gr(this.baseMutations,e.baseMutations,((t,r)=>Em(t,r)))}},pl=class n{constructor(e,t,r,i){this.batch=e,this.commitVersion=t,this.mutationResults=r,this.docVersions=i}static from(e,t,r){F(e.mutations.length===r.length,58842,{me:e.mutations.length,fe:r.length});let i=(function(){return UT})(),s=e.mutations;for(let o=0;o<s.length;o++)i=i.insert(s[o].key,r[o].version);return new n(e,t,r,i)}};var Qi=class{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}};var ml=class{constructor(e,t){this.count=e,this.unchangedNames=t}};var le,J;function QT(n){switch(n){case P.OK:return L(64938);case P.CANCELLED:case P.UNKNOWN:case P.DEADLINE_EXCEEDED:case P.RESOURCE_EXHAUSTED:case P.INTERNAL:case P.UNAVAILABLE:case P.UNAUTHENTICATED:return!1;case P.INVALID_ARGUMENT:case P.NOT_FOUND:case P.ALREADY_EXISTS:case P.PERMISSION_DENIED:case P.FAILED_PRECONDITION:case P.ABORTED:case P.OUT_OF_RANGE:case P.UNIMPLEMENTED:case P.DATA_LOSS:return!0;default:return L(15467,{code:n})}}function Zg(n){if(n===void 0)return Pe("GRPC error has no .code"),P.UNKNOWN;switch(n){case le.OK:return P.OK;case le.CANCELLED:return P.CANCELLED;case le.UNKNOWN:return P.UNKNOWN;case le.DEADLINE_EXCEEDED:return P.DEADLINE_EXCEEDED;case le.RESOURCE_EXHAUSTED:return P.RESOURCE_EXHAUSTED;case le.INTERNAL:return P.INTERNAL;case le.UNAVAILABLE:return P.UNAVAILABLE;case le.UNAUTHENTICATED:return P.UNAUTHENTICATED;case le.INVALID_ARGUMENT:return P.INVALID_ARGUMENT;case le.NOT_FOUND:return P.NOT_FOUND;case le.ALREADY_EXISTS:return P.ALREADY_EXISTS;case le.PERMISSION_DENIED:return P.PERMISSION_DENIED;case le.FAILED_PRECONDITION:return P.FAILED_PRECONDITION;case le.ABORTED:return P.ABORTED;case le.OUT_OF_RANGE:return P.OUT_OF_RANGE;case le.UNIMPLEMENTED:return P.UNIMPLEMENTED;case le.DATA_LOSS:return P.DATA_LOSS;default:return L(39323,{code:n})}}(J=le||(le={}))[J.OK=0]="OK",J[J.CANCELLED=1]="CANCELLED",J[J.UNKNOWN=2]="UNKNOWN",J[J.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",J[J.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",J[J.NOT_FOUND=5]="NOT_FOUND",J[J.ALREADY_EXISTS=6]="ALREADY_EXISTS",J[J.PERMISSION_DENIED=7]="PERMISSION_DENIED",J[J.UNAUTHENTICATED=16]="UNAUTHENTICATED",J[J.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",J[J.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",J[J.ABORTED=10]="ABORTED",J[J.OUT_OF_RANGE=11]="OUT_OF_RANGE",J[J.UNIMPLEMENTED=12]="UNIMPLEMENTED",J[J.INTERNAL=13]="INTERNAL",J[J.UNAVAILABLE=14]="UNAVAILABLE",J[J.DATA_LOSS=15]="DATA_LOSS";var JT=null;function YT(){return new TextEncoder}var XT=new pt([4294967295,4294967295],0);function Am(n){let e=YT().encode(n),t=new bu;return t.update(e),new Uint8Array(t.digest())}function bm(n){let e=new DataView(n.buffer),t=e.getUint32(0,!0),r=e.getUint32(4,!0),i=e.getUint32(8,!0),s=e.getUint32(12,!0);return[new pt([t,r],0),new pt([i,s],0)]}var gl=class n{constructor(e,t,r){if(this.bitmap=e,this.padding=t,this.hashCount=r,t<0||t>=8)throw new bn(`Invalid padding: ${t}`);if(r<0)throw new bn(`Invalid hash count: ${r}`);if(e.length>0&&this.hashCount===0)throw new bn(`Invalid hash count: ${r}`);if(e.length===0&&t!==0)throw new bn(`Invalid padding when bitmap length is 0: ${t}`);this.ge=8*e.length-t,this.pe=pt.fromNumber(this.ge)}ye(e,t,r){let i=e.add(t.multiply(pt.fromNumber(r)));return i.compare(XT)===1&&(i=new pt([i.getBits(0),i.getBits(1)],0)),i.modulo(this.pe).toNumber()}we(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.ge===0)return!1;let t=Am(e),[r,i]=bm(t);for(let s=0;s<this.hashCount;s++){let o=this.ye(r,i,s);if(!this.we(o))return!1}return!0}static create(e,t,r){let i=e%8==0?0:8-e%8,s=new Uint8Array(Math.ceil(e/8)),o=new n(s,i,t);return r.forEach((c=>o.insert(c))),o}insert(e){if(this.ge===0)return;let t=Am(e),[r,i]=bm(t);for(let s=0;s<this.hashCount;s++){let o=this.ye(r,i,s);this.Se(o)}}Se(e){let t=Math.floor(e/8),r=e%8;this.bitmap[t]|=1<<r}},bn=class extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}};var Yo=class n{constructor(e,t,r,i,s){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=r,this.documentUpdates=i,this.resolvedLimboDocuments=s}static createSynthesizedRemoteEventForCurrentChange(e,t,r){let i=new Map;return i.set(e,Ji.createSynthesizedTargetChangeForCurrentChange(e,t,r)),new n(B.min(),i,new oe(z),Ue(),K())}},Ji=class n{constructor(e,t,r,i,s){this.resumeToken=e,this.current=t,this.addedDocuments=r,this.modifiedDocuments=i,this.removedDocuments=s}static createSynthesizedTargetChangeForCurrentChange(e,t,r){return new n(r,t,K(),K(),K())}};var fr=class{constructor(e,t,r,i){this.be=e,this.removedTargetIds=t,this.key=r,this.De=i}},Xo=class{constructor(e,t){this.targetId=e,this.Ce=t}},Zo=class{constructor(e,t,r=_e.EMPTY_BYTE_STRING,i=null){this.state=e,this.targetIds=t,this.resumeToken=r,this.cause=i}},ea=class{constructor(){this.ve=0,this.Fe=Sm(),this.Me=_e.EMPTY_BYTE_STRING,this.xe=!1,this.Oe=!0}get current(){return this.xe}get resumeToken(){return this.Me}get Ne(){return this.ve!==0}get Be(){return this.Oe}Le(e){e.approximateByteSize()>0&&(this.Oe=!0,this.Me=e)}ke(){let e=K(),t=K(),r=K();return this.Fe.forEach(((i,s)=>{switch(s){case 0:e=e.add(i);break;case 2:t=t.add(i);break;case 1:r=r.add(i);break;default:L(38017,{changeType:s})}})),new Ji(this.Me,this.xe,e,t,r)}qe(){this.Oe=!1,this.Fe=Sm()}Qe(e,t){this.Oe=!0,this.Fe=this.Fe.insert(e,t)}$e(e){this.Oe=!0,this.Fe=this.Fe.remove(e)}Ue(){this.ve+=1}Ke(){this.ve-=1,F(this.ve>=0,3241,{ve:this.ve})}We(){this.Oe=!0,this.xe=!0}},_l=class{constructor(e){this.Ge=e,this.ze=new Map,this.je=Ue(),this.Je=wo(),this.He=wo(),this.Ye=new oe(z)}Ze(e){for(let t of e.be)e.De&&e.De.isFoundDocument()?this.Xe(t,e.De):this.et(t,e.key,e.De);for(let t of e.removedTargetIds)this.et(t,e.key,e.De)}tt(e){this.forEachTarget(e,(t=>{let r=this.nt(t);switch(e.state){case 0:this.rt(t)&&r.Le(e.resumeToken);break;case 1:r.Ke(),r.Ne||r.qe(),r.Le(e.resumeToken);break;case 2:r.Ke(),r.Ne||this.removeTarget(t);break;case 3:this.rt(t)&&(r.We(),r.Le(e.resumeToken));break;case 4:this.rt(t)&&(this.it(t),r.Le(e.resumeToken));break;default:L(56790,{state:e.state})}}))}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.ze.forEach(((r,i)=>{this.rt(i)&&t(i)}))}st(e){let t=e.targetId,r=e.Ce.count,i=this.ot(t);if(i){let s=i.target;if(Ko(s))if(r===0){let o=new x(s.path);this.et(t,o,Ee.newNoDocument(o,B.min()))}else F(r===1,20013,{expectedCount:r});else{let o=this._t(t);if(o!==r){let c=this.ut(e),u=c?this.ct(c,e,o):1;if(u!==0){this.it(t);let h=u===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ye=this.Ye.insert(t,h)}JT?.lt((function(f,m,_,R,k){let O={localCacheCount:f,existenceFilterCount:m.count,databaseId:_.database,projectId:_.projectId},N=m.unchangedNames;return N&&(O.bloomFilter={applied:k===0,hashCount:N?.hashCount??0,bitmapLength:N?.bits?.bitmap?.length??0,padding:N?.bits?.padding??0,mightContain:j=>R?.mightContain(j)??!1}),O})(o,e.Ce,this.Ge.ht(),c,u))}}}}ut(e){let t=e.Ce.unchangedNames;if(!t||!t.bits)return null;let{bits:{bitmap:r="",padding:i=0},hashCount:s=0}=t,o,c;try{o=yt(r).toUint8Array()}catch(u){if(u instanceof jo)return On("Decoding the base64 bloom filter in existence filter failed ("+u.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw u}try{c=new gl(o,i,s)}catch(u){return On(u instanceof bn?"BloomFilter error: ":"Applying bloom filter failed: ",u),null}return c.ge===0?null:c}ct(e,t,r){return t.Ce.count===r-this.Pt(e,t.targetId)?0:2}Pt(e,t){let r=this.Ge.getRemoteKeysForTarget(t),i=0;return r.forEach((s=>{let o=this.Ge.ht(),c=`projects/${o.projectId}/databases/${o.database}/documents/${s.path.canonicalString()}`;e.mightContain(c)||(this.et(t,s,null),i++)})),i}Tt(e){let t=new Map;this.ze.forEach(((s,o)=>{let c=this.ot(o);if(c){if(s.current&&Ko(c.target)){let u=new x(c.target.path);this.It(u).has(o)||this.Et(o,u)||this.et(o,u,Ee.newNoDocument(u,e))}s.Be&&(t.set(o,s.ke()),s.qe())}}));let r=K();this.He.forEach(((s,o)=>{let c=!0;o.forEachWhile((u=>{let h=this.ot(u);return!h||h.purpose==="TargetPurposeLimboResolution"||(c=!1,!1)})),c&&(r=r.add(s))})),this.je.forEach(((s,o)=>o.setReadTime(e)));let i=new Yo(e,t,this.Ye,this.je,r);return this.je=Ue(),this.Je=wo(),this.He=wo(),this.Ye=new oe(z),i}Xe(e,t){if(!this.rt(e))return;let r=this.Et(e,t.key)?2:0;this.nt(e).Qe(t.key,r),this.je=this.je.insert(t.key,t),this.Je=this.Je.insert(t.key,this.It(t.key).add(e)),this.He=this.He.insert(t.key,this.dt(t.key).add(e))}et(e,t,r){if(!this.rt(e))return;let i=this.nt(e);this.Et(e,t)?i.Qe(t,1):i.$e(t),this.He=this.He.insert(t,this.dt(t).delete(e)),this.He=this.He.insert(t,this.dt(t).add(e)),r&&(this.je=this.je.insert(t,r))}removeTarget(e){this.ze.delete(e)}_t(e){let t=this.nt(e).ke();return this.Ge.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}Ue(e){this.nt(e).Ue()}nt(e){let t=this.ze.get(e);return t||(t=new ea,this.ze.set(e,t)),t}dt(e){let t=this.He.get(e);return t||(t=new te(z),this.He=this.He.insert(e,t)),t}It(e){let t=this.Je.get(e);return t||(t=new te(z),this.Je=this.Je.insert(e,t)),t}rt(e){let t=this.ot(e)!==null;return t||C("WatchChangeAggregator","Detected inactive target",e),t}ot(e){let t=this.ze.get(e);return t&&t.Ne?null:this.Ge.At(e)}it(e){this.ze.set(e,new ea),this.Ge.getRemoteKeysForTarget(e).forEach((t=>{this.et(e,t,null)}))}Et(e,t){return this.Ge.getRemoteKeysForTarget(e).has(t)}};function wo(){return new oe(x.comparator)}function Sm(){return new oe(x.comparator)}var ZT={asc:"ASCENDING",desc:"DESCENDING"},ev={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},tv={and:"AND",or:"OR"},yl=class{constructor(e,t){this.databaseId=e,this.useProto3Json=t}};function Il(n,e){return n.useProto3Json||La(e)?e:{value:e}}function Cr(n,e){return n.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function e_(n,e){return n.useProto3Json?e.toBase64():e.toUint8Array()}function nv(n,e){return Cr(n,e.toTimestamp())}function Ne(n){return F(!!n,49232),B.fromTimestamp((function(t){let r=_t(t);return new se(r.seconds,r.nanos)})(n))}function Kh(n,e){return wl(n,e).canonicalString()}function wl(n,e){let t=(function(i){return new X(["projects",i.projectId,"databases",i.database])})(n).child("documents");return e===void 0?t:t.child(e)}function t_(n){let e=X.fromString(n);return F(l_(e),10190,{key:e.toString()}),e}function ta(n,e){return Kh(n.databaseId,e.path)}function Nn(n,e){let t=t_(e);if(t.get(1)!==n.databaseId.projectId)throw new D(P.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+n.databaseId.projectId);if(t.get(3)!==n.databaseId.database)throw new D(P.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+n.databaseId.database);return new x(i_(t))}function n_(n,e){return Kh(n.databaseId,e)}function r_(n){let e=t_(n);return e.length===4?X.emptyPath():i_(e)}function El(n){return new X(["projects",n.databaseId.projectId,"databases",n.databaseId.database]).canonicalString()}function i_(n){return F(n.length>4&&n.get(4)==="documents",29091,{key:n.toString()}),n.popFirst(5)}function Rm(n,e,t){return{name:ta(n,e),fields:t.value.mapValue.fields}}function rv(n,e,t){let r=Nn(n,e.name),i=Ne(e.updateTime),s=e.createTime?Ne(e.createTime):B.min(),o=new Ce({mapValue:{fields:e.fields}}),c=Ee.newFoundDocument(r,i,s,o);return t&&c.setHasCommittedMutations(),t?c.setHasCommittedMutations():c}function iv(n,e){let t;if("targetChange"in e){e.targetChange;let r=(function(h){return h==="NO_CHANGE"?0:h==="ADD"?1:h==="REMOVE"?2:h==="CURRENT"?3:h==="RESET"?4:L(39313,{state:h})})(e.targetChange.targetChangeType||"NO_CHANGE"),i=e.targetChange.targetIds||[],s=(function(h,f){return h.useProto3Json?(F(f===void 0||typeof f=="string",58123),_e.fromBase64String(f||"")):(F(f===void 0||f instanceof Buffer||f instanceof Uint8Array,16193),_e.fromUint8Array(f||new Uint8Array))})(n,e.targetChange.resumeToken),o=e.targetChange.cause,c=o&&(function(h){let f=h.code===void 0?P.UNKNOWN:Zg(h.code);return new D(f,h.message||"")})(o);t=new Zo(r,i,s,c||null)}else if("documentChange"in e){e.documentChange;let r=e.documentChange;r.document,r.document.name,r.document.updateTime;let i=Nn(n,r.document.name),s=Ne(r.document.updateTime),o=r.document.createTime?Ne(r.document.createTime):B.min(),c=new Ce({mapValue:{fields:r.document.fields}}),u=Ee.newFoundDocument(i,s,o,c),h=r.targetIds||[],f=r.removedTargetIds||[];t=new fr(h,f,u.key,u)}else if("documentDelete"in e){e.documentDelete;let r=e.documentDelete;r.document;let i=Nn(n,r.document),s=r.readTime?Ne(r.readTime):B.min(),o=Ee.newNoDocument(i,s),c=r.removedTargetIds||[];t=new fr([],c,o.key,o)}else if("documentRemove"in e){e.documentRemove;let r=e.documentRemove;r.document;let i=Nn(n,r.document),s=r.removedTargetIds||[];t=new fr([],s,i,null)}else{if(!("filter"in e))return L(11601,{Rt:e});{e.filter;let r=e.filter;r.targetId;let{count:i=0,unchangedNames:s}=r,o=new ml(i,s),c=r.targetId;t=new Xo(c,o)}}return t}function na(n,e){let t;if(e instanceof Yt)t={update:Rm(n,e.key,e.value)};else if(e instanceof Wi)t={delete:ta(n,e.key)};else if(e instanceof Je)t={update:Rm(n,e.key,e.data),updateMask:lv(e.fieldMask)};else{if(!(e instanceof Jo))return L(16599,{Vt:e.type});t={verify:ta(n,e.key)}}return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map((r=>(function(s,o){let c=o.transform;if(c instanceof Ht)return{fieldPath:o.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(c instanceof Qt)return{fieldPath:o.field.canonicalString(),appendMissingElements:{values:c.elements}};if(c instanceof Jt)return{fieldPath:o.field.canonicalString(),removeAllFromArray:{values:c.elements}};if(c instanceof Ln)return{fieldPath:o.field.canonicalString(),increment:c.Ae};throw L(20930,{transform:o.transform})})(0,r)))),e.precondition.isNone||(t.currentDocument=(function(i,s){return s.updateTime!==void 0?{updateTime:nv(i,s.updateTime)}:s.exists!==void 0?{exists:s.exists}:L(27497)})(n,e.precondition)),t}function Tl(n,e){let t=e.currentDocument?(function(s){return s.updateTime!==void 0?Be.updateTime(Ne(s.updateTime)):s.exists!==void 0?Be.exists(s.exists):Be.none()})(e.currentDocument):Be.none(),r=e.updateTransforms?e.updateTransforms.map((i=>(function(o,c){let u=null;if("setToServerValue"in c)F(c.setToServerValue==="REQUEST_TIME",16630,{proto:c}),u=new Ht;else if("appendMissingElements"in c){let f=c.appendMissingElements.values||[];u=new Qt(f)}else if("removeAllFromArray"in c){let f=c.removeAllFromArray.values||[];u=new Jt(f)}else"increment"in c?u=new Ln(o,c.increment):L(16584,{proto:c});let h=ge.fromServerFormat(c.fieldPath);return new Qo(h,u)})(n,i))):[];if(e.update){e.update.name;let i=Nn(n,e.update.name),s=new Ce({mapValue:{fields:e.update.fields}});if(e.updateMask){let o=(function(u){let h=u.fieldPaths||[];return new Fe(h.map((f=>ge.fromServerFormat(f))))})(e.updateMask);return new Je(i,s,o,t,r)}return new Yt(i,s,t,r)}if(e.delete){let i=Nn(n,e.delete);return new Wi(i,t)}if(e.verify){let i=Nn(n,e.verify);return new Jo(i,t)}return L(1463,{proto:e})}function sv(n,e){return n&&n.length>0?(F(e!==void 0,14353),n.map((t=>(function(i,s){let o=i.updateTime?Ne(i.updateTime):Ne(s);return o.isEqual(B.min())&&(o=Ne(s)),new fl(o,i.transformResults||[])})(t,e)))):[]}function s_(n,e){return{documents:[n_(n,e.path)]}}function o_(n,e){let t={structuredQuery:{}},r=e.path,i;e.collectionGroup!==null?(i=r,t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(i=r.popLast(),t.structuredQuery.from=[{collectionId:r.lastSegment()}]),t.parent=n_(n,i);let s=(function(h){if(h.length!==0)return u_(Z.create(h,"and"))})(e.filters);s&&(t.structuredQuery.where=s);let o=(function(h){if(h.length!==0)return h.map((f=>(function(_){return{field:cr(_.field),direction:av(_.dir)}})(f)))})(e.orderBy);o&&(t.structuredQuery.orderBy=o);let c=Il(n,e.limit);return c!==null&&(t.structuredQuery.limit=c),e.startAt&&(t.structuredQuery.startAt=(function(h){return{before:h.inclusive,values:h.position}})(e.startAt)),e.endAt&&(t.structuredQuery.endAt=(function(h){return{before:!h.inclusive,values:h.position}})(e.endAt)),{ft:t,parent:i}}function a_(n){let e=r_(n.parent),t=n.structuredQuery,r=t.from?t.from.length:0,i=null;if(r>0){F(r===1,65062);let f=t.from[0];f.allDescendants?i=f.collectionId:e=e.child(f.collectionId)}let s=[];t.where&&(s=(function(m){let _=c_(m);return _ instanceof Z&&Gh(_)?_.getFilters():[_]})(t.where));let o=[];t.orderBy&&(o=(function(m){return m.map((_=>(function(k){return new Vn(ur(k.field),(function(N){switch(N){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}})(k.direction))})(_)))})(t.orderBy));let c=null;t.limit&&(c=(function(m){let _;return _=typeof m=="object"?m.value:m,La(_)?null:_})(t.limit));let u=null;t.startAt&&(u=(function(m){let _=!!m.before,R=m.values||[];return new Kt(R,_)})(t.startAt));let h=null;return t.endAt&&(h=(function(m){let _=!m.before,R=m.values||[];return new Kt(R,_)})(t.endAt)),VT(e,i,o,s,c,"F",u,h)}function ov(n,e){let t=(function(i){switch(i){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return L(28987,{purpose:i})}})(e.purpose);return t==null?null:{"goog-listen-tags":t}}function c_(n){return n.unaryFilter!==void 0?(function(t){switch(t.unaryFilter.op){case"IS_NAN":let r=ur(t.unaryFilter.field);return H.create(r,"==",{doubleValue:NaN});case"IS_NULL":let i=ur(t.unaryFilter.field);return H.create(i,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":let s=ur(t.unaryFilter.field);return H.create(s,"!=",{doubleValue:NaN});case"IS_NOT_NULL":let o=ur(t.unaryFilter.field);return H.create(o,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return L(61313);default:return L(60726)}})(n):n.fieldFilter!==void 0?(function(t){return H.create(ur(t.fieldFilter.field),(function(i){switch(i){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return L(58110);default:return L(50506)}})(t.fieldFilter.op),t.fieldFilter.value)})(n):n.compositeFilter!==void 0?(function(t){return Z.create(t.compositeFilter.filters.map((r=>c_(r))),(function(i){switch(i){case"AND":return"and";case"OR":return"or";default:return L(1026)}})(t.compositeFilter.op))})(n):L(30097,{filter:n})}function av(n){return ZT[n]}function cv(n){return ev[n]}function uv(n){return tv[n]}function cr(n){return{fieldPath:n.canonicalString()}}function ur(n){return ge.fromServerFormat(n.fieldPath)}function u_(n){return n instanceof H?(function(t){if(t.op==="=="){if(dm(t.value))return{unaryFilter:{field:cr(t.field),op:"IS_NAN"}};if(hm(t.value))return{unaryFilter:{field:cr(t.field),op:"IS_NULL"}}}else if(t.op==="!="){if(dm(t.value))return{unaryFilter:{field:cr(t.field),op:"IS_NOT_NAN"}};if(hm(t.value))return{unaryFilter:{field:cr(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:cr(t.field),op:cv(t.op),value:t.value}}})(n):n instanceof Z?(function(t){let r=t.getFilters().map((i=>u_(i)));return r.length===1?r[0]:{compositeFilter:{op:uv(t.op),filters:r}}})(n):L(54877,{filter:n})}function lv(n){let e=[];return n.fields.forEach((t=>e.push(t.canonicalString()))),{fieldPaths:e}}function l_(n){return n.length>=4&&n.get(0)==="projects"&&n.get(2)==="databases"}var Nr=class n{constructor(e,t,r,i,s=B.min(),o=B.min(),c=_e.EMPTY_BYTE_STRING,u=null){this.target=e,this.targetId=t,this.purpose=r,this.sequenceNumber=i,this.snapshotVersion=s,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=c,this.expectedCount=u}withSequenceNumber(e){return new n(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new n(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new n(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new n(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}};var ra=class{constructor(e){this.yt=e}};function hv(n,e){let t;if(e.document)t=rv(n.yt,e.document,!!e.hasCommittedMutations);else if(e.noDocument){let r=x.fromSegments(e.noDocument.path),i=Fn(e.noDocument.readTime);t=Ee.newNoDocument(r,i),e.hasCommittedMutations&&t.setHasCommittedMutations()}else{if(!e.unknownDocument)return L(56709);{let r=x.fromSegments(e.unknownDocument.path),i=Fn(e.unknownDocument.version);t=Ee.newUnknownDocument(r,i)}}return e.readTime&&t.setReadTime((function(i){let s=new se(i[0],i[1]);return B.fromTimestamp(s)})(e.readTime)),t}function Pm(n,e){let t=e.key,r={prefixPath:t.getCollectionPath().popLast().toArray(),collectionGroup:t.collectionGroup,documentId:t.path.lastSegment(),readTime:ia(e.readTime),hasCommittedMutations:e.hasCommittedMutations};if(e.isFoundDocument())r.document=(function(s,o){return{name:ta(s,o.key),fields:o.data.value.mapValue.fields,updateTime:Cr(s,o.version.toTimestamp()),createTime:Cr(s,o.createTime.toTimestamp())}})(n.yt,e);else if(e.isNoDocument())r.noDocument={path:t.path.toArray(),readTime:Mn(e.version)};else{if(!e.isUnknownDocument())return L(57904,{document:e});r.unknownDocument={path:t.path.toArray(),version:Mn(e.version)}}return r}function ia(n){let e=n.toTimestamp();return[e.seconds,e.nanoseconds]}function Mn(n){let e=n.toTimestamp();return{seconds:e.seconds,nanoseconds:e.nanoseconds}}function Fn(n){let e=new se(n.seconds,n.nanoseconds);return B.fromTimestamp(e)}function En(n,e){let t=(e.baseMutations||[]).map((s=>Tl(n.yt,s)));for(let s=0;s<e.mutations.length-1;++s){let o=e.mutations[s];if(s+1<e.mutations.length&&e.mutations[s+1].transform!==void 0){let c=e.mutations[s+1];o.updateTransforms=c.transform.fieldTransforms,e.mutations.splice(s+1,1),++s}}let r=e.mutations.map((s=>Tl(n.yt,s))),i=se.fromMillis(e.localWriteTimeMs);return new Hi(e.batchId,i,t,r)}function Ri(n){let e=Fn(n.readTime),t=n.lastLimboFreeSnapshotVersion!==void 0?Fn(n.lastLimboFreeSnapshotVersion):B.min(),r;return r=(function(s){return s.documents!==void 0})(n.query)?(function(s){let o=s.documents.length;return F(o===1,1966,{count:o}),ze(ja(r_(s.documents[0])))})(n.query):(function(s){return ze(a_(s))})(n.query),new Nr(r,n.targetId,"TargetPurposeListen",n.lastListenSequenceNumber,e,t,_e.fromBase64String(n.resumeToken))}function h_(n,e){let t=Mn(e.snapshotVersion),r=Mn(e.lastLimboFreeSnapshotVersion),i;i=Ko(e.target)?s_(n.yt,e.target):o_(n.yt,e.target).ft;let s=e.resumeToken.toBase64();return{targetId:e.targetId,canonicalId:xn(e.target),readTime:t,resumeToken:s,lastListenSequenceNumber:e.sequenceNumber,lastLimboFreeSnapshotVersion:r,query:i}}function d_(n){let e=a_({parent:n.parent,structuredQuery:n.structuredQuery});return n.limitType==="LAST"?Ho(e,e.limit,"L"):e}function Du(n,e){return new Qi(e.largestBatchId,Tl(n.yt,e.overlayMutation))}function Cm(n,e){let t=e.path.lastSegment();return[n,be(e.path.popLast()),t]}function Nm(n,e,t,r){return{indexId:n,uid:e,sequenceNumber:t,readTime:Mn(r.readTime),documentKey:be(r.documentKey.path),largestBatchId:r.largestBatchId}}var vl=class{getBundleMetadata(e,t){return km(e).get(t).next((r=>{if(r)return(function(s){return{id:s.bundleId,createTime:Fn(s.createTime),version:s.version}})(r)}))}saveBundleMetadata(e,t){return km(e).put((function(i){return{bundleId:i.id,createTime:Mn(Ne(i.createTime)),version:i.version}})(t))}getNamedQuery(e,t){return Dm(e).get(t).next((r=>{if(r)return(function(s){return{name:s.name,query:d_(s.bundledQuery),readTime:Fn(s.readTime)}})(r)}))}saveNamedQuery(e,t){return Dm(e).put((function(i){return{name:i.name,readTime:Mn(Ne(i.readTime)),bundledQuery:i.bundledQuery}})(t))}};function km(n){return ye(n,Ma)}function Dm(n){return ye(n,Fa)}var sa=class n{constructor(e,t){this.serializer=e,this.userId=t}static wt(e,t){let r=t.uid||"";return new n(e,r)}getOverlay(e,t){return Ti(e).get(Cm(this.userId,t)).next((r=>r?Du(this.serializer,r):null))}getOverlays(e,t){let r=st();return b.forEach(t,(i=>this.getOverlay(e,i).next((s=>{s!==null&&r.set(i,s)})))).next((()=>r))}saveOverlays(e,t,r){let i=[];return r.forEach(((s,o)=>{let c=new Qi(t,o);i.push(this.St(e,c))})),b.waitFor(i)}removeOverlaysForBatchId(e,t,r){let i=new Set;t.forEach((o=>i.add(be(o.getCollectionPath()))));let s=[];return i.forEach((o=>{let c=IDBKeyRange.bound([this.userId,o,r],[this.userId,o,r+1],!1,!0);s.push(Ti(e).Z(Xu,c))})),b.waitFor(s)}getOverlaysForCollection(e,t,r){let i=st(),s=be(t),o=IDBKeyRange.bound([this.userId,s,r],[this.userId,s,Number.POSITIVE_INFINITY],!0);return Ti(e).J(Xu,o).next((c=>{for(let u of c){let h=Du(this.serializer,u);i.set(h.getKey(),h)}return i}))}getOverlaysForCollectionGroup(e,t,r,i){let s=st(),o,c=IDBKeyRange.bound([this.userId,t,r],[this.userId,t,Number.POSITIVE_INFINITY],!0);return Ti(e).ee({index:Eg,range:c},((u,h,f)=>{let m=Du(this.serializer,h);s.size()<i||m.largestBatchId===o?(s.set(m.getKey(),m),o=m.largestBatchId):f.done()})).next((()=>s))}St(e,t){return Ti(e).put((function(i,s,o){let[c,u,h]=Cm(s,o.mutation.key);return{userId:s,collectionPath:u,documentId:h,collectionGroup:o.mutation.key.getCollectionGroup(),largestBatchId:o.largestBatchId,overlayMutation:na(i.yt,o.mutation)}})(this.serializer,this.userId,t))}};function Ti(n){return ye(n,Ua)}var Al=class{bt(e){return ye(e,Uh)}getSessionToken(e){return this.bt(e).get("sessionToken").next((t=>{let r=t?.value;return r?_e.fromUint8Array(r):_e.EMPTY_BYTE_STRING}))}setSessionToken(e,t){return this.bt(e).put({name:"sessionToken",value:t.toUint8Array()})}};var gt=class{constructor(){}Dt(e,t){this.Ct(e,t),t.vt()}Ct(e,t){if("nullValue"in e)this.Ft(t,5);else if("booleanValue"in e)this.Ft(t,10),t.Mt(e.booleanValue?1:0);else if("integerValue"in e)this.Ft(t,15),t.Mt(ie(e.integerValue));else if("doubleValue"in e){let r=ie(e.doubleValue);isNaN(r)?this.Ft(t,13):(this.Ft(t,15),Fi(r)?t.Mt(0):t.Mt(r))}else if("timestampValue"in e){let r=e.timestampValue;this.Ft(t,20),typeof r=="string"&&(r=_t(r)),t.xt(`${r.seconds||""}`),t.Mt(r.nanos||0)}else if("stringValue"in e)this.Ot(e.stringValue,t),this.Nt(t);else if("bytesValue"in e)this.Ft(t,30),t.Bt(yt(e.bytesValue)),this.Nt(t);else if("referenceValue"in e)this.Lt(e.referenceValue,t);else if("geoPointValue"in e){let r=e.geoPointValue;this.Ft(t,45),t.Mt(r.latitude||0),t.Mt(r.longitude||0)}else"mapValue"in e?Dg(e)?this.Ft(t,Number.MAX_SAFE_INTEGER):qa(e)?this.kt(e.mapValue,t):(this.qt(e.mapValue,t),this.Nt(t)):"arrayValue"in e?(this.Qt(e.arrayValue,t),this.Nt(t)):L(19022,{$t:e})}Ot(e,t){this.Ft(t,25),this.Ut(e,t)}Ut(e,t){t.xt(e)}qt(e,t){let r=e.fields||{};this.Ft(t,55);for(let i of Object.keys(r))this.Ot(i,t),this.Ct(r[i],t)}kt(e,t){let r=e.fields||{};this.Ft(t,53);let i=Ar,s=r[i].arrayValue?.values?.length||0;this.Ft(t,15),t.Mt(ie(s)),this.Ot(i,t),this.Ct(r[i],t)}Qt(e,t){let r=e.values||[];this.Ft(t,50);for(let i of r)this.Ct(i,t)}Lt(e,t){this.Ft(t,37),x.fromName(e).path.forEach((r=>{this.Ft(t,60),this.Ut(r,t)}))}Ft(e,t){e.Mt(t)}Nt(e){e.Mt(2)}};gt.Kt=new gt;var nr=255;function dv(n){if(n===0)return 8;let e=0;return n>>4||(e+=4,n<<=4),n>>6||(e+=2,n<<=2),n>>7||(e+=1),e}function Om(n){let e=64-(function(r){let i=0;for(let s=0;s<8;++s){let o=dv(255&r[s]);if(i+=o,o!==8)break}return i})(n);return Math.ceil(e/8)}var bl=class{constructor(){this.buffer=new Uint8Array(1024),this.position=0}Wt(e){let t=e[Symbol.iterator](),r=t.next();for(;!r.done;)this.Gt(r.value),r=t.next();this.zt()}jt(e){let t=e[Symbol.iterator](),r=t.next();for(;!r.done;)this.Jt(r.value),r=t.next();this.Ht()}Yt(e){for(let t of e){let r=t.charCodeAt(0);if(r<128)this.Gt(r);else if(r<2048)this.Gt(960|r>>>6),this.Gt(128|63&r);else if(t<"\uD800"||"\uDBFF"<t)this.Gt(480|r>>>12),this.Gt(128|63&r>>>6),this.Gt(128|63&r);else{let i=t.codePointAt(0);this.Gt(240|i>>>18),this.Gt(128|63&i>>>12),this.Gt(128|63&i>>>6),this.Gt(128|63&i)}}this.zt()}Zt(e){for(let t of e){let r=t.charCodeAt(0);if(r<128)this.Jt(r);else if(r<2048)this.Jt(960|r>>>6),this.Jt(128|63&r);else if(t<"\uD800"||"\uDBFF"<t)this.Jt(480|r>>>12),this.Jt(128|63&r>>>6),this.Jt(128|63&r);else{let i=t.codePointAt(0);this.Jt(240|i>>>18),this.Jt(128|63&i>>>12),this.Jt(128|63&i>>>6),this.Jt(128|63&i)}}this.Ht()}Xt(e){let t=this.en(e),r=Om(t);this.tn(1+r),this.buffer[this.position++]=255&r;for(let i=t.length-r;i<t.length;++i)this.buffer[this.position++]=255&t[i]}nn(e){let t=this.en(e),r=Om(t);this.tn(1+r),this.buffer[this.position++]=~(255&r);for(let i=t.length-r;i<t.length;++i)this.buffer[this.position++]=~(255&t[i])}rn(){this.sn(nr),this.sn(255)}_n(){this.an(nr),this.an(255)}reset(){this.position=0}seed(e){this.tn(e.length),this.buffer.set(e,this.position),this.position+=e.length}un(){return this.buffer.slice(0,this.position)}en(e){let t=(function(s){let o=new DataView(new ArrayBuffer(8));return o.setFloat64(0,s,!1),new Uint8Array(o.buffer)})(e),r=!!(128&t[0]);t[0]^=r?255:128;for(let i=1;i<t.length;++i)t[i]^=r?255:0;return t}Gt(e){let t=255&e;t===0?(this.sn(0),this.sn(255)):t===nr?(this.sn(nr),this.sn(0)):this.sn(t)}Jt(e){let t=255&e;t===0?(this.an(0),this.an(255)):t===nr?(this.an(nr),this.an(0)):this.an(e)}zt(){this.sn(0),this.sn(1)}Ht(){this.an(0),this.an(1)}sn(e){this.tn(1),this.buffer[this.position++]=e}an(e){this.tn(1),this.buffer[this.position++]=~e}tn(e){let t=e+this.position;if(t<=this.buffer.length)return;let r=2*this.buffer.length;r<t&&(r=t);let i=new Uint8Array(r);i.set(this.buffer),this.buffer=i}},Sl=class{constructor(e){this.cn=e}Bt(e){this.cn.Wt(e)}xt(e){this.cn.Yt(e)}Mt(e){this.cn.Xt(e)}vt(){this.cn.rn()}},Rl=class{constructor(e){this.cn=e}Bt(e){this.cn.jt(e)}xt(e){this.cn.Zt(e)}Mt(e){this.cn.nn(e)}vt(){this.cn._n()}},Tn=class{constructor(){this.cn=new bl,this.ln=new Sl(this.cn),this.hn=new Rl(this.cn)}seed(e){this.cn.seed(e)}Pn(e){return e===0?this.ln:this.hn}un(){return this.cn.un()}reset(){this.cn.reset()}};var vn=class n{constructor(e,t,r,i){this.Tn=e,this.In=t,this.En=r,this.dn=i}An(){let e=this.dn.length,t=e===0||this.dn[e-1]===255?e+1:e,r=new Uint8Array(t);return r.set(this.dn,0),t!==e?r.set([0],this.dn.length):++r[r.length-1],new n(this.Tn,this.In,this.En,r)}Rn(e,t,r){return{indexId:this.Tn,uid:e,arrayValue:ko(this.En),directionalValue:ko(this.dn),orderedDocumentKey:ko(t),documentKey:r.path.toArray()}}Vn(e,t,r){let i=this.Rn(e,t,r);return[i.indexId,i.uid,i.arrayValue,i.directionalValue,i.orderedDocumentKey,i.documentKey]}};function xt(n,e){let t=n.Tn-e.Tn;return t!==0?t:(t=Vm(n.En,e.En),t!==0?t:(t=Vm(n.dn,e.dn),t!==0?t:x.comparator(n.In,e.In)))}function Vm(n,e){for(let t=0;t<n.length&&t<e.length;++t){let r=n[t]-e[t];if(r!==0)return r}return n.length-e.length}function ko(n){return Rc()?(function(t){let r="";for(let i=0;i<t.length;i++)r+=String.fromCharCode(t[i]);return r})(n):n}function xm(n){return typeof n!="string"?n:(function(t){let r=new Uint8Array(t.length);for(let i=0;i<t.length;i++)r[i]=t.charCodeAt(i);return r})(n)}var oa=class{constructor(e){this.mn=new te(((t,r)=>ge.comparator(t.field,r.field))),this.collectionId=e.collectionGroup!=null?e.collectionGroup:e.path.lastSegment(),this.fn=e.orderBy,this.gn=[];for(let t of e.filters){let r=t;r.isInequality()?this.mn=this.mn.add(r):this.gn.push(r)}}get pn(){return this.mn.size>1}yn(e){if(F(e.collectionGroup===this.collectionId,49279),this.pn)return!1;let t=$u(e);if(t!==void 0&&!this.wn(t))return!1;let r=yn(e),i=new Set,s=0,o=0;for(;s<r.length&&this.wn(r[s]);++s)i=i.add(r[s].fieldPath.canonicalString());if(s===r.length)return!0;if(this.mn.size>0){let c=this.mn.getIterator().getNext();if(!i.has(c.field.canonicalString())){let u=r[s];if(!this.Sn(c,u)||!this.bn(this.fn[o++],u))return!1}++s}for(;s<r.length;++s){let c=r[s];if(o>=this.fn.length||!this.bn(this.fn[o++],c))return!1}return!0}Dn(){if(this.pn)return null;let e=new te(ge.comparator),t=[];for(let r of this.gn)if(!r.field.isKeyField())if(r.op==="array-contains"||r.op==="array-contains-any")t.push(new dr(r.field,2));else{if(e.has(r.field))continue;e=e.add(r.field),t.push(new dr(r.field,0))}for(let r of this.fn)r.field.isKeyField()||e.has(r.field)||(e=e.add(r.field),t.push(new dr(r.field,r.dir==="asc"?0:1)));return new _r(_r.UNKNOWN_ID,this.collectionId,t,Mi.empty())}wn(e){for(let t of this.gn)if(this.Sn(t,e))return!0;return!1}Sn(e,t){if(e===void 0||!e.field.isEqual(t.fieldPath))return!1;let r=e.op==="array-contains"||e.op==="array-contains-any";return t.kind===2===r}bn(e,t){return!!e.field.isEqual(t.fieldPath)&&(t.kind===0&&e.dir==="asc"||t.kind===1&&e.dir==="desc")}};function f_(n){if(F(n instanceof H||n instanceof Z,20012),n instanceof H){if(n instanceof $o){let t=n.value.arrayValue?.values?.map((r=>H.create(n.field,"==",r)))||[];return Z.create(t,"or")}return n}let e=n.filters.map((t=>f_(t)));return Z.create(e,n.op)}function fv(n){if(n.getFilters().length===0)return[];let e=Nl(f_(n));return F(p_(e),7391),Pl(e)||Cl(e)?[e]:e.getFilters()}function Pl(n){return n instanceof H}function Cl(n){return n instanceof Z&&Gh(n)}function p_(n){return Pl(n)||Cl(n)||(function(t){if(t instanceof Z&&nl(t)){for(let r of t.getFilters())if(!Pl(r)&&!Cl(r))return!1;return!0}return!1})(n)}function Nl(n){if(F(n instanceof H||n instanceof Z,34018),n instanceof H)return n;if(n.filters.length===1)return Nl(n.filters[0]);let e=n.filters.map((r=>Nl(r))),t=Z.create(e,n.op);return t=aa(t),p_(t)?t:(F(t instanceof Z,64498),F(Sr(t),40251),F(t.filters.length>1,57927),t.filters.reduce(((r,i)=>Wh(r,i))))}function Wh(n,e){let t;return F(n instanceof H||n instanceof Z,38388),F(e instanceof H||e instanceof Z,25473),t=n instanceof H?e instanceof H?(function(i,s){return Z.create([i,s],"and")})(n,e):Lm(n,e):e instanceof H?Lm(e,n):(function(i,s){if(F(i.filters.length>0&&s.filters.length>0,48005),Sr(i)&&Sr(s))return Mg(i,s.getFilters());let o=nl(i)?i:s,c=nl(i)?s:i,u=o.filters.map((h=>Wh(h,c)));return Z.create(u,"or")})(n,e),aa(t)}function Lm(n,e){if(Sr(e))return Mg(e,n.getFilters());{let t=e.filters.map((r=>Wh(n,r)));return Z.create(t,"or")}}function aa(n){if(F(n instanceof H||n instanceof Z,11850),n instanceof H)return n;let e=n.getFilters();if(e.length===1)return aa(e[0]);if(xg(n))return n;let t=e.map((i=>aa(i))),r=[];return t.forEach((i=>{i instanceof H?r.push(i):i instanceof Z&&(i.op===n.op?r.push(...i.filters):r.push(i))})),r.length===1?r[0]:Z.create(r,n.op)}var kl=class{constructor(){this.Cn=new Yi}addToCollectionParentIndex(e,t){return this.Cn.add(t),b.resolve()}getCollectionParents(e,t){return b.resolve(this.Cn.getEntries(t))}addFieldIndex(e,t){return b.resolve()}deleteFieldIndex(e,t){return b.resolve()}deleteAllFieldIndexes(e){return b.resolve()}createTargetIndexes(e,t){return b.resolve()}getDocumentsMatchingTarget(e,t){return b.resolve(null)}getIndexType(e,t){return b.resolve(0)}getFieldIndexes(e,t){return b.resolve([])}getNextCollectionGroupToUpdate(e){return b.resolve(null)}getMinOffset(e,t){return b.resolve(Ge.min())}getMinOffsetFromCollectionGroup(e,t){return b.resolve(Ge.min())}updateCollectionGroup(e,t,r){return b.resolve()}updateIndexEntries(e,t){return b.resolve()}},Yi=class{constructor(){this.index={}}add(e){let t=e.lastSegment(),r=e.popLast(),i=this.index[t]||new te(X.comparator),s=!i.has(r);return this.index[t]=i.add(r),s}has(e){let t=e.lastSegment(),r=e.popLast(),i=this.index[t];return i&&i.has(r)}getEntries(e){return(this.index[e]||new te(X.comparator)).toArray()}};var Mm="IndexedDbIndexManager",Eo=new Uint8Array(0),Dl=class{constructor(e,t){this.databaseId=t,this.vn=new Yi,this.Fn=new Qe((r=>xn(r)),((r,i)=>is(r,i))),this.uid=e.uid||""}addToCollectionParentIndex(e,t){if(!this.vn.has(t)){let r=t.lastSegment(),i=t.popLast();e.addOnCommittedListener((()=>{this.vn.add(t)}));let s={collectionId:r,parent:be(i)};return Fm(e).put(s)}return b.resolve()}getCollectionParents(e,t){let r=[],i=IDBKeyRange.bound([t,""],[lg(t),""],!1,!0);return Fm(e).J(i).next((s=>{for(let o of s){if(o.collectionId!==t)break;r.push(it(o.parent))}return r}))}addFieldIndex(e,t){let r=vi(e),i=(function(c){return{indexId:c.indexId,collectionGroup:c.collectionGroup,fields:c.fields.map((u=>[u.fieldPath.canonicalString(),u.kind]))}})(t);delete i.indexId;let s=r.add(i);if(t.indexState){let o=ir(e);return s.next((c=>{o.put(Nm(c,this.uid,t.indexState.sequenceNumber,t.indexState.offset))}))}return s.next()}deleteFieldIndex(e,t){let r=vi(e),i=ir(e),s=rr(e);return r.delete(t.indexId).next((()=>i.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0)))).next((()=>s.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0))))}deleteAllFieldIndexes(e){let t=vi(e),r=rr(e),i=ir(e);return t.Z().next((()=>r.Z())).next((()=>i.Z()))}createTargetIndexes(e,t){return b.forEach(this.Mn(t),(r=>this.getIndexType(e,r).next((i=>{if(i===0||i===1){let s=new oa(r).Dn();if(s!=null)return this.addFieldIndex(e,s)}}))))}getDocumentsMatchingTarget(e,t){let r=rr(e),i=!0,s=new Map;return b.forEach(this.Mn(t),(o=>this.xn(e,o).next((c=>{i&&(i=!!c),s.set(o,c)})))).next((()=>{if(i){let o=K(),c=[];return b.forEach(s,((u,h)=>{C(Mm,`Using index ${(function(U){return`id=${U.indexId}|cg=${U.collectionGroup}|f=${U.fields.map((ee=>`${ee.fieldPath}:${ee.kind}`)).join(",")}`})(u)} to execute ${xn(t)}`);let f=(function(U,ee){let Y=$u(ee);if(Y===void 0)return null;for(let Q of Wo(U,Y.fieldPath))switch(Q.op){case"array-contains-any":return Q.value.arrayValue.values||[];case"array-contains":return[Q.value]}return null})(h,u),m=(function(U,ee){let Y=new Map;for(let Q of yn(ee))for(let w of Wo(U,Q.fieldPath))switch(w.op){case"==":case"in":Y.set(Q.fieldPath.canonicalString(),w.value);break;case"not-in":case"!=":return Y.set(Q.fieldPath.canonicalString(),w.value),Array.from(Y.values())}return null})(h,u),_=(function(U,ee){let Y=[],Q=!0;for(let w of yn(ee)){let g=w.kind===0?_m(U,w.fieldPath,U.startAt):ym(U,w.fieldPath,U.startAt);Y.push(g.value),Q&&(Q=g.inclusive)}return new Kt(Y,Q)})(h,u),R=(function(U,ee){let Y=[],Q=!0;for(let w of yn(ee)){let g=w.kind===0?ym(U,w.fieldPath,U.endAt):_m(U,w.fieldPath,U.endAt);Y.push(g.value),Q&&(Q=g.inclusive)}return new Kt(Y,Q)})(h,u),k=this.On(u,h,_),O=this.On(u,h,R),N=this.Nn(u,h,m),j=this.Bn(u.indexId,f,k,_.inclusive,O,R.inclusive,N);return b.forEach(j,(q=>r.Y(q,t.limit).next((U=>{U.forEach((ee=>{let Y=x.fromSegments(ee.documentKey);o.has(Y)||(o=o.add(Y),c.push(Y))}))}))))})).next((()=>c))}return b.resolve(null)}))}Mn(e){let t=this.Fn.get(e);return t||(e.filters.length===0?t=[e]:t=fv(Z.create(e.filters,"and")).map((r=>hl(e.path,e.collectionGroup,e.orderBy,r.getFilters(),e.limit,e.startAt,e.endAt))),this.Fn.set(e,t),t)}Bn(e,t,r,i,s,o,c){let u=(t!=null?t.length:1)*Math.max(r.length,s.length),h=u/(t!=null?t.length:1),f=[];for(let m=0;m<u;++m){let _=t?this.Ln(t[m/h]):Eo,R=this.kn(e,_,r[m%h],i),k=this.qn(e,_,s[m%h],o),O=c.map((N=>this.kn(e,_,N,!0)));f.push(...this.createRange(R,k,O))}return f}kn(e,t,r,i){let s=new vn(e,x.empty(),t,r);return i?s:s.An()}qn(e,t,r,i){let s=new vn(e,x.empty(),t,r);return i?s.An():s}xn(e,t){let r=new oa(t),i=t.collectionGroup!=null?t.collectionGroup:t.path.lastSegment();return this.getFieldIndexes(e,i).next((s=>{let o=null;for(let c of s)r.yn(c)&&(!o||c.fields.length>o.fields.length)&&(o=c);return o}))}getIndexType(e,t){let r=2,i=this.Mn(t);return b.forEach(i,(s=>this.xn(e,s).next((o=>{o?r!==0&&o.fields.length<(function(u){let h=new te(ge.comparator),f=!1;for(let m of u.filters)for(let _ of m.getFlattenedFilters())_.field.isKeyField()||(_.op==="array-contains"||_.op==="array-contains-any"?f=!0:h=h.add(_.field));for(let m of u.orderBy)m.field.isKeyField()||(h=h.add(m.field));return h.size+(f?1:0)})(s)&&(r=1):r=0})))).next((()=>(function(o){return o.limit!==null})(t)&&i.length>1&&r===2?1:r))}Qn(e,t){let r=new Tn;for(let i of yn(e)){let s=t.data.field(i.fieldPath);if(s==null)return null;let o=r.Pn(i.kind);gt.Kt.Dt(s,o)}return r.un()}Ln(e){let t=new Tn;return gt.Kt.Dt(e,t.Pn(0)),t.un()}$n(e,t){let r=new Tn;return gt.Kt.Dt($i(this.databaseId,t),r.Pn((function(s){let o=yn(s);return o.length===0?0:o[o.length-1].kind})(e))),r.un()}Nn(e,t,r){if(r===null)return[];let i=[];i.push(new Tn);let s=0;for(let o of yn(e)){let c=r[s++];for(let u of i)if(this.Un(t,o.fieldPath)&&Ki(c))i=this.Kn(i,o,c);else{let h=u.Pn(o.kind);gt.Kt.Dt(c,h)}}return this.Wn(i)}On(e,t,r){return this.Nn(e,t,r.position)}Wn(e){let t=[];for(let r=0;r<e.length;++r)t[r]=e[r].un();return t}Kn(e,t,r){let i=[...e],s=[];for(let o of r.arrayValue.values||[])for(let c of i){let u=new Tn;u.seed(c.un()),gt.Kt.Dt(o,u.Pn(t.kind)),s.push(u)}return s}Un(e,t){return!!e.filters.find((r=>r instanceof H&&r.field.isEqual(t)&&(r.op==="in"||r.op==="not-in")))}getFieldIndexes(e,t){let r=vi(e),i=ir(e);return(t?r.J(Yu,IDBKeyRange.bound(t,t)):r.J()).next((s=>{let o=[];return b.forEach(s,(c=>i.get([c.indexId,this.uid]).next((u=>{o.push((function(f,m){let _=m?new Mi(m.sequenceNumber,new Ge(Fn(m.readTime),new x(it(m.documentKey)),m.largestBatchId)):Mi.empty(),R=f.fields.map((([k,O])=>new dr(ge.fromServerFormat(k),O)));return new _r(f.indexId,f.collectionGroup,R,_)})(c,u))})))).next((()=>o))}))}getNextCollectionGroupToUpdate(e){return this.getFieldIndexes(e).next((t=>t.length===0?null:(t.sort(((r,i)=>{let s=r.indexState.sequenceNumber-i.indexState.sequenceNumber;return s!==0?s:z(r.collectionGroup,i.collectionGroup)})),t[0].collectionGroup)))}updateCollectionGroup(e,t,r){let i=vi(e),s=ir(e);return this.Gn(e).next((o=>i.J(Yu,IDBKeyRange.bound(t,t)).next((c=>b.forEach(c,(u=>s.put(Nm(u.indexId,this.uid,o,r))))))))}updateIndexEntries(e,t){let r=new Map;return b.forEach(t,((i,s)=>{let o=r.get(i.collectionGroup);return(o?b.resolve(o):this.getFieldIndexes(e,i.collectionGroup)).next((c=>(r.set(i.collectionGroup,c),b.forEach(c,(u=>this.zn(e,i,u).next((h=>{let f=this.jn(s,u);return h.isEqual(f)?b.resolve():this.Jn(e,s,u,h,f)})))))))}))}Hn(e,t,r,i){return rr(e).put(i.Rn(this.uid,this.$n(r,t.key),t.key))}Yn(e,t,r,i){return rr(e).delete(i.Vn(this.uid,this.$n(r,t.key),t.key))}zn(e,t,r){let i=rr(e),s=new te(xt);return i.ee({index:wg,range:IDBKeyRange.only([r.indexId,this.uid,ko(this.$n(r,t))])},((o,c)=>{s=s.add(new vn(r.indexId,t,xm(c.arrayValue),xm(c.directionalValue)))})).next((()=>s))}jn(e,t){let r=new te(xt),i=this.Qn(t,e);if(i==null)return r;let s=$u(t);if(s!=null){let o=e.data.field(s.fieldPath);if(Ki(o))for(let c of o.arrayValue.values||[])r=r.add(new vn(t.indexId,e.key,this.Ln(c),i))}else r=r.add(new vn(t.indexId,e.key,Eo,i));return r}Jn(e,t,r,i,s){C(Mm,"Updating index entries for document '%s'",t.key);let o=[];return(function(u,h,f,m,_){let R=u.getIterator(),k=h.getIterator(),O=tr(R),N=tr(k);for(;O||N;){let j=!1,q=!1;if(O&&N){let U=f(O,N);U<0?q=!0:U>0&&(j=!0)}else O!=null?q=!0:j=!0;j?(m(N),N=tr(k)):q?(_(O),O=tr(R)):(O=tr(R),N=tr(k))}})(i,s,xt,(c=>{o.push(this.Hn(e,t,r,c))}),(c=>{o.push(this.Yn(e,t,r,c))})),b.waitFor(o)}Gn(e){let t=1;return ir(e).ee({index:Ig,reverse:!0,range:IDBKeyRange.upperBound([this.uid,Number.MAX_SAFE_INTEGER])},((r,i,s)=>{s.done(),t=i.sequenceNumber+1})).next((()=>t))}createRange(e,t,r){r=r.sort(((o,c)=>xt(o,c))).filter(((o,c,u)=>!c||xt(o,u[c-1])!==0));let i=[];i.push(e);for(let o of r){let c=xt(o,e),u=xt(o,t);if(c===0)i[0]=e.An();else if(c>0&&u<0)i.push(o),i.push(o.An());else if(u>0)break}i.push(t);let s=[];for(let o=0;o<i.length;o+=2){if(this.Zn(i[o],i[o+1]))return[];let c=i[o].Vn(this.uid,Eo,x.empty()),u=i[o+1].Vn(this.uid,Eo,x.empty());s.push(IDBKeyRange.bound(c,u))}return s}Zn(e,t){return xt(e,t)>0}getMinOffsetFromCollectionGroup(e,t){return this.getFieldIndexes(e,t).next(Um)}getMinOffset(e,t){return b.mapArray(this.Mn(t),(r=>this.xn(e,r).next((i=>i||L(44426))))).next(Um)}};function Fm(n){return ye(n,qi)}function rr(n){return ye(n,Ni)}function vi(n){return ye(n,Fh)}function ir(n){return ye(n,Ci)}function Um(n){F(n.length!==0,28825);let e=n[0].indexState.offset,t=e.largestBatchId;for(let r=1;r<n.length;r++){let i=n[r].indexState.offset;xh(i,e)<0&&(e=i),t<i.largestBatchId&&(t=i.largestBatchId)}return new Ge(e.readTime,e.documentKey,t)}var Bm={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},m_=41943040,Oe=class n{static withCacheSize(e){return new n(e,n.DEFAULT_COLLECTION_PERCENTILE,n.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,t,r){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=r}};function g_(n,e,t){let r=n.store(We),i=n.store(Ir),s=[],o=IDBKeyRange.only(t.batchId),c=0,u=r.ee({range:o},((f,m,_)=>(c++,_.delete())));s.push(u.next((()=>{F(c===1,47070,{batchId:t.batchId})})));let h=[];for(let f of t.mutations){let m=gg(e,f.key.path,t.batchId);s.push(i.delete(m)),h.push(f.key)}return b.waitFor(s).next((()=>h))}function ca(n){if(!n)return 0;let e;if(n.document)e=n.document;else if(n.unknownDocument)e=n.unknownDocument;else{if(!n.noDocument)throw L(14731);e=n.noDocument}return JSON.stringify(e).length}Oe.DEFAULT_COLLECTION_PERCENTILE=10,Oe.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,Oe.DEFAULT=new Oe(m_,Oe.DEFAULT_COLLECTION_PERCENTILE,Oe.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),Oe.DISABLED=new Oe(-1,0,0);var ua=class n{constructor(e,t,r,i){this.userId=e,this.serializer=t,this.indexManager=r,this.referenceDelegate=i,this.Xn={}}static wt(e,t,r,i){F(e.uid!=="",64387);let s=e.isAuthenticated()?e.uid:"";return new n(s,t,r,i)}checkEmpty(e){let t=!0,r=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return Lt(e).ee({index:An,range:r},((i,s,o)=>{t=!1,o.done()})).next((()=>t))}addMutationBatch(e,t,r,i){let s=lr(e),o=Lt(e);return o.add({}).next((c=>{F(typeof c=="number",49019);let u=new Hi(c,t,r,i),h=(function(R,k,O){let N=O.baseMutations.map((q=>na(R.yt,q))),j=O.mutations.map((q=>na(R.yt,q)));return{userId:k,batchId:O.batchId,localWriteTimeMs:O.localWriteTime.toMillis(),baseMutations:N,mutations:j}})(this.serializer,this.userId,u),f=[],m=new te(((_,R)=>z(_.canonicalString(),R.canonicalString())));for(let _ of i){let R=gg(this.userId,_.key.path,c);m=m.add(_.key.path.popLast()),f.push(o.put(h)),f.push(s.put(R,oT))}return m.forEach((_=>{f.push(this.indexManager.addToCollectionParentIndex(e,_))})),e.addOnCommittedListener((()=>{this.Xn[c]=u.keys()})),b.waitFor(f).next((()=>u))}))}lookupMutationBatch(e,t){return Lt(e).get(t).next((r=>r?(F(r.userId===this.userId,48,"Unexpected user for mutation batch",{userId:r.userId,batchId:t}),En(this.serializer,r)):null))}er(e,t){return this.Xn[t]?b.resolve(this.Xn[t]):this.lookupMutationBatch(e,t).next((r=>{if(r){let i=r.keys();return this.Xn[t]=i,i}return null}))}getNextMutationBatchAfterBatchId(e,t){let r=t+1,i=IDBKeyRange.lowerBound([this.userId,r]),s=null;return Lt(e).ee({index:An,range:i},((o,c,u)=>{c.userId===this.userId&&(F(c.batchId>=r,47524,{tr:r}),s=En(this.serializer,c)),u.done()})).next((()=>s))}getHighestUnacknowledgedBatchId(e){let t=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]),r=Pn;return Lt(e).ee({index:An,range:t,reverse:!0},((i,s,o)=>{r=s.batchId,o.done()})).next((()=>r))}getAllMutationBatches(e){let t=IDBKeyRange.bound([this.userId,Pn],[this.userId,Number.POSITIVE_INFINITY]);return Lt(e).J(An,t).next((r=>r.map((i=>En(this.serializer,i)))))}getAllMutationBatchesAffectingDocumentKey(e,t){let r=bo(this.userId,t.path),i=IDBKeyRange.lowerBound(r),s=[];return lr(e).ee({range:i},((o,c,u)=>{let[h,f,m]=o,_=it(f);if(h===this.userId&&t.path.isEqual(_))return Lt(e).get(m).next((R=>{if(!R)throw L(61480,{nr:o,batchId:m});F(R.userId===this.userId,10503,"Unexpected user for mutation batch",{userId:R.userId,batchId:m}),s.push(En(this.serializer,R))}));u.done()})).next((()=>s))}getAllMutationBatchesAffectingDocumentKeys(e,t){let r=new te(z),i=[];return t.forEach((s=>{let o=bo(this.userId,s.path),c=IDBKeyRange.lowerBound(o),u=lr(e).ee({range:c},((h,f,m)=>{let[_,R,k]=h,O=it(R);_===this.userId&&s.path.isEqual(O)?r=r.add(k):m.done()}));i.push(u)})),b.waitFor(i).next((()=>this.rr(e,r)))}getAllMutationBatchesAffectingQuery(e,t){let r=t.path,i=r.length+1,s=bo(this.userId,r),o=IDBKeyRange.lowerBound(s),c=new te(z);return lr(e).ee({range:o},((u,h,f)=>{let[m,_,R]=u,k=it(_);m===this.userId&&r.isPrefixOf(k)?k.length===i&&(c=c.add(R)):f.done()})).next((()=>this.rr(e,c)))}rr(e,t){let r=[],i=[];return t.forEach((s=>{i.push(Lt(e).get(s).next((o=>{if(o===null)throw L(35274,{batchId:s});F(o.userId===this.userId,9748,"Unexpected user for mutation batch",{userId:o.userId,batchId:s}),r.push(En(this.serializer,o))})))})),b.waitFor(i).next((()=>r))}removeMutationBatch(e,t){return g_(e.le,this.userId,t).next((r=>(e.addOnCommittedListener((()=>{this.ir(t.batchId)})),b.forEach(r,(i=>this.referenceDelegate.markPotentiallyOrphaned(e,i))))))}ir(e){delete this.Xn[e]}performConsistencyCheck(e){return this.checkEmpty(e).next((t=>{if(!t)return b.resolve();let r=IDBKeyRange.lowerBound((function(o){return[o]})(this.userId)),i=[];return lr(e).ee({range:r},((s,o,c)=>{if(s[0]===this.userId){let u=it(s[1]);i.push(u)}else c.done()})).next((()=>{F(i.length===0,56720,{sr:i.map((s=>s.canonicalString()))})}))}))}containsKey(e,t){return __(e,this.userId,t)}_r(e){return y_(e).get(this.userId).next((t=>t||{userId:this.userId,lastAcknowledgedBatchId:Pn,lastStreamToken:""}))}};function __(n,e,t){let r=bo(e,t.path),i=r[1],s=IDBKeyRange.lowerBound(r),o=!1;return lr(n).ee({range:s,X:!0},((c,u,h)=>{let[f,m,_]=c;f===e&&m===i&&(o=!0),h.done()})).next((()=>o))}function Lt(n){return ye(n,We)}function lr(n){return ye(n,Ir)}function y_(n){return ye(n,Ui)}var kr=class n{constructor(e){this.ar=e}next(){return this.ar+=2,this.ar}static ur(){return new n(0)}static cr(){return new n(-1)}};var Ol=class{constructor(e,t){this.referenceDelegate=e,this.serializer=t}allocateTargetId(e){return this.lr(e).next((t=>{let r=new kr(t.highestTargetId);return t.highestTargetId=r.next(),this.hr(e,t).next((()=>t.highestTargetId))}))}getLastRemoteSnapshotVersion(e){return this.lr(e).next((t=>B.fromTimestamp(new se(t.lastRemoteSnapshotVersion.seconds,t.lastRemoteSnapshotVersion.nanoseconds))))}getHighestSequenceNumber(e){return this.lr(e).next((t=>t.highestListenSequenceNumber))}setTargetsMetadata(e,t,r){return this.lr(e).next((i=>(i.highestListenSequenceNumber=t,r&&(i.lastRemoteSnapshotVersion=r.toTimestamp()),t>i.highestListenSequenceNumber&&(i.highestListenSequenceNumber=t),this.hr(e,i))))}addTargetData(e,t){return this.Pr(e,t).next((()=>this.lr(e).next((r=>(r.targetCount+=1,this.Tr(t,r),this.hr(e,r))))))}updateTargetData(e,t){return this.Pr(e,t)}removeTargetData(e,t){return this.removeMatchingKeysForTargetId(e,t.targetId).next((()=>sr(e).delete(t.targetId))).next((()=>this.lr(e))).next((r=>(F(r.targetCount>0,8065),r.targetCount-=1,this.hr(e,r))))}removeTargets(e,t,r){let i=0,s=[];return sr(e).ee(((o,c)=>{let u=Ri(c);u.sequenceNumber<=t&&r.get(u.targetId)===null&&(i++,s.push(this.removeTargetData(e,u)))})).next((()=>b.waitFor(s))).next((()=>i))}forEachTarget(e,t){return sr(e).ee(((r,i)=>{let s=Ri(i);t(s)}))}lr(e){return qm(e).get(Bo).next((t=>(F(t!==null,2888),t)))}hr(e,t){return qm(e).put(Bo,t)}Pr(e,t){return sr(e).put(h_(this.serializer,t))}Tr(e,t){let r=!1;return e.targetId>t.highestTargetId&&(t.highestTargetId=e.targetId,r=!0),e.sequenceNumber>t.highestListenSequenceNumber&&(t.highestListenSequenceNumber=e.sequenceNumber,r=!0),r}getTargetCount(e){return this.lr(e).next((t=>t.targetCount))}getTargetData(e,t){let r=xn(t),i=IDBKeyRange.bound([r,Number.NEGATIVE_INFINITY],[r,Number.POSITIVE_INFINITY]),s=null;return sr(e).ee({range:i,index:yg},((o,c,u)=>{let h=Ri(c);is(t,h.target)&&(s=h,u.done())})).next((()=>s))}addMatchingKeys(e,t,r){let i=[],s=Ft(e);return t.forEach((o=>{let c=be(o.path);i.push(s.put({targetId:r,path:c})),i.push(this.referenceDelegate.addReference(e,r,o))})),b.waitFor(i)}removeMatchingKeys(e,t,r){let i=Ft(e);return b.forEach(t,(s=>{let o=be(s.path);return b.waitFor([i.delete([r,o]),this.referenceDelegate.removeReference(e,r,s)])}))}removeMatchingKeysForTargetId(e,t){let r=Ft(e),i=IDBKeyRange.bound([t],[t+1],!1,!0);return r.delete(i)}getMatchingKeysForTargetId(e,t){let r=IDBKeyRange.bound([t],[t+1],!1,!0),i=Ft(e),s=K();return i.ee({range:r,X:!0},((o,c,u)=>{let h=it(o[1]),f=new x(h);s=s.add(f)})).next((()=>s))}containsKey(e,t){let r=be(t.path),i=IDBKeyRange.bound([r],[lg(r)],!1,!0),s=0;return Ft(e).ee({index:Mh,X:!0,range:i},(([o,c],u,h)=>{o!==0&&(s++,h.done())})).next((()=>s>0))}At(e,t){return sr(e).get(t).next((r=>r?Ri(r):null))}};function sr(n){return ye(n,wr)}function qm(n){return ye(n,Cn)}function Ft(n){return ye(n,Er)}var jm="LruGarbageCollector",pv=1048576;function zm([n,e],[t,r]){let i=z(n,t);return i===0?z(e,r):i}var Vl=class{constructor(e){this.Ir=e,this.buffer=new te(zm),this.Er=0}dr(){return++this.Er}Ar(e){let t=[e,this.dr()];if(this.buffer.size<this.Ir)this.buffer=this.buffer.add(t);else{let r=this.buffer.last();zm(t,r)<0&&(this.buffer=this.buffer.delete(r).add(t))}}get maxValue(){return this.buffer.last()[0]}},la=class{constructor(e,t,r){this.garbageCollector=e,this.asyncQueue=t,this.localStore=r,this.Rr=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Vr(6e4)}stop(){this.Rr&&(this.Rr.cancel(),this.Rr=null)}get started(){return this.Rr!==null}Vr(e){C(jm,`Garbage collection scheduled in ${e}ms`),this.Rr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,(async()=>{this.Rr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(t){tn(t)?C(jm,"Ignoring IndexedDB error during garbage collection: ",t):await qn(t)}await this.Vr(3e5)}))}},xl=class{constructor(e,t){this.mr=e,this.params=t}calculateTargetCount(e,t){return this.mr.gr(e).next((r=>Math.floor(t/100*r)))}nthSequenceNumber(e,t){if(t===0)return b.resolve(Ve.ce);let r=new Vl(t);return this.mr.forEachTarget(e,(i=>r.Ar(i.sequenceNumber))).next((()=>this.mr.pr(e,(i=>r.Ar(i))))).next((()=>r.maxValue))}removeTargets(e,t,r){return this.mr.removeTargets(e,t,r)}removeOrphanedDocuments(e,t){return this.mr.removeOrphanedDocuments(e,t)}collect(e,t){return this.params.cacheSizeCollectionThreshold===-1?(C("LruGarbageCollector","Garbage collection skipped; disabled"),b.resolve(Bm)):this.getCacheSize(e).next((r=>r<this.params.cacheSizeCollectionThreshold?(C("LruGarbageCollector",`Garbage collection skipped; Cache size ${r} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),Bm):this.yr(e,t)))}getCacheSize(e){return this.mr.getCacheSize(e)}yr(e,t){let r,i,s,o,c,u,h,f=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next((m=>(m>this.params.maximumSequenceNumbersToCollect?(C("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${m}`),i=this.params.maximumSequenceNumbersToCollect):i=m,o=Date.now(),this.nthSequenceNumber(e,i)))).next((m=>(r=m,c=Date.now(),this.removeTargets(e,r,t)))).next((m=>(s=m,u=Date.now(),this.removeOrphanedDocuments(e,r)))).next((m=>(h=Date.now(),or()<=W.DEBUG&&C("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${o-f}ms
	Determined least recently used ${i} in `+(c-o)+`ms
	Removed ${s} targets in `+(u-c)+`ms
	Removed ${m} documents in `+(h-u)+`ms
Total Duration: ${h-f}ms`),b.resolve({didRun:!0,sequenceNumbersCollected:i,targetsRemoved:s,documentsRemoved:m}))))}};function I_(n,e){return new xl(n,e)}var Ll=class{constructor(e,t){this.db=e,this.garbageCollector=I_(this,t)}gr(e){let t=this.wr(e);return this.db.getTargetCache().getTargetCount(e).next((r=>t.next((i=>r+i))))}wr(e){let t=0;return this.pr(e,(r=>{t++})).next((()=>t))}forEachTarget(e,t){return this.db.getTargetCache().forEachTarget(e,t)}pr(e,t){return this.Sr(e,((r,i)=>t(i)))}addReference(e,t,r){return To(e,r)}removeReference(e,t,r){return To(e,r)}removeTargets(e,t,r){return this.db.getTargetCache().removeTargets(e,t,r)}markPotentiallyOrphaned(e,t){return To(e,t)}br(e,t){return(function(i,s){let o=!1;return y_(i).te((c=>__(i,c,s).next((u=>(u&&(o=!0),b.resolve(!u)))))).next((()=>o))})(e,t)}removeOrphanedDocuments(e,t){let r=this.db.getRemoteDocumentCache().newChangeBuffer(),i=[],s=0;return this.Sr(e,((o,c)=>{if(c<=t){let u=this.br(e,o).next((h=>{if(!h)return s++,r.getEntry(e,o).next((()=>(r.removeEntry(o,B.min()),Ft(e).delete((function(m){return[0,be(m.path)]})(o)))))}));i.push(u)}})).next((()=>b.waitFor(i))).next((()=>r.apply(e))).next((()=>s))}removeTarget(e,t){let r=t.withSequenceNumber(e.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(e,r)}updateLimboDocument(e,t){return To(e,t)}Sr(e,t){let r=Ft(e),i,s=Ve.ce;return r.ee({index:Mh},(([o,c],{path:u,sequenceNumber:h})=>{o===0?(s!==Ve.ce&&t(new x(it(i)),s),s=h,i=u):s=Ve.ce})).next((()=>{s!==Ve.ce&&t(new x(it(i)),s)}))}getCacheSize(e){return this.db.getRemoteDocumentCache().getSize(e)}};function To(n,e){return Ft(n).put((function(r,i){return{targetId:0,path:be(r.path),sequenceNumber:i}})(e,n.currentSequenceNumber))}var ha=class{constructor(){this.changes=new Qe((e=>e.toString()),((e,t)=>e.isEqual(t))),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,Ee.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();let r=this.changes.get(t);return r!==void 0?b.resolve(r):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}};var Ml=class{constructor(e){this.serializer=e}setIndexManager(e){this.indexManager=e}addEntry(e,t,r){return _n(e).put(r)}removeEntry(e,t,r){return _n(e).delete((function(s,o){let c=s.path.toArray();return[c.slice(0,c.length-2),c[c.length-2],ia(o),c[c.length-1]]})(t,r))}updateMetadata(e,t){return this.getMetadata(e).next((r=>(r.byteSize+=t,this.Dr(e,r))))}getEntry(e,t){let r=Ee.newInvalidDocument(t);return _n(e).ee({index:So,range:IDBKeyRange.only(Ai(t))},((i,s)=>{r=this.Cr(t,s)})).next((()=>r))}vr(e,t){let r={size:0,document:Ee.newInvalidDocument(t)};return _n(e).ee({index:So,range:IDBKeyRange.only(Ai(t))},((i,s)=>{r={document:this.Cr(t,s),size:ca(s)}})).next((()=>r))}getEntries(e,t){let r=Ue();return this.Fr(e,t,((i,s)=>{let o=this.Cr(i,s);r=r.insert(i,o)})).next((()=>r))}Mr(e,t){let r=Ue(),i=new oe(x.comparator);return this.Fr(e,t,((s,o)=>{let c=this.Cr(s,o);r=r.insert(s,c),i=i.insert(s,ca(o))})).next((()=>({documents:r,Or:i})))}Fr(e,t,r){if(t.isEmpty())return b.resolve();let i=new te(Km);t.forEach((u=>i=i.add(u)));let s=IDBKeyRange.bound(Ai(i.first()),Ai(i.last())),o=i.getIterator(),c=o.getNext();return _n(e).ee({index:So,range:s},((u,h,f)=>{let m=x.fromSegments([...h.prefixPath,h.collectionGroup,h.documentId]);for(;c&&Km(c,m)<0;)r(c,null),c=o.getNext();c&&c.isEqual(m)&&(r(c,h),c=o.hasNext()?o.getNext():null),c?f.j(Ai(c)):f.done()})).next((()=>{for(;c;)r(c,null),c=o.hasNext()?o.getNext():null}))}getDocumentsMatchingQuery(e,t,r,i,s){let o=t.path,c=[o.popLast().toArray(),o.lastSegment(),ia(r.readTime),r.documentKey.path.isEmpty()?"":r.documentKey.path.lastSegment()],u=[o.popLast().toArray(),o.lastSegment(),[Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],""];return _n(e).J(IDBKeyRange.bound(c,u,!0)).next((h=>{s?.incrementDocumentReadCount(h.length);let f=Ue();for(let m of h){let _=this.Cr(x.fromSegments(m.prefixPath.concat(m.collectionGroup,m.documentId)),m);_.isFoundDocument()&&(ss(t,_)||i.has(_.key))&&(f=f.insert(_.key,_))}return f}))}getAllFromCollectionGroup(e,t,r,i){let s=Ue(),o=$m(t,r),c=$m(t,Ge.max());return _n(e).ee({index:_g,range:IDBKeyRange.bound(o,c,!0)},((u,h,f)=>{let m=this.Cr(x.fromSegments(h.prefixPath.concat(h.collectionGroup,h.documentId)),h);s=s.insert(m.key,m),s.size===i&&f.done()})).next((()=>s))}newChangeBuffer(e){return new Fl(this,!!e&&e.trackRemovals)}getSize(e){return this.getMetadata(e).next((t=>t.byteSize))}getMetadata(e){return Gm(e).get(Ju).next((t=>(F(!!t,20021),t)))}Dr(e,t){return Gm(e).put(Ju,t)}Cr(e,t){if(t){let r=hv(this.serializer,t);if(!(r.isNoDocument()&&r.version.isEqual(B.min())))return r}return Ee.newInvalidDocument(e)}};function w_(n){return new Ml(n)}var Fl=class extends ha{constructor(e,t){super(),this.Nr=e,this.trackRemovals=t,this.Br=new Qe((r=>r.toString()),((r,i)=>r.isEqual(i)))}applyChanges(e){let t=[],r=0,i=new te(((s,o)=>z(s.canonicalString(),o.canonicalString())));return this.changes.forEach(((s,o)=>{let c=this.Br.get(s);if(t.push(this.Nr.removeEntry(e,s,c.readTime)),o.isValidDocument()){let u=Pm(this.Nr.serializer,o);i=i.add(s.path.popLast());let h=ca(u);r+=h-c.size,t.push(this.Nr.addEntry(e,s,u))}else if(r-=c.size,this.trackRemovals){let u=Pm(this.Nr.serializer,o.convertToNoDocument(B.min()));t.push(this.Nr.addEntry(e,s,u))}})),i.forEach((s=>{t.push(this.Nr.indexManager.addToCollectionParentIndex(e,s))})),t.push(this.Nr.updateMetadata(e,r)),b.waitFor(t)}getFromCache(e,t){return this.Nr.vr(e,t).next((r=>(this.Br.set(t,{size:r.size,readTime:r.document.readTime}),r.document)))}getAllFromCache(e,t){return this.Nr.Mr(e,t).next((({documents:r,Or:i})=>(i.forEach(((s,o)=>{this.Br.set(s,{size:o,readTime:r.get(s).readTime})})),r)))}};function Gm(n){return ye(n,Bi)}function _n(n){return ye(n,Uo)}function Ai(n){let e=n.path.toArray();return[e.slice(0,e.length-2),e[e.length-2],e[e.length-1]]}function $m(n,e){let t=e.documentKey.path.toArray();return[n,ia(e.readTime),t.slice(0,t.length-2),t.length>0?t[t.length-1]:""]}function Km(n,e){let t=n.path.toArray(),r=e.path.toArray(),i=0;for(let s=0;s<t.length-2&&s<r.length-2;++s)if(i=z(t[s],r[s]),i)return i;return i=z(t.length,r.length),i||(i=z(t[t.length-2],r[r.length-2]),i||z(t[t.length-1],r[r.length-1]))}var Ul=class{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}};var da=class{constructor(e,t,r,i){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=r,this.indexManager=i}getDocument(e,t){let r=null;return this.documentOverlayCache.getOverlay(e,t).next((i=>(r=i,this.remoteDocumentCache.getEntry(e,t)))).next((i=>(r!==null&&Vi(r.mutation,i,Fe.empty(),se.now()),i)))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next((r=>this.getLocalViewOfDocuments(e,r,K()).next((()=>r))))}getLocalViewOfDocuments(e,t,r=K()){let i=st();return this.populateOverlays(e,i,t).next((()=>this.computeViews(e,t,i,r).next((s=>{let o=Si();return s.forEach(((c,u)=>{o=o.insert(c,u.overlayedDocument)})),o}))))}getOverlayedDocuments(e,t){let r=st();return this.populateOverlays(e,r,t).next((()=>this.computeViews(e,t,r,K())))}populateOverlays(e,t,r){let i=[];return r.forEach((s=>{t.has(s)||i.push(s)})),this.documentOverlayCache.getOverlays(e,i).next((s=>{s.forEach(((o,c)=>{t.set(o,c)}))}))}computeViews(e,t,r,i){let s=Ue(),o=Oi(),c=(function(){return Oi()})();return t.forEach(((u,h)=>{let f=r.get(h.key);i.has(h.key)&&(f===void 0||f.mutation instanceof Je)?s=s.insert(h.key,h):f!==void 0?(o.set(h.key,f.mutation.getFieldMask()),Vi(f.mutation,h,f.mutation.getFieldMask(),se.now())):o.set(h.key,Fe.empty())})),this.recalculateAndSaveOverlays(e,s).next((u=>(u.forEach(((h,f)=>o.set(h,f))),t.forEach(((h,f)=>c.set(h,new Ul(f,o.get(h)??null)))),c)))}recalculateAndSaveOverlays(e,t){let r=Oi(),i=new oe(((o,c)=>o-c)),s=K();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next((o=>{for(let c of o)c.keys().forEach((u=>{let h=t.get(u);if(h===null)return;let f=r.get(u)||Fe.empty();f=c.applyToLocalView(h,f),r.set(u,f);let m=(i.get(c.batchId)||K()).add(u);i=i.insert(c.batchId,m)}))})).next((()=>{let o=[],c=i.getReverseIterator();for(;c.hasNext();){let u=c.getNext(),h=u.key,f=u.value,m=$g();f.forEach((_=>{if(!s.has(_)){let R=Yg(t.get(_),r.get(_));R!==null&&m.set(_,R),s=s.add(_)}})),o.push(this.documentOverlayCache.saveOverlays(e,h,m))}return b.waitFor(o)})).next((()=>r))}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next((r=>this.recalculateAndSaveOverlays(e,r)))}getDocumentsMatchingQuery(e,t,r,i){return(function(o){return x.isDocumentKey(o.path)&&o.collectionGroup===null&&o.filters.length===0})(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):Bg(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,r,i):this.getDocumentsMatchingCollectionQuery(e,t,r,i)}getNextDocuments(e,t,r,i){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,r,i).next((s=>{let o=i-s.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,r.largestBatchId,i-s.size):b.resolve(st()),c=Li,u=s;return o.next((h=>b.forEach(h,((f,m)=>(c<m.largestBatchId&&(c=m.largestBatchId),s.get(f)?b.resolve():this.remoteDocumentCache.getEntry(e,f).next((_=>{u=u.insert(f,_)}))))).next((()=>this.populateOverlays(e,h,s))).next((()=>this.computeViews(e,u,h,K()))).next((f=>({batchId:c,changes:Gg(f)})))))}))}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new x(t)).next((r=>{let i=Si();return r.isFoundDocument()&&(i=i.insert(r.key,r)),i}))}getDocumentsMatchingCollectionGroupQuery(e,t,r,i){let s=t.collectionGroup,o=Si();return this.indexManager.getCollectionParents(e,s).next((c=>b.forEach(c,(u=>{let h=(function(m,_){return new Wt(_,null,m.explicitOrderBy.slice(),m.filters.slice(),m.limit,m.limitType,m.startAt,m.endAt)})(t,u.child(s));return this.getDocumentsMatchingCollectionQuery(e,h,r,i).next((f=>{f.forEach(((m,_)=>{o=o.insert(m,_)}))}))})).next((()=>o))))}getDocumentsMatchingCollectionQuery(e,t,r,i){let s;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,r.largestBatchId).next((o=>(s=o,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,r,s,i)))).next((o=>{s.forEach(((u,h)=>{let f=h.getKey();o.get(f)===null&&(o=o.insert(f,Ee.newInvalidDocument(f)))}));let c=Si();return o.forEach(((u,h)=>{let f=s.get(u);f!==void 0&&Vi(f.mutation,h,Fe.empty(),se.now()),ss(t,h)&&(c=c.insert(u,h))})),c}))}};var Bl=class{constructor(e){this.serializer=e,this.Lr=new Map,this.kr=new Map}getBundleMetadata(e,t){return b.resolve(this.Lr.get(t))}saveBundleMetadata(e,t){return this.Lr.set(t.id,(function(i){return{id:i.id,version:i.version,createTime:Ne(i.createTime)}})(t)),b.resolve()}getNamedQuery(e,t){return b.resolve(this.kr.get(t))}saveNamedQuery(e,t){return this.kr.set(t.name,(function(i){return{name:i.name,query:d_(i.bundledQuery),readTime:Ne(i.readTime)}})(t)),b.resolve()}};var ql=class{constructor(){this.overlays=new oe(x.comparator),this.qr=new Map}getOverlay(e,t){return b.resolve(this.overlays.get(t))}getOverlays(e,t){let r=st();return b.forEach(t,(i=>this.getOverlay(e,i).next((s=>{s!==null&&r.set(i,s)})))).next((()=>r))}saveOverlays(e,t,r){return r.forEach(((i,s)=>{this.St(e,t,s)})),b.resolve()}removeOverlaysForBatchId(e,t,r){let i=this.qr.get(r);return i!==void 0&&(i.forEach((s=>this.overlays=this.overlays.remove(s))),this.qr.delete(r)),b.resolve()}getOverlaysForCollection(e,t,r){let i=st(),s=t.length+1,o=new x(t.child("")),c=this.overlays.getIteratorFrom(o);for(;c.hasNext();){let u=c.getNext().value,h=u.getKey();if(!t.isPrefixOf(h.path))break;h.path.length===s&&u.largestBatchId>r&&i.set(u.getKey(),u)}return b.resolve(i)}getOverlaysForCollectionGroup(e,t,r,i){let s=new oe(((h,f)=>h-f)),o=this.overlays.getIterator();for(;o.hasNext();){let h=o.getNext().value;if(h.getKey().getCollectionGroup()===t&&h.largestBatchId>r){let f=s.get(h.largestBatchId);f===null&&(f=st(),s=s.insert(h.largestBatchId,f)),f.set(h.getKey(),h)}}let c=st(),u=s.getIterator();for(;u.hasNext()&&(u.getNext().value.forEach(((h,f)=>c.set(h,f))),!(c.size()>=i)););return b.resolve(c)}St(e,t,r){let i=this.overlays.get(r.key);if(i!==null){let o=this.qr.get(i.largestBatchId).delete(r.key);this.qr.set(i.largestBatchId,o)}this.overlays=this.overlays.insert(r.key,new Qi(t,r));let s=this.qr.get(t);s===void 0&&(s=K(),this.qr.set(t,s)),this.qr.set(t,s.add(r.key))}};var jl=class{constructor(){this.sessionToken=_e.EMPTY_BYTE_STRING}getSessionToken(e){return b.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,b.resolve()}};var Xi=class{constructor(){this.Qr=new te(he.$r),this.Ur=new te(he.Kr)}isEmpty(){return this.Qr.isEmpty()}addReference(e,t){let r=new he(e,t);this.Qr=this.Qr.add(r),this.Ur=this.Ur.add(r)}Wr(e,t){e.forEach((r=>this.addReference(r,t)))}removeReference(e,t){this.Gr(new he(e,t))}zr(e,t){e.forEach((r=>this.removeReference(r,t)))}jr(e){let t=new x(new X([])),r=new he(t,e),i=new he(t,e+1),s=[];return this.Ur.forEachInRange([r,i],(o=>{this.Gr(o),s.push(o.key)})),s}Jr(){this.Qr.forEach((e=>this.Gr(e)))}Gr(e){this.Qr=this.Qr.delete(e),this.Ur=this.Ur.delete(e)}Hr(e){let t=new x(new X([])),r=new he(t,e),i=new he(t,e+1),s=K();return this.Ur.forEachInRange([r,i],(o=>{s=s.add(o.key)})),s}containsKey(e){let t=new he(e,0),r=this.Qr.firstAfterOrEqual(t);return r!==null&&e.isEqual(r.key)}},he=class{constructor(e,t){this.key=e,this.Yr=t}static $r(e,t){return x.comparator(e.key,t.key)||z(e.Yr,t.Yr)}static Kr(e,t){return z(e.Yr,t.Yr)||x.comparator(e.key,t.key)}};var zl=class{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.tr=1,this.Zr=new te(he.$r)}checkEmpty(e){return b.resolve(this.mutationQueue.length===0)}addMutationBatch(e,t,r,i){let s=this.tr;this.tr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];let o=new Hi(s,t,r,i);this.mutationQueue.push(o);for(let c of i)this.Zr=this.Zr.add(new he(c.key,s)),this.indexManager.addToCollectionParentIndex(e,c.key.path.popLast());return b.resolve(o)}lookupMutationBatch(e,t){return b.resolve(this.Xr(t))}getNextMutationBatchAfterBatchId(e,t){let r=t+1,i=this.ei(r),s=i<0?0:i;return b.resolve(this.mutationQueue.length>s?this.mutationQueue[s]:null)}getHighestUnacknowledgedBatchId(){return b.resolve(this.mutationQueue.length===0?Pn:this.tr-1)}getAllMutationBatches(e){return b.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){let r=new he(t,0),i=new he(t,Number.POSITIVE_INFINITY),s=[];return this.Zr.forEachInRange([r,i],(o=>{let c=this.Xr(o.Yr);s.push(c)})),b.resolve(s)}getAllMutationBatchesAffectingDocumentKeys(e,t){let r=new te(z);return t.forEach((i=>{let s=new he(i,0),o=new he(i,Number.POSITIVE_INFINITY);this.Zr.forEachInRange([s,o],(c=>{r=r.add(c.Yr)}))})),b.resolve(this.ti(r))}getAllMutationBatchesAffectingQuery(e,t){let r=t.path,i=r.length+1,s=r;x.isDocumentKey(s)||(s=s.child(""));let o=new he(new x(s),0),c=new te(z);return this.Zr.forEachWhile((u=>{let h=u.key.path;return!!r.isPrefixOf(h)&&(h.length===i&&(c=c.add(u.Yr)),!0)}),o),b.resolve(this.ti(c))}ti(e){let t=[];return e.forEach((r=>{let i=this.Xr(r);i!==null&&t.push(i)})),t}removeMutationBatch(e,t){F(this.ni(t.batchId,"removed")===0,55003),this.mutationQueue.shift();let r=this.Zr;return b.forEach(t.mutations,(i=>{let s=new he(i.key,t.batchId);return r=r.delete(s),this.referenceDelegate.markPotentiallyOrphaned(e,i.key)})).next((()=>{this.Zr=r}))}ir(e){}containsKey(e,t){let r=new he(t,0),i=this.Zr.firstAfterOrEqual(r);return b.resolve(t.isEqual(i&&i.key))}performConsistencyCheck(e){return this.mutationQueue.length,b.resolve()}ni(e,t){return this.ei(e)}ei(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Xr(e){let t=this.ei(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}};var Gl=class{constructor(e){this.ri=e,this.docs=(function(){return new oe(x.comparator)})(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){let r=t.key,i=this.docs.get(r),s=i?i.size:0,o=this.ri(t);return this.docs=this.docs.insert(r,{document:t.mutableCopy(),size:o}),this.size+=o-s,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){let t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){let r=this.docs.get(t);return b.resolve(r?r.document.mutableCopy():Ee.newInvalidDocument(t))}getEntries(e,t){let r=Ue();return t.forEach((i=>{let s=this.docs.get(i);r=r.insert(i,s?s.document.mutableCopy():Ee.newInvalidDocument(i))})),b.resolve(r)}getDocumentsMatchingQuery(e,t,r,i){let s=Ue(),o=t.path,c=new x(o.child("__id-9223372036854775808__")),u=this.docs.getIteratorFrom(c);for(;u.hasNext();){let{key:h,value:{document:f}}=u.getNext();if(!o.isPrefixOf(h.path))break;h.path.length>o.length+1||xh(fg(f),r)<=0||(i.has(f.key)||ss(t,f))&&(s=s.insert(f.key,f.mutableCopy()))}return b.resolve(s)}getAllFromCollectionGroup(e,t,r,i){L(9500)}ii(e,t){return b.forEach(this.docs,(r=>t(r)))}newChangeBuffer(e){return new $l(this)}getSize(e){return b.resolve(this.size)}},$l=class extends ha{constructor(e){super(),this.Nr=e}applyChanges(e){let t=[];return this.changes.forEach(((r,i)=>{i.isValidDocument()?t.push(this.Nr.addEntry(e,i)):this.Nr.removeEntry(r)})),b.waitFor(t)}getFromCache(e,t){return this.Nr.getEntry(e,t)}getAllFromCache(e,t){return this.Nr.getEntries(e,t)}};var Kl=class{constructor(e){this.persistence=e,this.si=new Qe((t=>xn(t)),is),this.lastRemoteSnapshotVersion=B.min(),this.highestTargetId=0,this.oi=0,this._i=new Xi,this.targetCount=0,this.ai=kr.ur()}forEachTarget(e,t){return this.si.forEach(((r,i)=>t(i))),b.resolve()}getLastRemoteSnapshotVersion(e){return b.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return b.resolve(this.oi)}allocateTargetId(e){return this.highestTargetId=this.ai.next(),b.resolve(this.highestTargetId)}setTargetsMetadata(e,t,r){return r&&(this.lastRemoteSnapshotVersion=r),t>this.oi&&(this.oi=t),b.resolve()}Pr(e){this.si.set(e.target,e);let t=e.targetId;t>this.highestTargetId&&(this.ai=new kr(t),this.highestTargetId=t),e.sequenceNumber>this.oi&&(this.oi=e.sequenceNumber)}addTargetData(e,t){return this.Pr(t),this.targetCount+=1,b.resolve()}updateTargetData(e,t){return this.Pr(t),b.resolve()}removeTargetData(e,t){return this.si.delete(t.target),this._i.jr(t.targetId),this.targetCount-=1,b.resolve()}removeTargets(e,t,r){let i=0,s=[];return this.si.forEach(((o,c)=>{c.sequenceNumber<=t&&r.get(c.targetId)===null&&(this.si.delete(o),s.push(this.removeMatchingKeysForTargetId(e,c.targetId)),i++)})),b.waitFor(s).next((()=>i))}getTargetCount(e){return b.resolve(this.targetCount)}getTargetData(e,t){let r=this.si.get(t)||null;return b.resolve(r)}addMatchingKeys(e,t,r){return this._i.Wr(t,r),b.resolve()}removeMatchingKeys(e,t,r){this._i.zr(t,r);let i=this.persistence.referenceDelegate,s=[];return i&&t.forEach((o=>{s.push(i.markPotentiallyOrphaned(e,o))})),b.waitFor(s)}removeMatchingKeysForTargetId(e,t){return this._i.jr(t),b.resolve()}getMatchingKeysForTargetId(e,t){let r=this._i.Hr(t);return b.resolve(r)}containsKey(e,t){return b.resolve(this._i.containsKey(t))}};var Zi=class{constructor(e,t){this.ui={},this.overlays={},this.ci=new Ve(0),this.li=!1,this.li=!0,this.hi=new jl,this.referenceDelegate=e(this),this.Pi=new Kl(this),this.indexManager=new kl,this.remoteDocumentCache=(function(i){return new Gl(i)})((r=>this.referenceDelegate.Ti(r))),this.serializer=new ra(t),this.Ii=new Bl(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.li=!1,Promise.resolve()}get started(){return this.li}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new ql,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let r=this.ui[e.toKey()];return r||(r=new zl(t,this.referenceDelegate),this.ui[e.toKey()]=r),r}getGlobalsCache(){return this.hi}getTargetCache(){return this.Pi}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ii}runTransaction(e,t,r){C("MemoryPersistence","Starting transaction:",e);let i=new Wl(this.ci.next());return this.referenceDelegate.Ei(),r(i).next((s=>this.referenceDelegate.di(i).next((()=>s)))).toPromise().then((s=>(i.raiseOnCommittedEvent(),s)))}Ai(e,t){return b.or(Object.values(this.ui).map((r=>()=>r.containsKey(e,t))))}},Wl=class extends Lo{constructor(e){super(),this.currentSequenceNumber=e}},fa=class n{constructor(e){this.persistence=e,this.Ri=new Xi,this.Vi=null}static mi(e){return new n(e)}get fi(){if(this.Vi)return this.Vi;throw L(60996)}addReference(e,t,r){return this.Ri.addReference(r,t),this.fi.delete(r.toString()),b.resolve()}removeReference(e,t,r){return this.Ri.removeReference(r,t),this.fi.add(r.toString()),b.resolve()}markPotentiallyOrphaned(e,t){return this.fi.add(t.toString()),b.resolve()}removeTarget(e,t){this.Ri.jr(t.targetId).forEach((i=>this.fi.add(i.toString())));let r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,t.targetId).next((i=>{i.forEach((s=>this.fi.add(s.toString())))})).next((()=>r.removeTargetData(e,t)))}Ei(){this.Vi=new Set}di(e){let t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return b.forEach(this.fi,(r=>{let i=x.fromPath(r);return this.gi(e,i).next((s=>{s||t.removeEntry(i,B.min())}))})).next((()=>(this.Vi=null,t.apply(e))))}updateLimboDocument(e,t){return this.gi(e,t).next((r=>{r?this.fi.delete(t.toString()):this.fi.add(t.toString())}))}Ti(e){return 0}gi(e,t){return b.or([()=>b.resolve(this.Ri.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Ai(e,t)])}},pa=class n{constructor(e,t){this.persistence=e,this.pi=new Qe((r=>be(r.path)),((r,i)=>r.isEqual(i))),this.garbageCollector=I_(this,t)}static mi(e,t){return new n(e,t)}Ei(){}di(e){return b.resolve()}forEachTarget(e,t){return this.persistence.getTargetCache().forEachTarget(e,t)}gr(e){let t=this.wr(e);return this.persistence.getTargetCache().getTargetCount(e).next((r=>t.next((i=>r+i))))}wr(e){let t=0;return this.pr(e,(r=>{t++})).next((()=>t))}pr(e,t){return b.forEach(this.pi,((r,i)=>this.br(e,r,i).next((s=>s?b.resolve():t(i)))))}removeTargets(e,t,r){return this.persistence.getTargetCache().removeTargets(e,t,r)}removeOrphanedDocuments(e,t){let r=0,i=this.persistence.getRemoteDocumentCache(),s=i.newChangeBuffer();return i.ii(e,(o=>this.br(e,o,t).next((c=>{c||(r++,s.removeEntry(o,B.min()))})))).next((()=>s.apply(e))).next((()=>r))}markPotentiallyOrphaned(e,t){return this.pi.set(t,e.currentSequenceNumber),b.resolve()}removeTarget(e,t){let r=t.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,r)}addReference(e,t,r){return this.pi.set(r,e.currentSequenceNumber),b.resolve()}removeReference(e,t,r){return this.pi.set(r,e.currentSequenceNumber),b.resolve()}updateLimboDocument(e,t){return this.pi.set(t,e.currentSequenceNumber),b.resolve()}Ti(e){let t=e.key.toString().length;return e.isFoundDocument()&&(t+=Po(e.data.value)),t}br(e,t,r){return b.or([()=>this.persistence.Ai(e,t),()=>this.persistence.getTargetCache().containsKey(e,t),()=>{let i=this.pi.get(t);return b.resolve(i!==void 0&&i>r)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}};var Hl=class{constructor(e){this.serializer=e}k(e,t,r,i){let s=new Mo("createOrUpgrade",t);r<1&&i>=1&&((function(u){u.createObjectStore(rs)})(e),(function(u){u.createObjectStore(Ui,{keyPath:sT}),u.createObjectStore(We,{keyPath:om,autoIncrement:!0}).createIndex(An,am,{unique:!0}),u.createObjectStore(Ir)})(e),Wm(e),(function(u){u.createObjectStore(In)})(e));let o=b.resolve();return r<3&&i>=3&&(r!==0&&((function(u){u.deleteObjectStore(Er),u.deleteObjectStore(wr),u.deleteObjectStore(Cn)})(e),Wm(e)),o=o.next((()=>(function(u){let h=u.store(Cn),f={highestTargetId:0,highestListenSequenceNumber:0,lastRemoteSnapshotVersion:B.min().toTimestamp(),targetCount:0};return h.put(Bo,f)})(s)))),r<4&&i>=4&&(r!==0&&(o=o.next((()=>(function(u,h){return h.store(We).J().next((m=>{u.deleteObjectStore(We),u.createObjectStore(We,{keyPath:om,autoIncrement:!0}).createIndex(An,am,{unique:!0});let _=h.store(We),R=m.map((k=>_.put(k)));return b.waitFor(R)}))})(e,s)))),o=o.next((()=>{(function(u){u.createObjectStore(Tr,{keyPath:pT})})(e)}))),r<5&&i>=5&&(o=o.next((()=>this.yi(s)))),r<6&&i>=6&&(o=o.next((()=>((function(u){u.createObjectStore(Bi)})(e),this.wi(s))))),r<7&&i>=7&&(o=o.next((()=>this.Si(s)))),r<8&&i>=8&&(o=o.next((()=>this.bi(e,s)))),r<9&&i>=9&&(o=o.next((()=>{(function(u){u.objectStoreNames.contains("remoteDocumentChanges")&&u.deleteObjectStore("remoteDocumentChanges")})(e)}))),r<10&&i>=10&&(o=o.next((()=>this.Di(s)))),r<11&&i>=11&&(o=o.next((()=>{(function(u){u.createObjectStore(Ma,{keyPath:mT})})(e),(function(u){u.createObjectStore(Fa,{keyPath:gT})})(e)}))),r<12&&i>=12&&(o=o.next((()=>{(function(u){let h=u.createObjectStore(Ua,{keyPath:vT});h.createIndex(Xu,AT,{unique:!1}),h.createIndex(Eg,bT,{unique:!1})})(e)}))),r<13&&i>=13&&(o=o.next((()=>(function(u){let h=u.createObjectStore(Uo,{keyPath:aT});h.createIndex(So,cT),h.createIndex(_g,uT)})(e))).next((()=>this.Ci(e,s))).next((()=>e.deleteObjectStore(In)))),r<14&&i>=14&&(o=o.next((()=>this.Fi(e,s)))),r<15&&i>=15&&(o=o.next((()=>(function(u){u.createObjectStore(Fh,{keyPath:_T,autoIncrement:!0}).createIndex(Yu,yT,{unique:!1}),u.createObjectStore(Ci,{keyPath:IT}).createIndex(Ig,wT,{unique:!1}),u.createObjectStore(Ni,{keyPath:ET}).createIndex(wg,TT,{unique:!1})})(e)))),r<16&&i>=16&&(o=o.next((()=>{t.objectStore(Ci).clear()})).next((()=>{t.objectStore(Ni).clear()}))),r<17&&i>=17&&(o=o.next((()=>{(function(u){u.createObjectStore(Uh,{keyPath:ST})})(e)}))),r<18&&i>=18&&Rc()&&(o=o.next((()=>{t.objectStore(Ci).clear()})).next((()=>{t.objectStore(Ni).clear()}))),o}wi(e){let t=0;return e.store(In).ee(((r,i)=>{t+=ca(i)})).next((()=>{let r={byteSize:t};return e.store(Bi).put(Ju,r)}))}yi(e){let t=e.store(Ui),r=e.store(We);return t.J().next((i=>b.forEach(i,(s=>{let o=IDBKeyRange.bound([s.userId,Pn],[s.userId,s.lastAcknowledgedBatchId]);return r.J(An,o).next((c=>b.forEach(c,(u=>{F(u.userId===s.userId,18650,"Cannot process batch from unexpected user",{batchId:u.batchId});let h=En(this.serializer,u);return g_(e,s.userId,h).next((()=>{}))}))))}))))}Si(e){let t=e.store(Er),r=e.store(In);return e.store(Cn).get(Bo).next((i=>{let s=[];return r.ee(((o,c)=>{let u=new X(o),h=(function(m){return[0,be(m)]})(u);s.push(t.get(h).next((f=>f?b.resolve():(m=>t.put({targetId:0,path:be(m),sequenceNumber:i.highestListenSequenceNumber}))(u))))})).next((()=>b.waitFor(s)))}))}bi(e,t){e.createObjectStore(qi,{keyPath:fT});let r=t.store(qi),i=new Yi,s=o=>{if(i.add(o)){let c=o.lastSegment(),u=o.popLast();return r.put({collectionId:c,parent:be(u)})}};return t.store(In).ee({X:!0},((o,c)=>{let u=new X(o);return s(u.popLast())})).next((()=>t.store(Ir).ee({X:!0},(([o,c,u],h)=>{let f=it(c);return s(f.popLast())}))))}Di(e){let t=e.store(wr);return t.ee(((r,i)=>{let s=Ri(i),o=h_(this.serializer,s);return t.put(o)}))}Ci(e,t){let r=t.store(In),i=[];return r.ee(((s,o)=>{let c=t.store(Uo),u=(function(m){return m.document?new x(X.fromString(m.document.name).popFirst(5)):m.noDocument?x.fromSegments(m.noDocument.path):m.unknownDocument?x.fromSegments(m.unknownDocument.path):L(36783)})(o).path.toArray(),h={prefixPath:u.slice(0,u.length-2),collectionGroup:u[u.length-2],documentId:u[u.length-1],readTime:o.readTime||[0,0],unknownDocument:o.unknownDocument,noDocument:o.noDocument,document:o.document,hasCommittedMutations:!!o.hasCommittedMutations};i.push(c.put(h))})).next((()=>b.waitFor(i)))}Fi(e,t){let r=t.store(We),i=w_(this.serializer),s=new Zi(fa.mi,this.serializer.yt);return r.J().next((o=>{let c=new Map;return o.forEach((u=>{let h=c.get(u.userId)??K();En(this.serializer,u).keys().forEach((f=>h=h.add(f))),c.set(u.userId,h)})),b.forEach(c,((u,h)=>{let f=new me(h),m=sa.wt(this.serializer,f),_=s.getIndexManager(f),R=ua.wt(f,this.serializer,_,s.referenceDelegate);return new da(i,R,m,_).recalculateAndSaveOverlaysForDocumentKeys(new ji(t,Ve.ce),u).next()}))}))}};function Wm(n){n.createObjectStore(Er,{keyPath:hT}).createIndex(Mh,dT,{unique:!0}),n.createObjectStore(wr,{keyPath:"targetId"}).createIndex(yg,lT,{unique:!0}),n.createObjectStore(Cn)}var Mt="IndexedDbPersistence",Ou=18e5,Vu=5e3,xu="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.",mv="main",Ql=class n{constructor(e,t,r,i,s,o,c,u,h,f,m=18){if(this.allowTabSynchronization=e,this.persistenceKey=t,this.clientId=r,this.Mi=s,this.window=o,this.document=c,this.xi=h,this.Oi=f,this.Ni=m,this.ci=null,this.li=!1,this.isPrimary=!1,this.networkEnabled=!0,this.Bi=null,this.inForeground=!1,this.Li=null,this.ki=null,this.qi=Number.NEGATIVE_INFINITY,this.Qi=_=>Promise.resolve(),!n.v())throw new D(P.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new Ll(this,i),this.$i=t+mv,this.serializer=new ra(u),this.Ui=new yr(this.$i,this.Ni,new Hl(this.serializer)),this.hi=new Al,this.Pi=new Ol(this.referenceDelegate,this.serializer),this.remoteDocumentCache=w_(this.serializer),this.Ii=new vl,this.window&&this.window.localStorage?this.Ki=this.window.localStorage:(this.Ki=null,f===!1&&Pe(Mt,"LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}start(){return this.Wi().then((()=>{if(!this.isPrimary&&!this.allowTabSynchronization)throw new D(P.FAILED_PRECONDITION,xu);return this.Gi(),this.zi(),this.ji(),this.runTransaction("getHighestListenSequenceNumber","readonly",(e=>this.Pi.getHighestSequenceNumber(e)))})).then((e=>{this.ci=new Ve(e,this.xi)})).then((()=>{this.li=!0})).catch((e=>(this.Ui&&this.Ui.close(),Promise.reject(e))))}Ji(e){return this.Qi=async t=>{if(this.started)return e(t)},e(this.isPrimary)}setDatabaseDeletedListener(e){this.Ui.$((async t=>{t.newVersion===null&&await e()}))}setNetworkEnabled(e){this.networkEnabled!==e&&(this.networkEnabled=e,this.Mi.enqueueAndForget((async()=>{this.started&&await this.Wi()})))}Wi(){return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",(e=>vo(e).put({clientId:this.clientId,updateTimeMs:Date.now(),networkEnabled:this.networkEnabled,inForeground:this.inForeground}).next((()=>{if(this.isPrimary)return this.Hi(e).next((t=>{t||(this.isPrimary=!1,this.Mi.enqueueRetryable((()=>this.Qi(!1))))}))})).next((()=>this.Yi(e))).next((t=>this.isPrimary&&!t?this.Zi(e).next((()=>!1)):!!t&&this.Xi(e).next((()=>!0)))))).catch((e=>{if(tn(e))return C(Mt,"Failed to extend owner lease: ",e),this.isPrimary;if(!this.allowTabSynchronization)throw e;return C(Mt,"Releasing owner lease after error during lease refresh",e),!1})).then((e=>{this.isPrimary!==e&&this.Mi.enqueueRetryable((()=>this.Qi(e))),this.isPrimary=e}))}Hi(e){return bi(e).get(er).next((t=>b.resolve(this.es(t))))}ts(e){return vo(e).delete(this.clientId)}async ns(){if(this.isPrimary&&!this.rs(this.qi,Ou)){this.qi=Date.now();let e=await this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",(t=>{let r=ye(t,Tr);return r.J().next((i=>{let s=this.ss(i,Ou),o=i.filter((c=>s.indexOf(c)===-1));return b.forEach(o,(c=>r.delete(c.clientId))).next((()=>o))}))})).catch((()=>[]));if(this.Ki)for(let t of e)this.Ki.removeItem(this._s(t.clientId))}}ji(){this.ki=this.Mi.enqueueAfterDelay("client_metadata_refresh",4e3,(()=>this.Wi().then((()=>this.ns())).then((()=>this.ji()))))}es(e){return!!e&&e.ownerId===this.clientId}Yi(e){return this.Oi?b.resolve(!0):bi(e).get(er).next((t=>{if(t!==null&&this.rs(t.leaseTimestampMs,Vu)&&!this.us(t.ownerId)){if(this.es(t)&&this.networkEnabled)return!0;if(!this.es(t)){if(!t.allowTabSynchronization)throw new D(P.FAILED_PRECONDITION,xu);return!1}}return!(!this.networkEnabled||!this.inForeground)||vo(e).J().next((r=>this.ss(r,Vu).find((i=>{if(this.clientId!==i.clientId){let s=!this.networkEnabled&&i.networkEnabled,o=!this.inForeground&&i.inForeground,c=this.networkEnabled===i.networkEnabled;if(s||o&&c)return!0}return!1}))===void 0))})).next((t=>(this.isPrimary!==t&&C(Mt,`Client ${t?"is":"is not"} eligible for a primary lease.`),t)))}async shutdown(){this.li=!1,this.cs(),this.ki&&(this.ki.cancel(),this.ki=null),this.ls(),this.hs(),await this.Ui.runTransaction("shutdown","readwrite",[rs,Tr],(e=>{let t=new ji(e,Ve.ce);return this.Zi(t).next((()=>this.ts(t)))})),this.Ui.close(),this.Ps()}ss(e,t){return e.filter((r=>this.rs(r.updateTimeMs,t)&&!this.us(r.clientId)))}Ts(){return this.runTransaction("getActiveClients","readonly",(e=>vo(e).J().next((t=>this.ss(t,Ou).map((r=>r.clientId))))))}get started(){return this.li}getGlobalsCache(){return this.hi}getMutationQueue(e,t){return ua.wt(e,this.serializer,t,this.referenceDelegate)}getTargetCache(){return this.Pi}getRemoteDocumentCache(){return this.remoteDocumentCache}getIndexManager(e){return new Dl(e,this.serializer.yt.databaseId)}getDocumentOverlayCache(e){return sa.wt(this.serializer,e)}getBundleCache(){return this.Ii}runTransaction(e,t,r){C(Mt,"Starting transaction:",e);let i=t==="readonly"?"readonly":"readwrite",s=(function(u){return u===18?CT:u===17?bg:u===16?PT:u===15?Bh:u===14?Ag:u===13?vg:u===12?RT:u===11?Tg:void L(60245)})(this.Ni),o;return this.Ui.runTransaction(e,i,s,(c=>(o=new ji(c,this.ci?this.ci.next():Ve.ce),t==="readwrite-primary"?this.Hi(o).next((u=>!!u||this.Yi(o))).next((u=>{if(!u)throw Pe(`Failed to obtain primary lease for action '${e}'.`),this.isPrimary=!1,this.Mi.enqueueRetryable((()=>this.Qi(!1))),new D(P.FAILED_PRECONDITION,pg);return r(o)})).next((u=>this.Xi(o).next((()=>u)))):this.Is(o).next((()=>r(o)))))).then((c=>(o.raiseOnCommittedEvent(),c)))}Is(e){return bi(e).get(er).next((t=>{if(t!==null&&this.rs(t.leaseTimestampMs,Vu)&&!this.us(t.ownerId)&&!this.es(t)&&!(this.Oi||this.allowTabSynchronization&&t.allowTabSynchronization))throw new D(P.FAILED_PRECONDITION,xu)}))}Xi(e){let t={ownerId:this.clientId,allowTabSynchronization:this.allowTabSynchronization,leaseTimestampMs:Date.now()};return bi(e).put(er,t)}static v(){return yr.v()}Zi(e){let t=bi(e);return t.get(er).next((r=>this.es(r)?(C(Mt,"Releasing primary lease."),t.delete(er)):b.resolve()))}rs(e,t){let r=Date.now();return!(e<r-t)&&(!(e>r)||(Pe(`Detected an update time that is in the future: ${e} > ${r}`),!1))}Gi(){this.document!==null&&typeof this.document.addEventListener=="function"&&(this.Li=()=>{this.Mi.enqueueAndForget((()=>(this.inForeground=this.document.visibilityState==="visible",this.Wi())))},this.document.addEventListener("visibilitychange",this.Li),this.inForeground=this.document.visibilityState==="visible")}ls(){this.Li&&(this.document.removeEventListener("visibilitychange",this.Li),this.Li=null)}zi(){typeof this.window?.addEventListener=="function"&&(this.Bi=()=>{this.cs();let e=/(?:Version|Mobile)\/1[456]/;Sc()&&(navigator.appVersion.match(e)||navigator.userAgent.match(e))&&this.Mi.enterRestrictedMode(!0),this.Mi.enqueueAndForget((()=>this.shutdown()))},this.window.addEventListener("pagehide",this.Bi))}hs(){this.Bi&&(this.window.removeEventListener("pagehide",this.Bi),this.Bi=null)}us(e){try{let t=this.Ki?.getItem(this._s(e))!==null;return C(Mt,`Client '${e}' ${t?"is":"is not"} zombied in LocalStorage`),t}catch(t){return Pe(Mt,"Failed to get zombied client id.",t),!1}}cs(){if(this.Ki)try{this.Ki.setItem(this._s(this.clientId),String(Date.now()))}catch(e){Pe("Failed to set zombie client id.",e)}}Ps(){if(this.Ki)try{this.Ki.removeItem(this._s(this.clientId))}catch{}}_s(e){return`firestore_zombie_${this.persistenceKey}_${e}`}};function bi(n){return ye(n,rs)}function vo(n){return ye(n,Tr)}function gv(n,e){let t=n.projectId;return n.isDefaultDatabase||(t+="."+n.database),"firestore/"+e+"/"+t+"/"}var Jl=class n{constructor(e,t,r,i){this.targetId=e,this.fromCache=t,this.Es=r,this.ds=i}static As(e,t){let r=K(),i=K();for(let s of t.docChanges)switch(s.type){case 0:r=r.add(s.doc.key);break;case 1:i=i.add(s.doc.key)}return new n(e,t.fromCache,r,i)}};var Yl=class{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}};var ma=class{constructor(){this.Rs=!1,this.Vs=!1,this.fs=100,this.gs=(function(){return Sc()?8:mg(ue())>0?6:4})()}initialize(e,t){this.ps=e,this.indexManager=t,this.Rs=!0}getDocumentsMatchingQuery(e,t,r,i){let s={result:null};return this.ys(e,t).next((o=>{s.result=o})).next((()=>{if(!s.result)return this.ws(e,t,i,r).next((o=>{s.result=o}))})).next((()=>{if(s.result)return;let o=new Yl;return this.Ss(e,t,o).next((c=>{if(s.result=c,this.Vs)return this.bs(e,t,o,c.size)}))})).next((()=>s.result))}bs(e,t,r,i){return r.documentReadCount<this.fs?(or()<=W.DEBUG&&C("QueryEngine","SDK will not create cache indexes for query:",ar(t),"since it only creates cache indexes for collection contains","more than or equal to",this.fs,"documents"),b.resolve()):(or()<=W.DEBUG&&C("QueryEngine","Query:",ar(t),"scans",r.documentReadCount,"local documents and returns",i,"documents as results."),r.documentReadCount>this.gs*i?(or()<=W.DEBUG&&C("QueryEngine","The SDK decides to create cache indexes for query:",ar(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,ze(t))):b.resolve())}ys(e,t){if(Im(t))return b.resolve(null);let r=ze(t);return this.indexManager.getIndexType(e,r).next((i=>i===0?null:(t.limit!==null&&i===1&&(t=Ho(t,null,"F"),r=ze(t)),this.indexManager.getDocumentsMatchingTarget(e,r).next((s=>{let o=K(...s);return this.ps.getDocuments(e,o).next((c=>this.indexManager.getMinOffset(e,r).next((u=>{let h=this.Ds(t,c);return this.Cs(t,h,o,u.readTime)?this.ys(e,Ho(t,null,"F")):this.vs(e,h,t,u)}))))})))))}ws(e,t,r,i){return Im(t)||i.isEqual(B.min())?b.resolve(null):this.ps.getDocuments(e,r).next((s=>{let o=this.Ds(t,s);return this.Cs(t,o,r,i)?b.resolve(null):(or()<=W.DEBUG&&C("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),ar(t)),this.vs(e,o,t,nT(i,Li)).next((c=>c)))}))}Ds(e,t){let r=new te(jg(e));return t.forEach(((i,s)=>{ss(e,s)&&(r=r.add(s))})),r}Cs(e,t,r,i){if(e.limit===null)return!1;if(r.size!==t.size)return!0;let s=e.limitType==="F"?t.last():t.first();return!!s&&(s.hasPendingWrites||s.version.compareTo(i)>0)}Ss(e,t,r){return or()<=W.DEBUG&&C("QueryEngine","Using full collection scan to execute query:",ar(t)),this.ps.getDocumentsMatchingQuery(e,t,Ge.min(),r)}vs(e,t,r,i){return this.ps.getDocumentsMatchingQuery(e,r,i).next((s=>(t.forEach((o=>{s=s.insert(o.key,o)})),s)))}};var Hh="LocalStore",_v=3e8,Xl=class{constructor(e,t,r,i){this.persistence=e,this.Fs=t,this.serializer=i,this.Ms=new oe(z),this.xs=new Qe((s=>xn(s)),is),this.Os=new Map,this.Ns=e.getRemoteDocumentCache(),this.Pi=e.getTargetCache(),this.Ii=e.getBundleCache(),this.Bs(r)}Bs(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new da(this.Ns,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Ns.setIndexManager(this.indexManager),this.Fs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",(t=>e.collect(t,this.Ms)))}};function E_(n,e,t,r){return new Xl(n,e,t,r)}async function T_(n,e){let t=G(n);return await t.persistence.runTransaction("Handle user change","readonly",(r=>{let i;return t.mutationQueue.getAllMutationBatches(r).next((s=>(i=s,t.Bs(e),t.mutationQueue.getAllMutationBatches(r)))).next((s=>{let o=[],c=[],u=K();for(let h of i){o.push(h.batchId);for(let f of h.mutations)u=u.add(f.key)}for(let h of s){c.push(h.batchId);for(let f of h.mutations)u=u.add(f.key)}return t.localDocuments.getDocuments(r,u).next((h=>({Ls:h,removedBatchIds:o,addedBatchIds:c})))}))}))}function yv(n,e){let t=G(n);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",(r=>{let i=e.batch.keys(),s=t.Ns.newChangeBuffer({trackRemovals:!0});return(function(c,u,h,f){let m=h.batch,_=m.keys(),R=b.resolve();return _.forEach((k=>{R=R.next((()=>f.getEntry(u,k))).next((O=>{let N=h.docVersions.get(k);F(N!==null,48541),O.version.compareTo(N)<0&&(m.applyToRemoteDocument(O,h),O.isValidDocument()&&(O.setReadTime(h.commitVersion),f.addEntry(O)))}))})),R.next((()=>c.mutationQueue.removeMutationBatch(u,m)))})(t,r,e,s).next((()=>s.apply(r))).next((()=>t.mutationQueue.performConsistencyCheck(r))).next((()=>t.documentOverlayCache.removeOverlaysForBatchId(r,i,e.batch.batchId))).next((()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,(function(c){let u=K();for(let h=0;h<c.mutationResults.length;++h)c.mutationResults[h].transformResults.length>0&&(u=u.add(c.batch.mutations[h].key));return u})(e)))).next((()=>t.localDocuments.getDocuments(r,i)))}))}function v_(n){let e=G(n);return e.persistence.runTransaction("Get last remote snapshot version","readonly",(t=>e.Pi.getLastRemoteSnapshotVersion(t)))}function Iv(n,e){let t=G(n),r=e.snapshotVersion,i=t.Ms;return t.persistence.runTransaction("Apply remote event","readwrite-primary",(s=>{let o=t.Ns.newChangeBuffer({trackRemovals:!0});i=t.Ms;let c=[];e.targetChanges.forEach(((f,m)=>{let _=i.get(m);if(!_)return;c.push(t.Pi.removeMatchingKeys(s,f.removedDocuments,m).next((()=>t.Pi.addMatchingKeys(s,f.addedDocuments,m))));let R=_.withSequenceNumber(s.currentSequenceNumber);e.targetMismatches.get(m)!==null?R=R.withResumeToken(_e.EMPTY_BYTE_STRING,B.min()).withLastLimboFreeSnapshotVersion(B.min()):f.resumeToken.approximateByteSize()>0&&(R=R.withResumeToken(f.resumeToken,r)),i=i.insert(m,R),(function(O,N,j){return O.resumeToken.approximateByteSize()===0||N.snapshotVersion.toMicroseconds()-O.snapshotVersion.toMicroseconds()>=_v?!0:j.addedDocuments.size+j.modifiedDocuments.size+j.removedDocuments.size>0})(_,R,f)&&c.push(t.Pi.updateTargetData(s,R))}));let u=Ue(),h=K();if(e.documentUpdates.forEach((f=>{e.resolvedLimboDocuments.has(f)&&c.push(t.persistence.referenceDelegate.updateLimboDocument(s,f))})),c.push(wv(s,o,e.documentUpdates).next((f=>{u=f.ks,h=f.qs}))),!r.isEqual(B.min())){let f=t.Pi.getLastRemoteSnapshotVersion(s).next((m=>t.Pi.setTargetsMetadata(s,s.currentSequenceNumber,r)));c.push(f)}return b.waitFor(c).next((()=>o.apply(s))).next((()=>t.localDocuments.getLocalViewOfDocuments(s,u,h))).next((()=>u))})).then((s=>(t.Ms=i,s)))}function wv(n,e,t){let r=K(),i=K();return t.forEach((s=>r=r.add(s))),e.getEntries(n,r).next((s=>{let o=Ue();return t.forEach(((c,u)=>{let h=s.get(c);u.isFoundDocument()!==h.isFoundDocument()&&(i=i.add(c)),u.isNoDocument()&&u.version.isEqual(B.min())?(e.removeEntry(c,u.readTime),o=o.insert(c,u)):!h.isValidDocument()||u.version.compareTo(h.version)>0||u.version.compareTo(h.version)===0&&h.hasPendingWrites?(e.addEntry(u),o=o.insert(c,u)):C(Hh,"Ignoring outdated watch update for ",c,". Current version:",h.version," Watch version:",u.version)})),{ks:o,qs:i}}))}function Ev(n,e){let t=G(n);return t.persistence.runTransaction("Get next mutation batch","readonly",(r=>(e===void 0&&(e=Pn),t.mutationQueue.getNextMutationBatchAfterBatchId(r,e))))}function Tv(n,e){let t=G(n);return t.persistence.runTransaction("Allocate target","readwrite",(r=>{let i;return t.Pi.getTargetData(r,e).next((s=>s?(i=s,b.resolve(i)):t.Pi.allocateTargetId(r).next((o=>(i=new Nr(e,o,"TargetPurposeListen",r.currentSequenceNumber),t.Pi.addTargetData(r,i).next((()=>i)))))))})).then((r=>{let i=t.Ms.get(r.targetId);return(i===null||r.snapshotVersion.compareTo(i.snapshotVersion)>0)&&(t.Ms=t.Ms.insert(r.targetId,r),t.xs.set(e,r.targetId)),r}))}async function Zl(n,e,t){let r=G(n),i=r.Ms.get(e),s=t?"readwrite":"readwrite-primary";try{t||await r.persistence.runTransaction("Release target",s,(o=>r.persistence.referenceDelegate.removeTarget(o,i)))}catch(o){if(!tn(o))throw o;C(Hh,`Failed to update sequence numbers for target ${e}: ${o}`)}r.Ms=r.Ms.remove(e),r.xs.delete(i.target)}function Hm(n,e,t){let r=G(n),i=B.min(),s=K();return r.persistence.runTransaction("Execute query","readwrite",(o=>(function(u,h,f){let m=G(u),_=m.xs.get(f);return _!==void 0?b.resolve(m.Ms.get(_)):m.Pi.getTargetData(h,f)})(r,o,ze(e)).next((c=>{if(c)return i=c.lastLimboFreeSnapshotVersion,r.Pi.getMatchingKeysForTargetId(o,c.targetId).next((u=>{s=u}))})).next((()=>r.Fs.getDocumentsMatchingQuery(o,e,t?i:B.min(),t?s:K()))).next((c=>(vv(r,LT(e),c),{documents:c,Qs:s})))))}function vv(n,e,t){let r=n.Os.get(e)||B.min();t.forEach(((i,s)=>{s.readTime.compareTo(r)>0&&(r=s.readTime)})),n.Os.set(e,r)}var ga=class{constructor(){this.activeTargetIds=jT()}zs(e){this.activeTargetIds=this.activeTargetIds.add(e)}js(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Gs(){let e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}};var _a=class{constructor(){this.Mo=new ga,this.xo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,r){}addLocalQueryTarget(e,t=!0){return t&&this.Mo.zs(e),this.xo[e]||"not-current"}updateQueryState(e,t,r){this.xo[e]=t}removeLocalQueryTarget(e){this.Mo.js(e)}isLocalQueryTarget(e){return this.Mo.activeTargetIds.has(e)}clearQueryState(e){delete this.xo[e]}getAllActiveQueryTargets(){return this.Mo.activeTargetIds}isActiveQueryTarget(e){return this.Mo.activeTargetIds.has(e)}start(){return this.Mo=new ga,Promise.resolve()}handleUserChange(e,t,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}};var eh=class{Oo(e){}shutdown(){}};var Qm="ConnectivityMonitor",ya=class{constructor(){this.No=()=>this.Bo(),this.Lo=()=>this.ko(),this.qo=[],this.Qo()}Oo(e){this.qo.push(e)}shutdown(){window.removeEventListener("online",this.No),window.removeEventListener("offline",this.Lo)}Qo(){window.addEventListener("online",this.No),window.addEventListener("offline",this.Lo)}Bo(){C(Qm,"Network connectivity changed: AVAILABLE");for(let e of this.qo)e(0)}ko(){C(Qm,"Network connectivity changed: UNAVAILABLE");for(let e of this.qo)e(1)}static v(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}};var Ao=null;function th(){return Ao===null?Ao=(function(){return 268435456+Math.round(2147483648*Math.random())})():Ao++,"0x"+Ao.toString(16)}var Lu="RestConnection",Av={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"},nh=class{get $o(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;let t=e.ssl?"https":"http",r=encodeURIComponent(this.databaseId.projectId),i=encodeURIComponent(this.databaseId.database);this.Uo=t+"://"+e.host,this.Ko=`projects/${r}/databases/${i}`,this.Wo=this.databaseId.database===zo?`project_id=${r}`:`project_id=${r}&database_id=${i}`}Go(e,t,r,i,s){let o=th(),c=this.zo(e,t.toUriEncodedString());C(Lu,`Sending RPC '${e}' ${o}:`,c,r);let u={"google-cloud-resource-prefix":this.Ko,"x-goog-request-params":this.Wo};this.jo(u,i,s);let{host:h}=new URL(c),f=Rt(h);return this.Jo(e,c,u,r,f).then((m=>(C(Lu,`Received RPC '${e}' ${o}: `,m),m)),(m=>{throw On(Lu,`RPC '${e}' ${o} failed with error: `,m,"url: ",c,"request:",r),m}))}Ho(e,t,r,i,s,o){return this.Go(e,t,r,i,s)}jo(e,t,r){e["X-Goog-Api-Client"]=(function(){return"gl-js/ fire/"+Mr})(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach(((i,s)=>e[s]=i)),r&&r.headers.forEach(((i,s)=>e[s]=i))}zo(e,t){let r=Av[e];return`${this.Uo}/v1/${t}:${r}`}terminate(){}};var rh=class{constructor(e){this.Yo=e.Yo,this.Zo=e.Zo}Xo(e){this.e_=e}t_(e){this.n_=e}r_(e){this.i_=e}onMessage(e){this.s_=e}close(){this.Zo()}send(e){this.Yo(e)}o_(){this.e_()}__(){this.n_()}a_(e){this.i_(e)}u_(e){this.s_(e)}};var Ae="WebChannelConnection",ih=class extends nh{constructor(e){super(e),this.c_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Jo(e,t,r,i,s){let o=th();return new Promise(((c,u)=>{let h=new Su;h.setWithCredentials(!0),h.listenOnce(Ru.COMPLETE,(()=>{try{switch(h.getLastErrorCode()){case Ei.NO_ERROR:let m=h.getResponseJson();C(Ae,`XHR for RPC '${e}' ${o} received:`,JSON.stringify(m)),c(m);break;case Ei.TIMEOUT:C(Ae,`RPC '${e}' ${o} timed out`),u(new D(P.DEADLINE_EXCEEDED,"Request time out"));break;case Ei.HTTP_ERROR:let _=h.getStatus();if(C(Ae,`RPC '${e}' ${o} failed with status:`,_,"response text:",h.getResponseText()),_>0){let R=h.getResponseJson();Array.isArray(R)&&(R=R[0]);let k=R?.error;if(k&&k.status&&k.message){let O=(function(j){let q=j.toLowerCase().replace(/_/g,"-");return Object.values(P).indexOf(q)>=0?q:P.UNKNOWN})(k.status);u(new D(O,k.message))}else u(new D(P.UNKNOWN,"Server responded with status "+h.getStatus()))}else u(new D(P.UNAVAILABLE,"Connection failed."));break;default:L(9055,{l_:e,streamId:o,h_:h.getLastErrorCode(),P_:h.getLastError()})}}finally{C(Ae,`RPC '${e}' ${o} completed.`)}}));let f=JSON.stringify(i);C(Ae,`RPC '${e}' ${o} sending request:`,i),h.send(t,"POST",f,r,15)}))}T_(e,t,r){let i=th(),s=[this.Uo,"/","google.firestore.v1.Firestore","/",e,"/channel"],o=Nu(),c=Cu(),u={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},h=this.longPollingOptions.timeoutSeconds;h!==void 0&&(u.longPollingTimeout=Math.round(1e3*h)),this.useFetchStreams&&(u.useFetchStreams=!0),this.jo(u.initMessageHeaders,t,r),u.encodeInitMessageHeaders=!0;let f=s.join("");C(Ae,`Creating RPC '${e}' stream ${i}: ${f}`,u);let m=o.createWebChannel(f,u);this.I_(m);let _=!1,R=!1,k=new rh({Yo:N=>{R?C(Ae,`Not sending because RPC '${e}' stream ${i} is closed:`,N):(_||(C(Ae,`Opening RPC '${e}' stream ${i} transport.`),m.open(),_=!0),C(Ae,`RPC '${e}' stream ${i} sending:`,N),m.send(N))},Zo:()=>m.close()}),O=(N,j,q)=>{N.listen(j,(U=>{try{q(U)}catch(ee){setTimeout((()=>{throw ee}),0)}}))};return O(m,Zn.EventType.OPEN,(()=>{R||(C(Ae,`RPC '${e}' stream ${i} transport opened.`),k.o_())})),O(m,Zn.EventType.CLOSE,(()=>{R||(R=!0,C(Ae,`RPC '${e}' stream ${i} transport closed`),k.a_(),this.E_(m))})),O(m,Zn.EventType.ERROR,(N=>{R||(R=!0,On(Ae,`RPC '${e}' stream ${i} transport errored. Name:`,N.name,"Message:",N.message),k.a_(new D(P.UNAVAILABLE,"The operation could not be completed")))})),O(m,Zn.EventType.MESSAGE,(N=>{if(!R){let j=N.data[0];F(!!j,16349);let q=j,U=q?.error||q[0]?.error;if(U){C(Ae,`RPC '${e}' stream ${i} received error:`,U);let ee=U.status,Y=(function(g){let I=le[g];if(I!==void 0)return Zg(I)})(ee),Q=U.message;Y===void 0&&(Y=P.INTERNAL,Q="Unknown error status: "+ee+" with message "+U.message),R=!0,k.a_(new D(Y,Q)),m.close()}else C(Ae,`RPC '${e}' stream ${i} received:`,j),k.u_(j)}})),O(c,Pu.STAT_EVENT,(N=>{N.stat===Io.PROXY?C(Ae,`RPC '${e}' stream ${i} detected buffering proxy`):N.stat===Io.NOPROXY&&C(Ae,`RPC '${e}' stream ${i} detected no buffering proxy`)})),setTimeout((()=>{k.__()}),0),k}terminate(){this.c_.forEach((e=>e.close())),this.c_=[]}I_(e){this.c_.push(e)}E_(e){this.c_=this.c_.filter((t=>t===e))}};function bv(){return typeof window<"u"?window:null}function Do(){return typeof document<"u"?document:null}function Ga(n){return new yl(n,!0)}var Ia=class{constructor(e,t,r=1e3,i=1.5,s=6e4){this.Mi=e,this.timerId=t,this.d_=r,this.A_=i,this.R_=s,this.V_=0,this.m_=null,this.f_=Date.now(),this.reset()}reset(){this.V_=0}g_(){this.V_=this.R_}p_(e){this.cancel();let t=Math.floor(this.V_+this.y_()),r=Math.max(0,Date.now()-this.f_),i=Math.max(0,t-r);i>0&&C("ExponentialBackoff",`Backing off for ${i} ms (base delay: ${this.V_} ms, delay with jitter: ${t} ms, last attempt: ${r} ms ago)`),this.m_=this.Mi.enqueueAfterDelay(this.timerId,i,(()=>(this.f_=Date.now(),e()))),this.V_*=this.A_,this.V_<this.d_&&(this.V_=this.d_),this.V_>this.R_&&(this.V_=this.R_)}w_(){this.m_!==null&&(this.m_.skipDelay(),this.m_=null)}cancel(){this.m_!==null&&(this.m_.cancel(),this.m_=null)}y_(){return(Math.random()-.5)*this.V_}};var Jm="PersistentStream",wa=class{constructor(e,t,r,i,s,o,c,u){this.Mi=e,this.S_=r,this.b_=i,this.connection=s,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=c,this.listener=u,this.state=0,this.D_=0,this.C_=null,this.v_=null,this.stream=null,this.F_=0,this.M_=new Ia(e,t)}x_(){return this.state===1||this.state===5||this.O_()}O_(){return this.state===2||this.state===3}start(){this.F_=0,this.state!==4?this.auth():this.N_()}async stop(){this.x_()&&await this.close(0)}B_(){this.state=0,this.M_.reset()}L_(){this.O_()&&this.C_===null&&(this.C_=this.Mi.enqueueAfterDelay(this.S_,6e4,(()=>this.k_())))}q_(e){this.Q_(),this.stream.send(e)}async k_(){if(this.O_())return this.close(0)}Q_(){this.C_&&(this.C_.cancel(),this.C_=null)}U_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(e,t){this.Q_(),this.U_(),this.M_.cancel(),this.D_++,e!==4?this.M_.reset():t&&t.code===P.RESOURCE_EXHAUSTED?(Pe(t.toString()),Pe("Using maximum backoff delay to prevent overloading the backend."),this.M_.g_()):t&&t.code===P.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.K_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.r_(t)}K_(){}auth(){this.state=1;let e=this.W_(this.D_),t=this.D_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then((([r,i])=>{this.D_===t&&this.G_(r,i)}),(r=>{e((()=>{let i=new D(P.UNKNOWN,"Fetching auth token failed: "+r.message);return this.z_(i)}))}))}G_(e,t){let r=this.W_(this.D_);this.stream=this.j_(e,t),this.stream.Xo((()=>{r((()=>this.listener.Xo()))})),this.stream.t_((()=>{r((()=>(this.state=2,this.v_=this.Mi.enqueueAfterDelay(this.b_,1e4,(()=>(this.O_()&&(this.state=3),Promise.resolve()))),this.listener.t_())))})),this.stream.r_((i=>{r((()=>this.z_(i)))})),this.stream.onMessage((i=>{r((()=>++this.F_==1?this.J_(i):this.onNext(i)))}))}N_(){this.state=5,this.M_.p_((async()=>{this.state=0,this.start()}))}z_(e){return C(Jm,`close with error: ${e}`),this.stream=null,this.close(4,e)}W_(e){return t=>{this.Mi.enqueueAndForget((()=>this.D_===e?t():(C(Jm,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())))}}},sh=class extends wa{constructor(e,t,r,i,s,o){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,r,i,o),this.serializer=s}j_(e,t){return this.connection.T_("Listen",e,t)}J_(e){return this.onNext(e)}onNext(e){this.M_.reset();let t=iv(this.serializer,e),r=(function(s){if(!("targetChange"in s))return B.min();let o=s.targetChange;return o.targetIds&&o.targetIds.length?B.min():o.readTime?Ne(o.readTime):B.min()})(e);return this.listener.H_(t,r)}Y_(e){let t={};t.database=El(this.serializer),t.addTarget=(function(s,o){let c,u=o.target;if(c=Ko(u)?{documents:s_(s,u)}:{query:o_(s,u).ft},c.targetId=o.targetId,o.resumeToken.approximateByteSize()>0){c.resumeToken=e_(s,o.resumeToken);let h=Il(s,o.expectedCount);h!==null&&(c.expectedCount=h)}else if(o.snapshotVersion.compareTo(B.min())>0){c.readTime=Cr(s,o.snapshotVersion.toTimestamp());let h=Il(s,o.expectedCount);h!==null&&(c.expectedCount=h)}return c})(this.serializer,e);let r=ov(this.serializer,e);r&&(t.labels=r),this.q_(t)}Z_(e){let t={};t.database=El(this.serializer),t.removeTarget=e,this.q_(t)}},oh=class extends wa{constructor(e,t,r,i,s,o){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,r,i,o),this.serializer=s}get X_(){return this.F_>0}start(){this.lastStreamToken=void 0,super.start()}K_(){this.X_&&this.ea([])}j_(e,t){return this.connection.T_("Write",e,t)}J_(e){return F(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,F(!e.writeResults||e.writeResults.length===0,55816),this.listener.ta()}onNext(e){F(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.M_.reset();let t=sv(e.writeResults,e.commitTime),r=Ne(e.commitTime);return this.listener.na(r,t)}ra(){let e={};e.database=El(this.serializer),this.q_(e)}ea(e){let t={streamToken:this.lastStreamToken,writes:e.map((r=>na(this.serializer,r)))};this.q_(t)}};var ah=class{},ch=class extends ah{constructor(e,t,r,i){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=r,this.serializer=i,this.ia=!1}sa(){if(this.ia)throw new D(P.FAILED_PRECONDITION,"The client has already been terminated.")}Go(e,t,r,i){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([s,o])=>this.connection.Go(e,wl(t,r),i,s,o))).catch((s=>{throw s.name==="FirebaseError"?(s.code===P.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),s):new D(P.UNKNOWN,s.toString())}))}Ho(e,t,r,i,s){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([o,c])=>this.connection.Ho(e,wl(t,r),i,o,c,s))).catch((o=>{throw o.name==="FirebaseError"?(o.code===P.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new D(P.UNKNOWN,o.toString())}))}terminate(){this.ia=!0,this.connection.terminate()}},uh=class{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.oa=0,this._a=null,this.aa=!0}ua(){this.oa===0&&(this.ca("Unknown"),this._a=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,(()=>(this._a=null,this.la("Backend didn't respond within 10 seconds."),this.ca("Offline"),Promise.resolve()))))}ha(e){this.state==="Online"?this.ca("Unknown"):(this.oa++,this.oa>=1&&(this.Pa(),this.la(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ca("Offline")))}set(e){this.Pa(),this.oa=0,e==="Online"&&(this.aa=!1),this.ca(e)}ca(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}la(e){let t=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.aa?(Pe(t),this.aa=!1):C("OnlineStateTracker",t)}Pa(){this._a!==null&&(this._a.cancel(),this._a=null)}};var Un="RemoteStore",lh=class{constructor(e,t,r,i,s){this.localStore=e,this.datastore=t,this.asyncQueue=r,this.remoteSyncer={},this.Ta=[],this.Ia=new Map,this.Ea=new Set,this.da=[],this.Aa=s,this.Aa.Oo((o=>{r.enqueueAndForget((async()=>{jn(this)&&(C(Un,"Restarting streams for network reachability change."),await(async function(u){let h=G(u);h.Ea.add(4),await os(h),h.Ra.set("Unknown"),h.Ea.delete(4),await $a(h)})(this))}))})),this.Ra=new uh(r,i)}};async function $a(n){if(jn(n))for(let e of n.da)await e(!0)}async function os(n){for(let e of n.da)await e(!1)}function A_(n,e){let t=G(n);t.Ia.has(e.targetId)||(t.Ia.set(e.targetId,e),Xh(t)?Yh(t):Fr(t).O_()&&Jh(t,e))}function Qh(n,e){let t=G(n),r=Fr(t);t.Ia.delete(e),r.O_()&&b_(t,e),t.Ia.size===0&&(r.O_()?r.L_():jn(t)&&t.Ra.set("Unknown"))}function Jh(n,e){if(n.Va.Ue(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(B.min())>0){let t=n.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(t)}Fr(n).Y_(e)}function b_(n,e){n.Va.Ue(e),Fr(n).Z_(e)}function Yh(n){n.Va=new _l({getRemoteKeysForTarget:e=>n.remoteSyncer.getRemoteKeysForTarget(e),At:e=>n.Ia.get(e)||null,ht:()=>n.datastore.serializer.databaseId}),Fr(n).start(),n.Ra.ua()}function Xh(n){return jn(n)&&!Fr(n).x_()&&n.Ia.size>0}function jn(n){return G(n).Ea.size===0}function S_(n){n.Va=void 0}async function Sv(n){n.Ra.set("Online")}async function Rv(n){n.Ia.forEach(((e,t)=>{Jh(n,e)}))}async function Pv(n,e){S_(n),Xh(n)?(n.Ra.ha(e),Yh(n)):n.Ra.set("Unknown")}async function Cv(n,e,t){if(n.Ra.set("Online"),e instanceof Zo&&e.state===2&&e.cause)try{await(async function(i,s){let o=s.cause;for(let c of s.targetIds)i.Ia.has(c)&&(await i.remoteSyncer.rejectListen(c,o),i.Ia.delete(c),i.Va.removeTarget(c))})(n,e)}catch(r){C(Un,"Failed to remove targets %s: %s ",e.targetIds.join(","),r),await Ea(n,r)}else if(e instanceof fr?n.Va.Ze(e):e instanceof Xo?n.Va.st(e):n.Va.tt(e),!t.isEqual(B.min()))try{let r=await v_(n.localStore);t.compareTo(r)>=0&&await(function(s,o){let c=s.Va.Tt(o);return c.targetChanges.forEach(((u,h)=>{if(u.resumeToken.approximateByteSize()>0){let f=s.Ia.get(h);f&&s.Ia.set(h,f.withResumeToken(u.resumeToken,o))}})),c.targetMismatches.forEach(((u,h)=>{let f=s.Ia.get(u);if(!f)return;s.Ia.set(u,f.withResumeToken(_e.EMPTY_BYTE_STRING,f.snapshotVersion)),b_(s,u);let m=new Nr(f.target,u,h,f.sequenceNumber);Jh(s,m)})),s.remoteSyncer.applyRemoteEvent(c)})(n,t)}catch(r){C(Un,"Failed to raise snapshot:",r),await Ea(n,r)}}async function Ea(n,e,t){if(!tn(e))throw e;n.Ea.add(1),await os(n),n.Ra.set("Offline"),t||(t=()=>v_(n.localStore)),n.asyncQueue.enqueueRetryable((async()=>{C(Un,"Retrying IndexedDB access"),await t(),n.Ea.delete(1),await $a(n)}))}function R_(n,e){return e().catch((t=>Ea(n,t,e)))}async function as(n){let e=G(n),t=Xt(e),r=e.Ta.length>0?e.Ta[e.Ta.length-1].batchId:Pn;for(;Nv(e);)try{let i=await Ev(e.localStore,r);if(i===null){e.Ta.length===0&&t.L_();break}r=i.batchId,kv(e,i)}catch(i){await Ea(e,i)}P_(e)&&C_(e)}function Nv(n){return jn(n)&&n.Ta.length<10}function kv(n,e){n.Ta.push(e);let t=Xt(n);t.O_()&&t.X_&&t.ea(e.mutations)}function P_(n){return jn(n)&&!Xt(n).x_()&&n.Ta.length>0}function C_(n){Xt(n).start()}async function Dv(n){Xt(n).ra()}async function Ov(n){let e=Xt(n);for(let t of n.Ta)e.ea(t.mutations)}async function Vv(n,e,t){let r=n.Ta.shift(),i=pl.from(r,e,t);await R_(n,(()=>n.remoteSyncer.applySuccessfulWrite(i))),await as(n)}async function xv(n,e){e&&Xt(n).X_&&await(async function(r,i){if((function(o){return QT(o)&&o!==P.ABORTED})(i.code)){let s=r.Ta.shift();Xt(r).B_(),await R_(r,(()=>r.remoteSyncer.rejectFailedWrite(s.batchId,i))),await as(r)}})(n,e),P_(n)&&C_(n)}async function Ym(n,e){let t=G(n);t.asyncQueue.verifyOperationInProgress(),C(Un,"RemoteStore received new credentials");let r=jn(t);t.Ea.add(3),await os(t),r&&t.Ra.set("Unknown"),await t.remoteSyncer.handleCredentialChange(e),t.Ea.delete(3),await $a(t)}async function Lv(n,e){let t=G(n);e?(t.Ea.delete(2),await $a(t)):e||(t.Ea.add(2),await os(t),t.Ra.set("Unknown"))}function Fr(n){return n.ma||(n.ma=(function(t,r,i){let s=G(t);return s.sa(),new sh(r,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)})(n.datastore,n.asyncQueue,{Xo:Sv.bind(null,n),t_:Rv.bind(null,n),r_:Pv.bind(null,n),H_:Cv.bind(null,n)}),n.da.push((async e=>{e?(n.ma.B_(),Xh(n)?Yh(n):n.Ra.set("Unknown")):(await n.ma.stop(),S_(n))}))),n.ma}function Xt(n){return n.fa||(n.fa=(function(t,r,i){let s=G(t);return s.sa(),new oh(r,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)})(n.datastore,n.asyncQueue,{Xo:()=>Promise.resolve(),t_:Dv.bind(null,n),r_:xv.bind(null,n),ta:Ov.bind(null,n),na:Vv.bind(null,n)}),n.da.push((async e=>{e?(n.fa.B_(),await as(n)):(await n.fa.stop(),n.Ta.length>0&&(C(Un,`Stopping write stream with ${n.Ta.length} pending writes`),n.Ta=[]))}))),n.fa}var hh=class n{constructor(e,t,r,i,s){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=r,this.op=i,this.removalCallback=s,this.deferred=new je,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch((o=>{}))}get promise(){return this.deferred.promise}static createAndSchedule(e,t,r,i,s){let o=Date.now()+r,c=new n(e,t,o,i,s);return c.start(r),c}start(e){this.timerHandle=setTimeout((()=>this.handleDelayElapsed()),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new D(P.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget((()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then((e=>this.deferred.resolve(e)))):Promise.resolve()))}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}};function Zh(n,e){if(Pe("AsyncQueue",`${e}: ${n}`),tn(n))return new D(P.UNAVAILABLE,`${e}: ${n}`);throw n}var Ta=class n{static emptySet(e){return new n(e.comparator)}constructor(e){this.comparator=e?(t,r)=>e(t,r)||x.comparator(t.key,r.key):(t,r)=>x.comparator(t.key,r.key),this.keyedMap=Si(),this.sortedSet=new oe(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){let t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal(((t,r)=>(e(t),!1)))}add(e){let t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){let t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof n)||this.size!==e.size)return!1;let t=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;t.hasNext();){let i=t.getNext().key,s=r.getNext().key;if(!i.isEqual(s))return!1}return!0}toString(){let e=[];return this.forEach((t=>{e.push(t.toString())})),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,t){let r=new n;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=t,r}};var va=class{constructor(){this.ga=new oe(x.comparator)}track(e){let t=e.doc.key,r=this.ga.get(t);r?e.type!==0&&r.type===3?this.ga=this.ga.insert(t,e):e.type===3&&r.type!==1?this.ga=this.ga.insert(t,{type:r.type,doc:e.doc}):e.type===2&&r.type===2?this.ga=this.ga.insert(t,{type:2,doc:e.doc}):e.type===2&&r.type===0?this.ga=this.ga.insert(t,{type:0,doc:e.doc}):e.type===1&&r.type===0?this.ga=this.ga.remove(t):e.type===1&&r.type===2?this.ga=this.ga.insert(t,{type:1,doc:r.doc}):e.type===0&&r.type===1?this.ga=this.ga.insert(t,{type:2,doc:e.doc}):L(63341,{Rt:e,pa:r}):this.ga=this.ga.insert(t,e)}ya(){let e=[];return this.ga.inorderTraversal(((t,r)=>{e.push(r)})),e}},Dr=class n{constructor(e,t,r,i,s,o,c,u,h){this.query=e,this.docs=t,this.oldDocs=r,this.docChanges=i,this.mutatedKeys=s,this.fromCache=o,this.syncStateChanged=c,this.excludesMetadataChanges=u,this.hasCachedResults=h}static fromInitialDocuments(e,t,r,i,s){let o=[];return t.forEach((c=>{o.push({type:0,doc:c})})),new n(e,t,Ta.emptySet(t),o,r,i,!0,!1,s)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&za(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;let t=this.docChanges,r=e.docChanges;if(t.length!==r.length)return!1;for(let i=0;i<t.length;i++)if(t[i].type!==r[i].type||!t[i].doc.isEqual(r[i].doc))return!1;return!0}};var dh=class{constructor(){this.wa=void 0,this.Sa=[]}ba(){return this.Sa.some((e=>e.Da()))}},fh=class{constructor(){this.queries=Xm(),this.onlineState="Unknown",this.Ca=new Set}terminate(){(function(t,r){let i=G(t),s=i.queries;i.queries=Xm(),s.forEach(((o,c)=>{for(let u of c.Sa)u.onError(r)}))})(this,new D(P.ABORTED,"Firestore shutting down"))}};function Xm(){return new Qe((n=>qg(n)),za)}async function N_(n,e){let t=G(n),r=3,i=e.query,s=t.queries.get(i);s?!s.ba()&&e.Da()&&(r=2):(s=new dh,r=e.Da()?0:1);try{switch(r){case 0:s.wa=await t.onListen(i,!0);break;case 1:s.wa=await t.onListen(i,!1);break;case 2:await t.onFirstRemoteStoreListen(i)}}catch(o){let c=Zh(o,`Initialization of query '${ar(e.query)}' failed`);return void e.onError(c)}t.queries.set(i,s),s.Sa.push(e),e.va(t.onlineState),s.wa&&e.Fa(s.wa)&&ed(t)}async function k_(n,e){let t=G(n),r=e.query,i=3,s=t.queries.get(r);if(s){let o=s.Sa.indexOf(e);o>=0&&(s.Sa.splice(o,1),s.Sa.length===0?i=e.Da()?0:1:!s.ba()&&e.Da()&&(i=2))}switch(i){case 0:return t.queries.delete(r),t.onUnlisten(r,!0);case 1:return t.queries.delete(r),t.onUnlisten(r,!1);case 2:return t.onLastRemoteStoreUnlisten(r);default:return}}function Mv(n,e){let t=G(n),r=!1;for(let i of e){let s=i.query,o=t.queries.get(s);if(o){for(let c of o.Sa)c.Fa(i)&&(r=!0);o.wa=i}}r&&ed(t)}function Fv(n,e,t){let r=G(n),i=r.queries.get(e);if(i)for(let s of i.Sa)s.onError(t);r.queries.delete(e)}function ed(n){n.Ca.forEach((e=>{e.next()}))}var ph,Zm;(Zm=ph||(ph={})).Ma="default",Zm.Cache="cache";var Aa=class{constructor(e,t,r){this.query=e,this.xa=t,this.Oa=!1,this.Na=null,this.onlineState="Unknown",this.options=r||{}}Fa(e){if(!this.options.includeMetadataChanges){let r=[];for(let i of e.docChanges)i.type!==3&&r.push(i);e=new Dr(e.query,e.docs,e.oldDocs,r,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.Oa?this.Ba(e)&&(this.xa.next(e),t=!0):this.La(e,this.onlineState)&&(this.ka(e),t=!0),this.Na=e,t}onError(e){this.xa.error(e)}va(e){this.onlineState=e;let t=!1;return this.Na&&!this.Oa&&this.La(this.Na,e)&&(this.ka(this.Na),t=!0),t}La(e,t){if(!e.fromCache||!this.Da())return!0;let r=t!=="Offline";return(!this.options.qa||!r)&&(!e.docs.isEmpty()||e.hasCachedResults||t==="Offline")}Ba(e){if(e.docChanges.length>0)return!0;let t=this.Na&&this.Na.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&this.options.includeMetadataChanges===!0}ka(e){e=Dr.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Oa=!0,this.xa.next(e)}Da(){return this.options.source!==ph.Cache}};var ba=class{constructor(e){this.key=e}},Sa=class{constructor(e){this.key=e}},mh=class{constructor(e,t){this.query=e,this.Ya=t,this.Za=null,this.hasCachedResults=!1,this.current=!1,this.Xa=K(),this.mutatedKeys=K(),this.eu=jg(e),this.tu=new Ta(this.eu)}get nu(){return this.Ya}ru(e,t){let r=t?t.iu:new va,i=t?t.tu:this.tu,s=t?t.mutatedKeys:this.mutatedKeys,o=i,c=!1,u=this.query.limitType==="F"&&i.size===this.query.limit?i.last():null,h=this.query.limitType==="L"&&i.size===this.query.limit?i.first():null;if(e.inorderTraversal(((f,m)=>{let _=i.get(f),R=ss(this.query,m)?m:null,k=!!_&&this.mutatedKeys.has(_.key),O=!!R&&(R.hasLocalMutations||this.mutatedKeys.has(R.key)&&R.hasCommittedMutations),N=!1;_&&R?_.data.isEqual(R.data)?k!==O&&(r.track({type:3,doc:R}),N=!0):this.su(_,R)||(r.track({type:2,doc:R}),N=!0,(u&&this.eu(R,u)>0||h&&this.eu(R,h)<0)&&(c=!0)):!_&&R?(r.track({type:0,doc:R}),N=!0):_&&!R&&(r.track({type:1,doc:_}),N=!0,(u||h)&&(c=!0)),N&&(R?(o=o.add(R),s=O?s.add(f):s.delete(f)):(o=o.delete(f),s=s.delete(f)))})),this.query.limit!==null)for(;o.size>this.query.limit;){let f=this.query.limitType==="F"?o.last():o.first();o=o.delete(f.key),s=s.delete(f.key),r.track({type:1,doc:f})}return{tu:o,iu:r,Cs:c,mutatedKeys:s}}su(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,r,i){let s=this.tu;this.tu=e.tu,this.mutatedKeys=e.mutatedKeys;let o=e.iu.ya();o.sort(((f,m)=>(function(R,k){let O=N=>{switch(N){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return L(20277,{Rt:N})}};return O(R)-O(k)})(f.type,m.type)||this.eu(f.doc,m.doc))),this.ou(r),i=i??!1;let c=t&&!i?this._u():[],u=this.Xa.size===0&&this.current&&!i?1:0,h=u!==this.Za;return this.Za=u,o.length!==0||h?{snapshot:new Dr(this.query,e.tu,s,o,e.mutatedKeys,u===0,h,!1,!!r&&r.resumeToken.approximateByteSize()>0),au:c}:{au:c}}va(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({tu:this.tu,iu:new va,mutatedKeys:this.mutatedKeys,Cs:!1},!1)):{au:[]}}uu(e){return!this.Ya.has(e)&&!!this.tu.has(e)&&!this.tu.get(e).hasLocalMutations}ou(e){e&&(e.addedDocuments.forEach((t=>this.Ya=this.Ya.add(t))),e.modifiedDocuments.forEach((t=>{})),e.removedDocuments.forEach((t=>this.Ya=this.Ya.delete(t))),this.current=e.current)}_u(){if(!this.current)return[];let e=this.Xa;this.Xa=K(),this.tu.forEach((r=>{this.uu(r.key)&&(this.Xa=this.Xa.add(r.key))}));let t=[];return e.forEach((r=>{this.Xa.has(r)||t.push(new Sa(r))})),this.Xa.forEach((r=>{e.has(r)||t.push(new ba(r))})),t}cu(e){this.Ya=e.Qs,this.Xa=K();let t=this.ru(e.documents);return this.applyChanges(t,!0)}lu(){return Dr.fromInitialDocuments(this.query,this.tu,this.mutatedKeys,this.Za===0,this.hasCachedResults)}},td="SyncEngine",gh=class{constructor(e,t,r){this.query=e,this.targetId=t,this.view=r}},_h=class{constructor(e){this.key=e,this.hu=!1}},yh=class{constructor(e,t,r,i,s,o){this.localStore=e,this.remoteStore=t,this.eventManager=r,this.sharedClientState=i,this.currentUser=s,this.maxConcurrentLimboResolutions=o,this.Pu={},this.Tu=new Qe((c=>qg(c)),za),this.Iu=new Map,this.Eu=new Set,this.du=new oe(x.comparator),this.Au=new Map,this.Ru=new Xi,this.Vu={},this.mu=new Map,this.fu=kr.cr(),this.onlineState="Unknown",this.gu=void 0}get isPrimaryClient(){return this.gu===!0}};async function Uv(n,e,t=!0){let r=M_(n),i,s=r.Tu.get(e);return s?(r.sharedClientState.addLocalQueryTarget(s.targetId),i=s.view.lu()):i=await D_(r,e,t,!0),i}async function Bv(n,e){let t=M_(n);await D_(t,e,!0,!1)}async function D_(n,e,t,r){let i=await Tv(n.localStore,ze(e)),s=i.targetId,o=n.sharedClientState.addLocalQueryTarget(s,t),c;return r&&(c=await qv(n,e,s,o==="current",i.resumeToken)),n.isPrimaryClient&&t&&A_(n.remoteStore,i),c}async function qv(n,e,t,r,i){n.pu=(m,_,R)=>(async function(O,N,j,q){let U=N.view.ru(j);U.Cs&&(U=await Hm(O.localStore,N.query,!1).then((({documents:w})=>N.view.ru(w,U))));let ee=q&&q.targetChanges.get(N.targetId),Y=q&&q.targetMismatches.get(N.targetId)!=null,Q=N.view.applyChanges(U,O.isPrimaryClient,ee,Y);return tg(O,N.targetId,Q.au),Q.snapshot})(n,m,_,R);let s=await Hm(n.localStore,e,!0),o=new mh(e,s.Qs),c=o.ru(s.documents),u=Ji.createSynthesizedTargetChangeForCurrentChange(t,r&&n.onlineState!=="Offline",i),h=o.applyChanges(c,n.isPrimaryClient,u);tg(n,t,h.au);let f=new gh(e,t,o);return n.Tu.set(e,f),n.Iu.has(t)?n.Iu.get(t).push(e):n.Iu.set(t,[e]),h.snapshot}async function jv(n,e,t){let r=G(n),i=r.Tu.get(e),s=r.Iu.get(i.targetId);if(s.length>1)return r.Iu.set(i.targetId,s.filter((o=>!za(o,e)))),void r.Tu.delete(e);r.isPrimaryClient?(r.sharedClientState.removeLocalQueryTarget(i.targetId),r.sharedClientState.isActiveQueryTarget(i.targetId)||await Zl(r.localStore,i.targetId,!1).then((()=>{r.sharedClientState.clearQueryState(i.targetId),t&&Qh(r.remoteStore,i.targetId),Ih(r,i.targetId)})).catch(qn)):(Ih(r,i.targetId),await Zl(r.localStore,i.targetId,!0))}async function zv(n,e){let t=G(n),r=t.Tu.get(e),i=t.Iu.get(r.targetId);t.isPrimaryClient&&i.length===1&&(t.sharedClientState.removeLocalQueryTarget(r.targetId),Qh(t.remoteStore,r.targetId))}async function Gv(n,e,t){let r=F_(n);try{let i=await(function(o,c){let u=G(o),h=se.now(),f=c.reduce(((R,k)=>R.add(k.key)),K()),m,_;return u.persistence.runTransaction("Locally write mutations","readwrite",(R=>{let k=Ue(),O=K();return u.Ns.getEntries(R,f).next((N=>{k=N,k.forEach(((j,q)=>{q.isValidDocument()||(O=O.add(j))}))})).next((()=>u.localDocuments.getOverlayedDocuments(R,k))).next((N=>{m=N;let j=[];for(let q of c){let U=HT(q,m.get(q.key).overlayedDocument);U!=null&&j.push(new Je(q.key,U,Vg(U.value.mapValue),Be.exists(!0)))}return u.mutationQueue.addMutationBatch(R,h,j,c)})).next((N=>{_=N;let j=N.applyToLocalDocumentSet(m,O);return u.documentOverlayCache.saveOverlays(R,N.batchId,j)}))})).then((()=>({batchId:_.batchId,changes:Gg(m)})))})(r.localStore,e);r.sharedClientState.addPendingMutation(i.batchId),(function(o,c,u){let h=o.Vu[o.currentUser.toKey()];h||(h=new oe(z)),h=h.insert(c,u),o.Vu[o.currentUser.toKey()]=h})(r,i.batchId,t),await cs(r,i.changes),await as(r.remoteStore)}catch(i){let s=Zh(i,"Failed to persist write");t.reject(s)}}async function O_(n,e){let t=G(n);try{let r=await Iv(t.localStore,e);e.targetChanges.forEach(((i,s)=>{let o=t.Au.get(s);o&&(F(i.addedDocuments.size+i.modifiedDocuments.size+i.removedDocuments.size<=1,22616),i.addedDocuments.size>0?o.hu=!0:i.modifiedDocuments.size>0?F(o.hu,14607):i.removedDocuments.size>0&&(F(o.hu,42227),o.hu=!1))})),await cs(t,r,e)}catch(r){await qn(r)}}function eg(n,e,t){let r=G(n);if(r.isPrimaryClient&&t===0||!r.isPrimaryClient&&t===1){let i=[];r.Tu.forEach(((s,o)=>{let c=o.view.va(e);c.snapshot&&i.push(c.snapshot)})),(function(o,c){let u=G(o);u.onlineState=c;let h=!1;u.queries.forEach(((f,m)=>{for(let _ of m.Sa)_.va(c)&&(h=!0)})),h&&ed(u)})(r.eventManager,e),i.length&&r.Pu.H_(i),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}async function $v(n,e,t){let r=G(n);r.sharedClientState.updateQueryState(e,"rejected",t);let i=r.Au.get(e),s=i&&i.key;if(s){let o=new oe(x.comparator);o=o.insert(s,Ee.newNoDocument(s,B.min()));let c=K().add(s),u=new Yo(B.min(),new Map,new oe(z),o,c);await O_(r,u),r.du=r.du.remove(s),r.Au.delete(e),nd(r)}else await Zl(r.localStore,e,!1).then((()=>Ih(r,e,t))).catch(qn)}async function Kv(n,e){let t=G(n),r=e.batch.batchId;try{let i=await yv(t.localStore,e);x_(t,r,null),V_(t,r),t.sharedClientState.updateMutationState(r,"acknowledged"),await cs(t,i)}catch(i){await qn(i)}}async function Wv(n,e,t){let r=G(n);try{let i=await(function(o,c){let u=G(o);return u.persistence.runTransaction("Reject batch","readwrite-primary",(h=>{let f;return u.mutationQueue.lookupMutationBatch(h,c).next((m=>(F(m!==null,37113),f=m.keys(),u.mutationQueue.removeMutationBatch(h,m)))).next((()=>u.mutationQueue.performConsistencyCheck(h))).next((()=>u.documentOverlayCache.removeOverlaysForBatchId(h,f,c))).next((()=>u.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(h,f))).next((()=>u.localDocuments.getDocuments(h,f)))}))})(r.localStore,e);x_(r,e,t),V_(r,e),r.sharedClientState.updateMutationState(e,"rejected",t),await cs(r,i)}catch(i){await qn(i)}}function V_(n,e){(n.mu.get(e)||[]).forEach((t=>{t.resolve()})),n.mu.delete(e)}function x_(n,e,t){let r=G(n),i=r.Vu[r.currentUser.toKey()];if(i){let s=i.get(e);s&&(t?s.reject(t):s.resolve(),i=i.remove(e)),r.Vu[r.currentUser.toKey()]=i}}function Ih(n,e,t=null){n.sharedClientState.removeLocalQueryTarget(e);for(let r of n.Iu.get(e))n.Tu.delete(r),t&&n.Pu.yu(r,t);n.Iu.delete(e),n.isPrimaryClient&&n.Ru.jr(e).forEach((r=>{n.Ru.containsKey(r)||L_(n,r)}))}function L_(n,e){n.Eu.delete(e.path.canonicalString());let t=n.du.get(e);t!==null&&(Qh(n.remoteStore,t),n.du=n.du.remove(e),n.Au.delete(t),nd(n))}function tg(n,e,t){for(let r of t)r instanceof ba?(n.Ru.addReference(r.key,e),Hv(n,r)):r instanceof Sa?(C(td,"Document no longer in limbo: "+r.key),n.Ru.removeReference(r.key,e),n.Ru.containsKey(r.key)||L_(n,r.key)):L(19791,{wu:r})}function Hv(n,e){let t=e.key,r=t.path.canonicalString();n.du.get(t)||n.Eu.has(r)||(C(td,"New document in limbo: "+t),n.Eu.add(r),nd(n))}function nd(n){for(;n.Eu.size>0&&n.du.size<n.maxConcurrentLimboResolutions;){let e=n.Eu.values().next().value;n.Eu.delete(e);let t=new x(X.fromString(e)),r=n.fu.next();n.Au.set(r,new _h(t)),n.du=n.du.insert(t,r),A_(n.remoteStore,new Nr(ze(ja(t.path)),r,"TargetPurposeLimboResolution",Ve.ce))}}async function cs(n,e,t){let r=G(n),i=[],s=[],o=[];r.Tu.isEmpty()||(r.Tu.forEach(((c,u)=>{o.push(r.pu(u,e,t).then((h=>{if((h||t)&&r.isPrimaryClient){let f=h?!h.fromCache:t?.targetChanges.get(u.targetId)?.current;r.sharedClientState.updateQueryState(u.targetId,f?"current":"not-current")}if(h){i.push(h);let f=Jl.As(u.targetId,h);s.push(f)}})))})),await Promise.all(o),r.Pu.H_(i),await(async function(u,h){let f=G(u);try{await f.persistence.runTransaction("notifyLocalViewChanges","readwrite",(m=>b.forEach(h,(_=>b.forEach(_.Es,(R=>f.persistence.referenceDelegate.addReference(m,_.targetId,R))).next((()=>b.forEach(_.ds,(R=>f.persistence.referenceDelegate.removeReference(m,_.targetId,R)))))))))}catch(m){if(!tn(m))throw m;C(Hh,"Failed to update sequence numbers: "+m)}for(let m of h){let _=m.targetId;if(!m.fromCache){let R=f.Ms.get(_),k=R.snapshotVersion,O=R.withLastLimboFreeSnapshotVersion(k);f.Ms=f.Ms.insert(_,O)}}})(r.localStore,s))}async function Qv(n,e){let t=G(n);if(!t.currentUser.isEqual(e)){C(td,"User change. New user:",e.toKey());let r=await T_(t.localStore,e);t.currentUser=e,(function(s,o){s.mu.forEach((c=>{c.forEach((u=>{u.reject(new D(P.CANCELLED,o))}))})),s.mu.clear()})(t,"'waitForPendingWrites' promise is rejected due to a user change."),t.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),await cs(t,r.Ls)}}function Jv(n,e){let t=G(n),r=t.Au.get(e);if(r&&r.hu)return K().add(r.key);{let i=K(),s=t.Iu.get(e);if(!s)return i;for(let o of s){let c=t.Tu.get(o);i=i.unionWith(c.view.nu)}return i}}function M_(n){let e=G(n);return e.remoteStore.remoteSyncer.applyRemoteEvent=O_.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=Jv.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=$v.bind(null,e),e.Pu.H_=Mv.bind(null,e.eventManager),e.Pu.yu=Fv.bind(null,e.eventManager),e}function F_(n){let e=G(n);return e.remoteStore.remoteSyncer.applySuccessfulWrite=Kv.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=Wv.bind(null,e),e}var Bn=class{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=Ga(e.databaseInfo.databaseId),this.sharedClientState=this.Du(e),this.persistence=this.Cu(e),await this.persistence.start(),this.localStore=this.vu(e),this.gcScheduler=this.Fu(e,this.localStore),this.indexBackfillerScheduler=this.Mu(e,this.localStore)}Fu(e,t){return null}Mu(e,t){return null}vu(e){return E_(this.persistence,new ma,e.initialUser,this.serializer)}Cu(e){return new Zi(fa.mi,this.serializer)}Du(e){return new _a}async terminate(){this.gcScheduler?.stop(),this.indexBackfillerScheduler?.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}};Bn.provider={build:()=>new Bn};var wh=class extends Bn{constructor(e){super(),this.cacheSizeBytes=e}Fu(e,t){F(this.persistence.referenceDelegate instanceof pa,46915);let r=this.persistence.referenceDelegate.garbageCollector;return new la(r,e.asyncQueue,t)}Cu(e){let t=this.cacheSizeBytes!==void 0?Oe.withCacheSize(this.cacheSizeBytes):Oe.DEFAULT;return new Zi((r=>pa.mi(r,t)),this.serializer)}},Eh=class extends Bn{constructor(e,t,r){super(),this.xu=e,this.cacheSizeBytes=t,this.forceOwnership=r,this.kind="persistent",this.synchronizeTabs=!1}async initialize(e){await super.initialize(e),await this.xu.initialize(this,e),await F_(this.xu.syncEngine),await as(this.xu.remoteStore),await this.persistence.Ji((()=>(this.gcScheduler&&!this.gcScheduler.started&&this.gcScheduler.start(),this.indexBackfillerScheduler&&!this.indexBackfillerScheduler.started&&this.indexBackfillerScheduler.start(),Promise.resolve())))}vu(e){return E_(this.persistence,new ma,e.initialUser,this.serializer)}Fu(e,t){let r=this.persistence.referenceDelegate.garbageCollector;return new la(r,e.asyncQueue,t)}Mu(e,t){let r=new Qu(t,this.persistence);return new Hu(e.asyncQueue,r)}Cu(e){let t=gv(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey),r=this.cacheSizeBytes!==void 0?Oe.withCacheSize(this.cacheSizeBytes):Oe.DEFAULT;return new Ql(this.synchronizeTabs,t,e.clientId,r,e.asyncQueue,bv(),Do(),this.serializer,this.sharedClientState,!!this.forceOwnership)}Du(e){return new _a}};var Or=class{async initialize(e,t){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=r=>eg(this.syncEngine,r,1),this.remoteStore.remoteSyncer.handleCredentialChange=Qv.bind(null,this.syncEngine),await Lv(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return(function(){return new fh})()}createDatastore(e){let t=Ga(e.databaseInfo.databaseId),r=(function(s){return new ih(s)})(e.databaseInfo);return(function(s,o,c,u){return new ch(s,o,c,u)})(e.authCredentials,e.appCheckCredentials,r,t)}createRemoteStore(e){return(function(r,i,s,o,c){return new lh(r,i,s,o,c)})(this.localStore,this.datastore,e.asyncQueue,(t=>eg(this.syncEngine,t,0)),(function(){return ya.v()?new ya:new eh})())}createSyncEngine(e,t){return(function(i,s,o,c,u,h,f){let m=new yh(i,s,o,c,u,h);return f&&(m.gu=!0),m})(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}async terminate(){await(async function(t){let r=G(t);C(Un,"RemoteStore shutting down."),r.Ea.add(5),await os(r),r.Aa.shutdown(),r.Ra.set("Unknown")})(this.remoteStore),this.datastore?.terminate(),this.eventManager?.terminate()}};Or.provider={build:()=>new Or};var Ra=class{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ou(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ou(this.observer.error,e):Pe("Uncaught Error in snapshot listener:",e.toString()))}Nu(){this.muted=!0}Ou(e,t){setTimeout((()=>{this.muted||e(t)}),0)}};var Zt="FirestoreClient",Th=class{constructor(e,t,r,i,s){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=r,this.databaseInfo=i,this.user=me.UNAUTHENTICATED,this.clientId=xi.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=s,this.authCredentials.start(r,(async o=>{C(Zt,"Received user=",o.uid),await this.authCredentialListener(o),this.user=o})),this.appCheckCredentials.start(r,(o=>(C(Zt,"Received new app check token=",o),this.appCheckCredentialListener(o,this.user))))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();let e=new je;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted((async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){let r=Zh(t,"Failed to shutdown persistence");e.reject(r)}})),e.promise}};async function Mu(n,e){n.asyncQueue.verifyOperationInProgress(),C(Zt,"Initializing OfflineComponentProvider");let t=n.configuration;await e.initialize(t);let r=t.initialUser;n.setCredentialChangeListener((async i=>{r.isEqual(i)||(await T_(e.localStore,i),r=i)})),e.persistence.setDatabaseDeletedListener((()=>n.terminate())),n._offlineComponents=e}async function ng(n,e){n.asyncQueue.verifyOperationInProgress();let t=await Yv(n);C(Zt,"Initializing OnlineComponentProvider"),await e.initialize(t,n.configuration),n.setCredentialChangeListener((r=>Ym(e.remoteStore,r))),n.setAppCheckTokenChangeListener(((r,i)=>Ym(e.remoteStore,i))),n._onlineComponents=e}async function Yv(n){if(!n._offlineComponents)if(n._uninitializedComponentsProvider){C(Zt,"Using user provided OfflineComponentProvider");try{await Mu(n,n._uninitializedComponentsProvider._offline)}catch(e){let t=e;if(!(function(i){return i.name==="FirebaseError"?i.code===P.FAILED_PRECONDITION||i.code===P.UNIMPLEMENTED:!(typeof DOMException<"u"&&i instanceof DOMException)||i.code===22||i.code===20||i.code===11})(t))throw t;On("Error using user provided cache. Falling back to memory cache: "+t),await Mu(n,new Bn)}}else C(Zt,"Using default OfflineComponentProvider"),await Mu(n,new wh(void 0));return n._offlineComponents}async function U_(n){return n._onlineComponents||(n._uninitializedComponentsProvider?(C(Zt,"Using user provided OnlineComponentProvider"),await ng(n,n._uninitializedComponentsProvider._online)):(C(Zt,"Using default OnlineComponentProvider"),await ng(n,new Or))),n._onlineComponents}function Xv(n){return U_(n).then((e=>e.syncEngine))}async function B_(n){let e=await U_(n),t=e.eventManager;return t.onListen=Uv.bind(null,e.syncEngine),t.onUnlisten=jv.bind(null,e.syncEngine),t.onFirstRemoteStoreListen=Bv.bind(null,e.syncEngine),t.onLastRemoteStoreUnlisten=zv.bind(null,e.syncEngine),t}function Zv(n,e,t={}){let r=new je;return n.asyncQueue.enqueueAndForget((async()=>(function(s,o,c,u,h){let f=new Ra({next:_=>{f.Nu(),o.enqueueAndForget((()=>k_(s,m)));let R=_.docs.has(c);!R&&_.fromCache?h.reject(new D(P.UNAVAILABLE,"Failed to get document because the client is offline.")):R&&_.fromCache&&u&&u.source==="server"?h.reject(new D(P.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):h.resolve(_)},error:_=>h.reject(_)}),m=new Aa(ja(c.path),f,{includeMetadataChanges:!0,qa:!0});return N_(s,m)})(await B_(n),n.asyncQueue,e,t,r))),r.promise}function eA(n,e,t={}){let r=new je;return n.asyncQueue.enqueueAndForget((async()=>(function(s,o,c,u,h){let f=new Ra({next:_=>{f.Nu(),o.enqueueAndForget((()=>k_(s,m))),_.fromCache&&u.source==="server"?h.reject(new D(P.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):h.resolve(_)},error:_=>h.reject(_)}),m=new Aa(c,f,{includeMetadataChanges:!0,qa:!0});return N_(s,m)})(await B_(n),n.asyncQueue,e,t,r))),r.promise}function q_(n){let e={};return n.timeoutSeconds!==void 0&&(e.timeoutSeconds=n.timeoutSeconds),e}var rg=new Map;var j_="firestore.googleapis.com",ig=!0,Pa=class{constructor(e){if(e.host===void 0){if(e.ssl!==void 0)throw new D(P.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=j_,this.ssl=ig}else this.host=e.host,this.ssl=e.ssl??ig;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=m_;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<pv)throw new D(P.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}eT("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=q_(e.experimentalLongPollingOptions??{}),(function(r){if(r.timeoutSeconds!==void 0){if(isNaN(r.timeoutSeconds))throw new D(P.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (must not be NaN)`);if(r.timeoutSeconds<5)throw new D(P.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (minimum allowed value is 5)`);if(r.timeoutSeconds>30)throw new D(P.INVALID_ARGUMENT,`invalid long polling timeout: ${r.timeoutSeconds} (maximum allowed value is 30)`)}})(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&(function(r,i){return r.timeoutSeconds===i.timeoutSeconds})(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}},Vr=class{constructor(e,t,r,i){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=r,this._app=i,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new Pa({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new D(P.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new D(P.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new Pa(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=(function(r){if(!r)return new Fu;switch(r.type){case"firstParty":return new ju(r.sessionIndex||"0",r.iamToken||null,r.authTokenFactory||null);case"provider":return r.client;default:throw new D(P.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}})(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return(function(t){let r=rg.get(t);r&&(C("ComponentProvider","Removing Datastore"),rg.delete(t),r.terminate())})(this),Promise.resolve()}};function tA(n,e,t,r={}){n=He(n,Vr);let i=Rt(e),s=n._getSettings(),o={...s,emulatorOptions:n._getEmulatorOptions()},c=`${e}:${t}`;i&&(Ns(`https://${c}`),ks("Firestore",!0)),s.host!==j_&&s.host!==c&&On("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");let u={...s,host:c,ssl:i,emulatorOptions:r};if(!Ze(u,o)&&(n._setSettings(u),r.mockUserToken)){let h,f;if(typeof r.mockUserToken=="string")h=r.mockUserToken,f=me.MOCK_USER;else{h=bf(r.mockUserToken,n._app?.options.projectId);let m=r.mockUserToken.sub||r.mockUserToken.user_id;if(!m)throw new D(P.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");f=new me(m)}n._authCredentials=new Uu(new Oo(h,f))}}var en=class n{constructor(e,t,r){this.converter=t,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new n(this.firestore,e,this._query)}},we=class n{constructor(e,t,r){this.converter=t,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Bt(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new n(this.firestore,e,this._key)}toJSON(){return{type:n._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,t,r){if(ns(t,n._jsonSchema))return new n(e,r||null,new x(X.fromString(t.referencePath)))}};we._jsonSchemaVersion="firestore/documentReference/1.0",we._jsonSchema={type:de("string",we._jsonSchemaVersion),referencePath:de("string")};var Bt=class n extends en{constructor(e,t,r){super(e,t,ja(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){let e=this._path.popLast();return e.isEmpty()?null:new we(this.firestore,null,new x(e))}withConverter(e){return new n(this.firestore,e,this._path)}};function rd(n,e,...t){if(n=ce(n),hg("collection","path",e),n instanceof Vr){let r=X.fromString(e,...t);return tm(r),new Bt(n,null,r)}{if(!(n instanceof we||n instanceof Bt))throw new D(P.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");let r=n._path.child(X.fromString(e,...t));return tm(r),new Bt(n.firestore,null,r)}}function Ka(n,e,...t){if(n=ce(n),arguments.length===1&&(e=xi.newId()),hg("doc","path",e),n instanceof Vr){let r=X.fromString(e,...t);return em(r),new we(n,null,new x(r))}{if(!(n instanceof we||n instanceof Bt))throw new D(P.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");let r=n._path.child(X.fromString(e,...t));return em(r),new we(n.firestore,n instanceof Bt?n.converter:null,new x(r))}}var sg="AsyncQueue",Ca=class{constructor(e=Promise.resolve()){this.Xu=[],this.ec=!1,this.tc=[],this.nc=null,this.rc=!1,this.sc=!1,this.oc=[],this.M_=new Ia(this,"async_queue_retry"),this._c=()=>{let r=Do();r&&C(sg,"Visibility state changed to "+r.visibilityState),this.M_.w_()},this.ac=e;let t=Do();t&&typeof t.addEventListener=="function"&&t.addEventListener("visibilitychange",this._c)}get isShuttingDown(){return this.ec}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.uc(),this.cc(e)}enterRestrictedMode(e){if(!this.ec){this.ec=!0,this.sc=e||!1;let t=Do();t&&typeof t.removeEventListener=="function"&&t.removeEventListener("visibilitychange",this._c)}}enqueue(e){if(this.uc(),this.ec)return new Promise((()=>{}));let t=new je;return this.cc((()=>this.ec&&this.sc?Promise.resolve():(e().then(t.resolve,t.reject),t.promise))).then((()=>t.promise))}enqueueRetryable(e){this.enqueueAndForget((()=>(this.Xu.push(e),this.lc())))}async lc(){if(this.Xu.length!==0){try{await this.Xu[0](),this.Xu.shift(),this.M_.reset()}catch(e){if(!tn(e))throw e;C(sg,"Operation failed with retryable error: "+e)}this.Xu.length>0&&this.M_.p_((()=>this.lc()))}}cc(e){let t=this.ac.then((()=>(this.rc=!0,e().catch((r=>{throw this.nc=r,this.rc=!1,Pe("INTERNAL UNHANDLED ERROR: ",og(r)),r})).then((r=>(this.rc=!1,r))))));return this.ac=t,t}enqueueAfterDelay(e,t,r){this.uc(),this.oc.indexOf(e)>-1&&(t=0);let i=hh.createAndSchedule(this,e,t,r,(s=>this.hc(s)));return this.tc.push(i),i}uc(){this.nc&&L(47125,{Pc:og(this.nc)})}verifyOperationInProgress(){}async Tc(){let e;do e=this.ac,await e;while(e!==this.ac)}Ic(e){for(let t of this.tc)if(t.timerId===e)return!0;return!1}Ec(e){return this.Tc().then((()=>{this.tc.sort(((t,r)=>t.targetTimeMs-r.targetTimeMs));for(let t of this.tc)if(t.skipDelay(),e!=="all"&&t.timerId===e)break;return this.Tc()}))}dc(e){this.oc.push(e)}hc(e){let t=this.tc.indexOf(e);this.tc.splice(t,1)}};function og(n){let e=n.message||"";return n.stack&&(e=n.stack.includes(n.message)?n.stack:n.message+`
`+n.stack),e}var It=class extends Vr{constructor(e,t,r,i){super(e,t,r,i),this.type="firestore",this._queue=new Ca,this._persistenceKey=i?.name||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){let e=this._firestoreClient.terminate();this._queue=new Ca(e),this._firestoreClient=void 0,await e}}};function z_(n,e){let t=typeof n=="object"?n:Ls(),r=typeof n=="string"?n:e||zo,i=si(t,"firestore").getImmediate({identifier:r});if(!i._initialized){let s=Af("firestore");s&&tA(i,...s)}return i}function id(n){if(n._terminated)throw new D(P.FAILED_PRECONDITION,"The client has already been terminated.");return n._firestoreClient||G_(n),n._firestoreClient}function G_(n){let e=n._freezeSettings(),t=(function(i,s,o,c){return new Zu(i,s,o,c.host,c.ssl,c.experimentalForceLongPolling,c.experimentalAutoDetectLongPolling,q_(c.experimentalLongPollingOptions),c.useFetchStreams,c.isUsingEmulator)})(n._databaseId,n._app?.options.appId||"",n._persistenceKey,e);n._componentsProvider||e.localCache?._offlineComponentProvider&&e.localCache?._onlineComponentProvider&&(n._componentsProvider={_offline:e.localCache._offlineComponentProvider,_online:e.localCache._onlineComponentProvider}),n._firestoreClient=new Th(n._authCredentials,n._appCheckCredentials,n._queue,t,n._componentsProvider&&(function(i){let s=i?._online.build();return{_offline:i?._offline.build(s),_online:s}})(n._componentsProvider))}function $_(n,e){On("enableIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");let t=n._freezeSettings();return nA(n,Or.provider,{build:r=>new Eh(r,t.cacheSizeBytes,e?.forceOwnership)}),Promise.resolve()}function nA(n,e,t){if((n=He(n,It))._firestoreClient||n._terminated)throw new D(P.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.");if(n._componentsProvider||n._getSettings().localCache)throw new D(P.FAILED_PRECONDITION,"SDK cache is already specified.");n._componentsProvider={_online:e,_offline:t},G_(n)}var qt=class n{constructor(e){this._byteString=e}static fromBase64String(e){try{return new n(_e.fromBase64String(e))}catch(t){throw new D(P.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new n(_e.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:n._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(ns(e,n._jsonSchema))return n.fromBase64String(e.bytes)}};qt._jsonSchemaVersion="firestore/bytes/1.0",qt._jsonSchema={type:de("string",qt._jsonSchemaVersion),bytes:de("string")};var xr=class{constructor(...e){for(let t=0;t<e.length;++t)if(e[t].length===0)throw new D(P.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new ge(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}};var Lr=class{constructor(e){this._methodName=e}};var jt=class n{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new D(P.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new D(P.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return z(this._lat,e._lat)||z(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:n._jsonSchemaVersion}}static fromJSON(e){if(ns(e,n._jsonSchema))return new n(e.latitude,e.longitude)}};jt._jsonSchemaVersion="firestore/geoPoint/1.0",jt._jsonSchema={type:de("string",jt._jsonSchemaVersion),latitude:de("number"),longitude:de("number")};var zt=class n{constructor(e){this._values=(e||[]).map((t=>t))}toArray(){return this._values.map((e=>e))}isEqual(e){return(function(r,i){if(r.length!==i.length)return!1;for(let s=0;s<r.length;++s)if(r[s]!==i[s])return!1;return!0})(this._values,e._values)}toJSON(){return{type:n._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(ns(e,n._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every((t=>typeof t=="number")))return new n(e.vectorValues);throw new D(P.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}};zt._jsonSchemaVersion="firestore/vectorValue/1.0",zt._jsonSchema={type:de("string",zt._jsonSchemaVersion),vectorValues:de("object")};var rA=/^__.*__$/,vh=class{constructor(e,t,r){this.data=e,this.fieldMask=t,this.fieldTransforms=r}toMutation(e,t){return this.fieldMask!==null?new Je(e,this.data,this.fieldMask,t,this.fieldTransforms):new Yt(e,this.data,t,this.fieldTransforms)}},Na=class{constructor(e,t,r){this.data=e,this.fieldMask=t,this.fieldTransforms=r}toMutation(e,t){return new Je(e,this.data,this.fieldMask,t,this.fieldTransforms)}};function K_(n){switch(n){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw L(40011,{Ac:n})}}var Ah=class n{constructor(e,t,r,i,s,o){this.settings=e,this.databaseId=t,this.serializer=r,this.ignoreUndefinedProperties=i,s===void 0&&this.Rc(),this.fieldTransforms=s||[],this.fieldMask=o||[]}get path(){return this.settings.path}get Ac(){return this.settings.Ac}Vc(e){return new n({...this.settings,...e},this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}mc(e){let t=this.path?.child(e),r=this.Vc({path:t,fc:!1});return r.gc(e),r}yc(e){let t=this.path?.child(e),r=this.Vc({path:t,fc:!1});return r.Rc(),r}wc(e){return this.Vc({path:void 0,fc:!0})}Sc(e){return Da(e,this.settings.methodName,this.settings.bc||!1,this.path,this.settings.Dc)}contains(e){return this.fieldMask.find((t=>e.isPrefixOf(t)))!==void 0||this.fieldTransforms.find((t=>e.isPrefixOf(t.field)))!==void 0}Rc(){if(this.path)for(let e=0;e<this.path.length;e++)this.gc(this.path.get(e))}gc(e){if(e.length===0)throw this.Sc("Document fields must not be empty");if(K_(this.Ac)&&rA.test(e))throw this.Sc('Document fields cannot begin and end with "__"')}},bh=class{constructor(e,t,r){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=r||Ga(e)}Cc(e,t,r,i=!1){return new Ah({Ac:e,methodName:t,Dc:r,path:ge.emptyPath(),fc:!1,bc:i},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}};function Wa(n){let e=n._freezeSettings(),t=Ga(n._databaseId);return new bh(n._databaseId,!!e.ignoreUndefinedProperties,t)}function W_(n,e,t,r,i,s={}){let o=n.Cc(s.merge||s.mergeFields?2:0,e,t,i);sd("Data must be an object, but it was:",o,r);let c=H_(r,o),u,h;if(s.merge)u=new Fe(o.fieldMask),h=o.fieldTransforms;else if(s.mergeFields){let f=[];for(let m of s.mergeFields){let _=Rh(e,m,t);if(!o.contains(_))throw new D(P.INVALID_ARGUMENT,`Field '${_}' is specified in your field mask but missing from your input data.`);J_(f,_)||f.push(_)}u=new Fe(f),h=o.fieldTransforms.filter((m=>u.covers(m.field)))}else u=null,h=o.fieldTransforms;return new vh(new Ce(c),u,h)}var ka=class n extends Lr{_toFieldTransform(e){if(e.Ac!==2)throw e.Ac===1?e.Sc(`${this._methodName}() can only appear at the top level of your update data`):e.Sc(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof n}};var Sh=class n extends Lr{_toFieldTransform(e){return new Qo(e.path,new Ht)}isEqual(e){return e instanceof n}};function iA(n,e,t,r){let i=n.Cc(1,e,t);sd("Data must be an object, but it was:",i,r);let s=[],o=Ce.empty();nn(r,((u,h)=>{let f=od(e,u,t);h=ce(h);let m=i.yc(f);if(h instanceof ka)s.push(f);else{let _=us(h,m);_!=null&&(s.push(f),o.set(f,_))}}));let c=new Fe(s);return new Na(o,c,i.fieldTransforms)}function sA(n,e,t,r,i,s){let o=n.Cc(1,e,t),c=[Rh(e,r,t)],u=[i];if(s.length%2!=0)throw new D(P.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let _=0;_<s.length;_+=2)c.push(Rh(e,s[_])),u.push(s[_+1]);let h=[],f=Ce.empty();for(let _=c.length-1;_>=0;--_)if(!J_(h,c[_])){let R=c[_],k=u[_];k=ce(k);let O=o.yc(R);if(k instanceof ka)h.push(R);else{let N=us(k,O);N!=null&&(h.push(R),f.set(R,N))}}let m=new Fe(h);return new Na(f,m,o.fieldTransforms)}function oA(n,e,t,r=!1){return us(t,n.Cc(r?4:3,e))}function us(n,e){if(Q_(n=ce(n)))return sd("Unsupported field value:",e,n),H_(n,e);if(n instanceof Lr)return(function(r,i){if(!K_(i.Ac))throw i.Sc(`${r._methodName}() can only be used with update() and set()`);if(!i.path)throw i.Sc(`${r._methodName}() is not currently supported inside arrays`);let s=r._toFieldTransform(i);s&&i.fieldTransforms.push(s)})(n,e),null;if(n===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),n instanceof Array){if(e.settings.fc&&e.Ac!==4)throw e.Sc("Nested arrays are not supported");return(function(r,i){let s=[],o=0;for(let c of r){let u=us(c,i.wc(o));u==null&&(u={nullValue:"NULL_VALUE"}),s.push(u),o++}return{arrayValue:{values:s}}})(n,e)}return(function(r,i){if((r=ce(r))===null)return{nullValue:"NULL_VALUE"};if(typeof r=="number")return zT(i.serializer,r);if(typeof r=="boolean")return{booleanValue:r};if(typeof r=="string")return{stringValue:r};if(r instanceof Date){let s=se.fromDate(r);return{timestampValue:Cr(i.serializer,s)}}if(r instanceof se){let s=new se(r.seconds,1e3*Math.floor(r.nanoseconds/1e3));return{timestampValue:Cr(i.serializer,s)}}if(r instanceof jt)return{geoPointValue:{latitude:r.latitude,longitude:r.longitude}};if(r instanceof qt)return{bytesValue:e_(i.serializer,r._byteString)};if(r instanceof we){let s=i.databaseId,o=r.firestore._databaseId;if(!o.isEqual(s))throw i.Sc(`Document reference is for database ${o.projectId}/${o.database} but should be for database ${s.projectId}/${s.database}`);return{referenceValue:Kh(r.firestore._databaseId||i.databaseId,r._key.path)}}if(r instanceof zt)return(function(o,c){return{mapValue:{fields:{[jh]:{stringValue:zh},[Ar]:{arrayValue:{values:o.toArray().map((h=>{if(typeof h!="number")throw c.Sc("VectorValues must only contain numeric values.");return $h(c.serializer,h)}))}}}}}})(r,i);throw i.Sc(`Unsupported field value: ${xa(r)}`)})(n,e)}function H_(n,e){let t={};return Sg(n)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):nn(n,((r,i)=>{let s=us(i,e.mc(r));s!=null&&(t[r]=s)})),{mapValue:{fields:t}}}function Q_(n){return!(typeof n!="object"||n===null||n instanceof Array||n instanceof Date||n instanceof se||n instanceof jt||n instanceof qt||n instanceof we||n instanceof Lr||n instanceof zt)}function sd(n,e,t){if(!Q_(t)||!dg(t)){let r=xa(t);throw r==="an object"?e.Sc(n+" a custom object"):e.Sc(n+" "+r)}}function Rh(n,e,t){if((e=ce(e))instanceof xr)return e._internalPath;if(typeof e=="string")return od(n,e);throw Da("Field path arguments must be of type string or ",n,!1,void 0,t)}var aA=new RegExp("[~\\*/\\[\\]]");function od(n,e,t){if(e.search(aA)>=0)throw Da(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,n,!1,void 0,t);try{return new xr(...e.split("."))._internalPath}catch{throw Da(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,n,!1,void 0,t)}}function Da(n,e,t,r,i){let s=r&&!r.isEmpty(),o=i!==void 0,c=`Function ${e}() called with invalid data`;t&&(c+=" (via `toFirestore()`)"),c+=". ";let u="";return(s||o)&&(u+=" (found",s&&(u+=` in field ${r}`),o&&(u+=` in document ${i}`),u+=")"),new D(P.INVALID_ARGUMENT,c+n+u)}function J_(n,e){return n.some((t=>t.isEqual(e)))}var Oa=class{constructor(e,t,r,i,s){this._firestore=e,this._userDataWriter=t,this._key=r,this._document=i,this._converter=s}get id(){return this._key.path.lastSegment()}get ref(){return new we(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){let e=new Ph(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){let t=this._document.data.field(ad("DocumentSnapshot.get",e));if(t!==null)return this._userDataWriter.convertValue(t)}}},Ph=class extends Oa{data(){return super.data()}};function ad(n,e){return typeof e=="string"?od(n,e):e instanceof xr?e._internalPath:e._delegate._internalPath}function cA(n){if(n.limitType==="L"&&n.explicitOrderBy.length===0)throw new D(P.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}var es=class{},ts=class extends es{};function cd(n,e,...t){let r=[];e instanceof es&&r.push(e),r=r.concat(t),(function(s){let o=s.filter((u=>u instanceof Nh)).length,c=s.filter((u=>u instanceof Ch)).length;if(o>1||o>0&&c>0)throw new D(P.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")})(r);for(let i of r)n=i._apply(n);return n}var Ch=class n extends ts{constructor(e,t,r){super(),this._field=e,this._op=t,this._value=r,this.type="where"}static _create(e,t,r){return new n(e,t,r)}_apply(e){let t=this._parse(e);return Y_(e._query,t),new en(e.firestore,e.converter,dl(e._query,t))}_parse(e){let t=Wa(e.firestore);return(function(s,o,c,u,h,f,m){let _;if(h.isKeyField()){if(f==="array-contains"||f==="array-contains-any")throw new D(P.INVALID_ARGUMENT,`Invalid Query. You can't perform '${f}' queries on documentId().`);if(f==="in"||f==="not-in"){cg(m,f);let k=[];for(let O of m)k.push(ag(u,s,O));_={arrayValue:{values:k}}}else _=ag(u,s,m)}else f!=="in"&&f!=="not-in"&&f!=="array-contains-any"||cg(m,f),_=oA(c,o,m,f==="in"||f==="not-in");return H.create(h,f,_)})(e._query,"where",t,e.firestore._databaseId,this._field,this._op,this._value)}};var Nh=class n extends es{constructor(e,t){super(),this.type=e,this._queryConstraints=t}static _create(e,t){return new n(e,t)}_parse(e){let t=this._queryConstraints.map((r=>r._parse(e))).filter((r=>r.getFilters().length>0));return t.length===1?t[0]:Z.create(t,this._getOperator())}_apply(e){let t=this._parse(e);return t.getFilters().length===0?e:((function(i,s){let o=i,c=s.getFlattenedFilters();for(let u of c)Y_(o,u),o=dl(o,u)})(e._query,t),new en(e.firestore,e.converter,dl(e._query,t)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}};var kh=class n extends ts{constructor(e,t){super(),this._field=e,this._direction=t,this.type="orderBy"}static _create(e,t){return new n(e,t)}_apply(e){let t=(function(i,s,o){if(i.startAt!==null)throw new D(P.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(i.endAt!==null)throw new D(P.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new Vn(s,o)})(e._query,this._field,this._direction);return new en(e.firestore,e.converter,(function(i,s){let o=i.explicitOrderBy.concat([s]);return new Wt(i.path,i.collectionGroup,o,i.filters.slice(),i.limit,i.limitType,i.startAt,i.endAt)})(e._query,t))}};function ud(n,e="asc"){let t=e,r=ad("orderBy",n);return kh._create(r,t)}var Dh=class n extends ts{constructor(e,t,r){super(),this.type=e,this._limit=t,this._limitType=r}static _create(e,t,r){return new n(e,t,r)}_apply(e){return new en(e.firestore,e.converter,Ho(e._query,this._limit,this._limitType))}};function ld(n){return tT("limit",n),Dh._create("limit",n,"F")}function ag(n,e,t){if(typeof(t=ce(t))=="string"){if(t==="")throw new D(P.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!Bg(e)&&t.indexOf("/")!==-1)throw new D(P.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${t}' contains a '/' character.`);let r=e.path.child(X.fromString(t));if(!x.isDocumentKey(r))throw new D(P.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return $i(n,new x(r))}if(t instanceof we)return $i(n,t._key);throw new D(P.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${xa(t)}.`)}function cg(n,e){if(!Array.isArray(n)||n.length===0)throw new D(P.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function Y_(n,e){let t=(function(i,s){for(let o of i)for(let c of o.getFlattenedFilters())if(s.indexOf(c.op)>=0)return c.op;return null})(n.filters,(function(i){switch(i){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}})(e.op));if(t!==null)throw t===e.op?new D(P.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new D(P.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${t.toString()}' filters.`)}var Oh=class{convertValue(e,t="none"){switch(Gt(e)){case 0:return null;case 1:return e.booleanValue;case 2:return ie(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(yt(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 11:return this.convertObject(e.mapValue,t);case 10:return this.convertVectorValue(e.mapValue);default:throw L(62114,{value:e})}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){let r={};return nn(e,((i,s)=>{r[i]=this.convertValue(s,t)})),r}convertVectorValue(e){let t=e.fields?.[Ar].arrayValue?.values?.map((r=>ie(r.doubleValue)));return new zt(t)}convertGeoPoint(e){return new jt(ie(e.latitude),ie(e.longitude))}convertArray(e,t){return(e.values||[]).map((r=>this.convertValue(r,t)))}convertServerTimestamp(e,t){switch(t){case"previous":let r=Ba(e);return r==null?null:this.convertValue(r,t);case"estimate":return this.convertTimestamp(zi(e));default:return null}}convertTimestamp(e){let t=_t(e);return new se(t.seconds,t.nanos)}convertDocumentKey(e,t){let r=X.fromString(e);F(l_(r),9688,{name:e});let i=new vr(r.get(1),r.get(3)),s=new x(r.popFirst(5));return i.isEqual(t)||Pe(`Document ${s} contains a document reference within a different database (${i.projectId}/${i.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),s}};function X_(n,e,t){let r;return r=n?t&&(t.merge||t.mergeFields)?n.toFirestore(e,t):n.toFirestore(e):e,r}var Sn=class{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}},kn=class n extends Oa{constructor(e,t,r,i,s,o){super(e,t,r,i,o),this._firestore=e,this._firestoreImpl=e,this.metadata=s}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){let t=new pr(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){let r=this._document.data.field(ad("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r,t.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new D(P.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");let e=this._document,t={};return t.type=n._jsonSchemaVersion,t.bundle="",t.bundleSource="DocumentSnapshot",t.bundleName=this._key.toString(),!e||!e.isValidDocument()||!e.isFoundDocument()?t:(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),t.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),t)}};kn._jsonSchemaVersion="firestore/documentSnapshot/1.0",kn._jsonSchema={type:de("string",kn._jsonSchemaVersion),bundleSource:de("string","DocumentSnapshot"),bundleName:de("string"),bundle:de("string")};var pr=class extends kn{data(e={}){return super.data(e)}},mr=class n{constructor(e,t,r,i){this._firestore=e,this._userDataWriter=t,this._snapshot=i,this.metadata=new Sn(i.hasPendingWrites,i.fromCache),this.query=r}get docs(){let e=[];return this.forEach((t=>e.push(t))),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,t){this._snapshot.docs.forEach((r=>{e.call(t,new pr(this._firestore,this._userDataWriter,r.key,r,new Sn(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))}))}docChanges(e={}){let t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new D(P.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=(function(i,s){if(i._snapshot.oldDocs.isEmpty()){let o=0;return i._snapshot.docChanges.map((c=>{let u=new pr(i._firestore,i._userDataWriter,c.doc.key,c.doc,new Sn(i._snapshot.mutatedKeys.has(c.doc.key),i._snapshot.fromCache),i.query.converter);return c.doc,{type:"added",doc:u,oldIndex:-1,newIndex:o++}}))}{let o=i._snapshot.oldDocs;return i._snapshot.docChanges.filter((c=>s||c.type!==3)).map((c=>{let u=new pr(i._firestore,i._userDataWriter,c.doc.key,c.doc,new Sn(i._snapshot.mutatedKeys.has(c.doc.key),i._snapshot.fromCache),i.query.converter),h=-1,f=-1;return c.type!==0&&(h=o.indexOf(c.doc.key),o=o.delete(c.doc.key)),c.type!==1&&(o=o.add(c.doc),f=o.indexOf(c.doc.key)),{type:uA(c.type),doc:u,oldIndex:h,newIndex:f}}))}})(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new D(P.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");let e={};e.type=n._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=xi.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;let t=[],r=[],i=[];return this.docs.forEach((s=>{s._document!==null&&(t.push(s._document),r.push(this._userDataWriter.convertObjectMap(s._document.data.value.mapValue.fields,"previous")),i.push(s.ref.path))})),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}};function uA(n){switch(n){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return L(61501,{type:n})}}function Z_(n){n=He(n,we);let e=He(n.firestore,It);return Zv(id(e),n._key).then((t=>lA(e,n,t)))}mr._jsonSchemaVersion="firestore/querySnapshot/1.0",mr._jsonSchema={type:de("string",mr._jsonSchemaVersion),bundleSource:de("string","QuerySnapshot"),bundleName:de("string"),bundle:de("string")};var Va=class extends Oh{constructor(e){super(),this.firestore=e}convertBytes(e){return new qt(e)}convertReference(e){let t=this.convertDocumentKey(e,this.firestore._databaseId);return new we(this.firestore,null,t)}};function hd(n){n=He(n,en);let e=He(n.firestore,It),t=id(e),r=new Va(e);return cA(n._query),eA(t,n._query).then((i=>new mr(e,r,n,i)))}function ey(n,e,t){n=He(n,we);let r=He(n.firestore,It),i=X_(n.converter,e,t);return pd(r,[W_(Wa(r),"setDoc",n._key,i,n.converter!==null,t).toMutation(n._key,Be.none())])}function dd(n,e,t,...r){n=He(n,we);let i=He(n.firestore,It),s=Wa(i),o;return o=typeof(e=ce(e))=="string"||e instanceof xr?sA(s,"updateDoc",n._key,e,t,r):iA(s,"updateDoc",n._key,e),pd(i,[o.toMutation(n._key,Be.exists(!0))])}function fd(n,e){let t=He(n.firestore,It),r=Ka(n),i=X_(n.converter,e);return pd(t,[W_(Wa(n.firestore),"addDoc",r._key,i,n.converter!==null,{}).toMutation(r._key,Be.exists(!1))]).then((()=>r))}function pd(n,e){return(function(r,i){let s=new je;return r.asyncQueue.enqueueAndForget((async()=>Gv(await Xv(r),i,s))),s.promise})(id(n),e)}function lA(n,e,t){let r=t.docs.get(e._key),i=new Va(n);return new kn(n,i,e._key,r,new Sn(t.hasPendingWrites,t.fromCache),e.converter)}function rn(){return new Sh("serverTimestamp")}(function(e,t=!0){(function(i){Mr=i})(kt),Nt(new qe("firestore",((r,{instanceIdentifier:i,options:s})=>{let o=r.getProvider("app").getImmediate(),c=new It(new Bu(r.getProvider("auth-internal")),new zu(o,r.getProvider("app-check-internal")),(function(h,f){if(!Object.prototype.hasOwnProperty.apply(h.options,["projectId"]))throw new D(P.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new vr(h.options.projectId,f)})(o,i),o);return s={useFetchStreams:t,...s},c._setSettings(s),c}),"PUBLIC").setMultipleInstances(!0)),$e(Yp,Xp,e),$e(Yp,Xp,"esm2020")})();var hA={apiKey:"AIzaSyARjB1PrtGtQI08_8bHPC2d9fNbrOvp1sQ",authDomain:"leetcodeextension-64ac6.firebaseapp.com",projectId:"leetcodeextension-64ac6",storageBucket:"leetcodeextension-64ac6.firebasestorage.app",messagingSenderId:"623995174552",appId:"1:623995174552:web:847ee6c174396383e29aed",measurementId:"G-04BB8PFB65"},md=jc(hA),zn=Au(md),Ur=z_(md);function dA(){return Iu(zn,_o)}async function fA(){try{await $_(Ur)}catch{}}function pA(n){return wu(zn,n)}function mA(n,e){return yu(zn,n,e)}function gA(n,e){return _u(zn,n,e)}function _A(){return Eu(zn)}function ls(){let n=zn.currentUser;if(!n||!n.uid)throw new Error("Not signed in");return n}function ty(n){return rd(Ur,"users",n,"chats")}function ny(n,e){return rd(Ur,"users",n,"chats",e,"messages")}async function yA(){let n=ls(),e=Ka(Ur,"users",n.uid),t=await Z_(e),r={email:n.email||null,displayName:n.displayName||null,updatedAt:rn(),lastLoginAt:rn()};t.exists()?await dd(e,r):await ey(e,{...r,createdAt:rn()})}async function IA({title:n,problemKey:e,problemUrl:t,model:r,systemPrompt:i,summary:s}={}){let o=ls(),c=rn(),u={title:n||"New Chat",problemKey:e||null,problemUrl:t||null,model:r||null,systemPrompt:i||null,summary:s||null,createdAt:c,updatedAt:c,lastMessageAt:c};return{chatId:(await fd(ty(o.uid),u)).id}}async function wA({chatId:n,role:e,content:t,model:r=null,toolCalls:i=[]}={}){if(!n)throw new Error("chatId is required");if(!e)throw new Error("role is required");if(typeof t!="string")throw new Error("content must be a string");let s=ls(),o={role:e,content:t,model:r,toolCalls:i,createdAt:rn()};await fd(ny(s.uid,n),o);let c=Ka(Ur,"users",s.uid,"chats",n);await dd(c,{updatedAt:rn(),lastMessageAt:rn()})}async function EA({max:n=50}={}){let e=ls(),t=cd(ty(e.uid),ud("lastMessageAt","desc"),ld(n));return(await hd(t)).docs.map(i=>({chatId:i.id,...i.data()}))}async function TA(n,{max:e=500}={}){if(!n)throw new Error("chatId is required");let t=ls(),r=cd(ny(t.uid,n),ud("createdAt","asc"),ld(e));return(await hd(r)).docs.map(s=>({messageId:s.id,...s.data()}))}return Uy(vA);})();
/*! Bundled license information:

@firebase/util/dist/index.esm.js:
@firebase/util/dist/index.esm.js:
@firebase/util/dist/index.esm.js:
@firebase/util/dist/index.esm.js:
@firebase/util/dist/index.esm.js:
@firebase/util/dist/index.esm.js:
@firebase/util/dist/index.esm.js:
@firebase/util/dist/index.esm.js:
@firebase/util/dist/index.esm.js:
@firebase/logger/dist/esm/index.esm.js:
@firebase/firestore/dist/index.esm.js:
@firebase/firestore/dist/index.esm.js:
@firebase/firestore/dist/index.esm.js:
@firebase/firestore/dist/index.esm.js:
@firebase/firestore/dist/index.esm.js:
@firebase/firestore/dist/index.esm.js:
  (**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)

@firebase/util/dist/index.esm.js:
  (**
   * @license
   * Copyright 2022 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)
  (**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)
  (**
   * @license
   * Copyright 2025 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)
  (**
   * @license
   * Copyright 2021 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)

@firebase/util/dist/index.esm.js:
@firebase/firestore/dist/index.esm.js:
@firebase/firestore/dist/index.esm.js:
  (**
   * @license
   * Copyright 2022 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)

@firebase/util/dist/index.esm.js:
@firebase/component/dist/esm/index.esm.js:
@firebase/app/dist/esm/index.esm.js:
@firebase/app/dist/esm/index.esm.js:
@firebase/auth/dist/esm/index-1970027f.js:
@firebase/auth/dist/esm/index-1970027f.js:
@firebase/firestore/dist/index.esm.js:
@firebase/firestore/dist/index.esm.js:
  (**
   * @license
   * Copyright 2019 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)

@firebase/util/dist/index.esm.js:
firebase/app/dist/esm/index.esm.js:
@firebase/auth/dist/esm/index-1970027f.js:
@firebase/auth/dist/esm/index-1970027f.js:
@firebase/auth/dist/esm/index-1970027f.js:
@firebase/auth/dist/esm/index-1970027f.js:
@firebase/auth/dist/esm/index-1970027f.js:
@firebase/auth/dist/esm/index-1970027f.js:
@firebase/auth/dist/esm/index-1970027f.js:
@firebase/auth/dist/esm/index-1970027f.js:
@firebase/auth/dist/esm/index-1970027f.js:
@firebase/auth/dist/esm/index-1970027f.js:
@firebase/auth/dist/esm/index-1970027f.js:
@firebase/auth/dist/esm/index-1970027f.js:
@firebase/auth/dist/esm/index-1970027f.js:
@firebase/auth/dist/esm/index-1970027f.js:
@firebase/auth/dist/esm/index-1970027f.js:
@firebase/auth/dist/esm/index-1970027f.js:
@firebase/auth/dist/esm/index-1970027f.js:
@firebase/auth/dist/esm/index-1970027f.js:
@firebase/auth/dist/esm/index-1970027f.js:
@firebase/auth/dist/esm/index-1970027f.js:
@firebase/auth/dist/esm/index-1970027f.js:
@firebase/auth/dist/esm/index-1970027f.js:
@firebase/auth/dist/esm/index-1970027f.js:
@firebase/auth/dist/esm/index-1970027f.js:
@firebase/auth/dist/esm/index-1970027f.js:
@firebase/auth/dist/esm/index-1970027f.js:
@firebase/auth/dist/esm/index-1970027f.js:
@firebase/auth/dist/esm/index-1970027f.js:
@firebase/auth/dist/esm/index-1970027f.js:
@firebase/auth/dist/esm/index-1970027f.js:
@firebase/auth/dist/esm/index-1970027f.js:
@firebase/auth/dist/esm/index-1970027f.js:
@firebase/firestore/dist/index.esm.js:
@firebase/firestore/dist/index.esm.js:
@firebase/firestore/dist/index.esm.js:
@firebase/firestore/dist/index.esm.js:
@firebase/firestore/dist/index.esm.js:
@firebase/firestore/dist/index.esm.js:
@firebase/firestore/dist/index.esm.js:
@firebase/firestore/dist/index.esm.js:
@firebase/firestore/dist/index.esm.js:
@firebase/firestore/dist/index.esm.js:
@firebase/firestore/dist/index.esm.js:
  (**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)

@firebase/util/dist/index.esm.js:
@firebase/auth/dist/esm/index-1970027f.js:
@firebase/firestore/dist/index.esm.js:
  (**
   * @license
   * Copyright 2021 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)

@firebase/app/dist/esm/index.esm.js:
  (**
   * @license
   * Copyright 2019 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)
  (**
   * @license
   * Copyright 2023 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)

@firebase/app/dist/esm/index.esm.js:
  (**
   * @license
   * Copyright 2021 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)
  (**
   * @license
   * Copyright 2019 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)

@firebase/auth/dist/esm/index-1970027f.js:
@firebase/auth/dist/esm/index-1970027f.js:
  (**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)
  (**
   * @license
   * Copyright 2019 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)

@firebase/auth/dist/esm/index-1970027f.js:
  (**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)
  (**
   * @license
   * Copyright 2022 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)
  (**
   * @license
   * Copyright 2023 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)

@firebase/auth/dist/esm/index-1970027f.js:
  (**
   * @license
   * Copyright 2019 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)
  (**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)

@firebase/auth/dist/esm/index-1970027f.js:
  (**
   * @license
   * Copyright 2019 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)
  (**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)
  (**
   * @license
   * Copyright 2025 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)

@firebase/auth/dist/esm/index-1970027f.js:
  (**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)
  (**
   * @license
   * Copyright 2019 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)
  (**
   * @license
   * Copyright 2020 Google LLC.
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)

@firebase/auth/dist/esm/index-1970027f.js:
  (**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)
  (**
   * @license
   * Copyright 2021 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)
  (**
   * @license
   * Copyright 2019 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)

@firebase/auth/dist/esm/index-1970027f.js:
  (**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)
  (**
   * @license
   * Copyright 2020 Google LLC.
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)
  (**
   * @license
   * Copyright 2021 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)

@firebase/webchannel-wrapper/dist/bloom-blob/esm/bloom_blob_es2018.js:
@firebase/webchannel-wrapper/dist/webchannel-blob/esm/webchannel_blob_es2018.js:
  (** @license
  Copyright The Closure Library Authors.
  SPDX-License-Identifier: Apache-2.0
  *)
  (** @license
  
   Copyright The Closure Library Authors.
   SPDX-License-Identifier: Apache-2.0
  *)

@firebase/firestore/dist/index.esm.js:
  (**
  * @license
  * Copyright 2020 Google LLC
  *
  * Licensed under the Apache License, Version 2.0 (the "License");
  * you may not use this file except in compliance with the License.
  * You may obtain a copy of the License at
  *
  *   http://www.apache.org/licenses/LICENSE-2.0
  *
  * Unless required by applicable law or agreed to in writing, software
  * distributed under the License is distributed on an "AS IS" BASIS,
  * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  * See the License for the specific language governing permissions and
  * limitations under the License.
  *)
  (**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)

@firebase/firestore/dist/index.esm.js:
  (**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)
  (**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)
  (**
   * @license
   * Copyright 2025 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)
  (**
   * @license
   * Copyright 2021 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)

@firebase/firestore/dist/index.esm.js:
  (**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)
  (**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)
  (**
   * @license
   * Copyright 2018 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)
  (**
   * @license
   * Copyright 2022 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)

@firebase/firestore/dist/index.esm.js:
  (**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)
  (**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)
  (**
   * @license
   * Copyright 2023 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)

@firebase/firestore/dist/index.esm.js:
  (**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)
  (**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)
  (**
   * @license
   * Copyright 2022 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)
  (**
   * @license
   * Copyright 2019 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)

@firebase/firestore/dist/index.esm.js:
  (**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)
  (**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)
  (**
   * @license
   * Copyright 2018 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)
  (**
   * @license
   * Copyright 2022 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)
  (**
   * @license
   * Copyright 2023 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)

@firebase/firestore/dist/index.esm.js:
  (**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)
  (**
   * @license
   * Copyright 2023 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)
  (**
   * @license
   * Copyright 2022 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)

@firebase/firestore/dist/index.esm.js:
  (**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)
  (**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)
  (**
   * @license
   * Copyright 2022 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)
  (**
   * @license
   * Copyright 2024 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)
  (**
   * @license
   * Copyright 2021 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)
  (**
   * @license
   * Copyright 2021 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law | agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES | CONDITIONS OF ANY KIND, either express | implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)
  (**
   * @license
   * Copyright 2019 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)
  (**
   * @license
   * Copyright 2018 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)
  (**
   * @license
   * Copyright 2023 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)

@firebase/firestore/dist/index.esm.js:
  (**
   * @license
   * Copyright 2018 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)

@firebase/firestore/dist/index.esm.js:
  (**
   * @license
   * Copyright 2019 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)
  (**
   * @license
   * Copyright 2023 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)
  (**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)
  (**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)

@firebase/firestore/dist/index.esm.js:
@firebase/firestore/dist/index.esm.js:
  (**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)
  (**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)

@firebase/firestore/dist/index.esm.js:
  (**
   * @license
   * Copyright 2025 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)

@firebase/firestore/dist/index.esm.js:
  (**
   * @license
   * Copyright 2023 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)
  (**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)

@firebase/firestore/dist/index.esm.js:
  (**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)
  (**
   * @license
   * Copyright 2022 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)

@firebase/firestore/dist/index.esm.js:
  (**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)
  (**
   * @license
   * Copyright 2017 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)
  (**
   * @license
   * Copyright 2024 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)

@firebase/firestore/dist/index.esm.js:
  (**
   * @license
   * Copyright 2025 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)
  (**
   * @license
   * Copyright 2020 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)

@firebase/firestore/dist/index.esm.js:
@firebase/firestore/dist/index.esm.js:
  (**
   * @license
   * Copyright 2023 Google LLC
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *   http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *)
*/
